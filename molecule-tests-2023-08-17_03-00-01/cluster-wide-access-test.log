/bin/bash: line 1: go: command not found
Pulling down latest helm-charts from remote repo to here: /tmp/KIALI-GIT-KIND/helm-charts
Git repo for the helm charts is found here: /tmp/KIALI-GIT-KIND/helm-charts
make[1]: Entering directory '/tmp/KIALI-GIT-KIND/helm-charts'
Will use this helm executable: /tmp/KIALI-GIT-KIND/helm-charts/_output/helm-install/helm
Building Helm Chart for Kiali operator
==> Linting /tmp/KIALI-GIT-KIND/helm-charts/_output/charts/kiali-operator

1 chart(s) linted, 0 chart(s) failed
Successfully packaged chart and saved it to: /tmp/KIALI-GIT-KIND/helm-charts/_output/charts/kiali-operator-1.73.0-SNAPSHOT.tgz
make[1]: Leaving directory '/tmp/KIALI-GIT-KIND/helm-charts'
Will not auto-detect any hosts for non-OpenShift clusters.
Will not rebuild kiali-molecule image.
podman volume exists molecule-tests-volume && echo "Podman volume already exists; deleting it" && podman volume rm molecule-tests-volume || true
podman volume create molecule-tests-volume
molecule-tests-volume
podman create -v molecule-tests-volume:/data --name molecule-volume-helper docker.io/busybox true
eb52f7216dd4a49afee8af0da973226add05ed88fc12e40d11296a172c680f7c
podman cp "/tmp/KIALI-GIT-KIND/helm-charts" molecule-volume-helper:/data/helm-charts-repo
podman cp "/tmp/KIALI-GIT-KIND/kiali/operator/" molecule-volume-helper:/data/operator
podman cp "/home/jmazzite/.kube/config" molecule-volume-helper:/data/kubeconfig
podman rm molecule-volume-helper
molecule-volume-helper
Error: no such object: "ci-control-plane"
for msn in cluster-wide-access-test; do podman run --rm  --env KUBECONFIG="/tmp/molecule/kubeconfig" --env K8S_AUTH_KUBECONFIG="/tmp/molecule/kubeconfig" --env MOLECULE_CLUSTER_TYPE="kind" --env MOLECULE_HELM_CHARTS_REPO=/tmp/molecule/helm-charts-repo -v molecule-tests-volume:/tmp/molecule   --env MOLECULE_KIND_IP= -w /tmp/molecule/operator --network="host"  --add-host="api.crc.testing:192.168.130.11" --add-host="kiali-istio-system.apps-crc.testing:192.168.130.11" --add-host="prometheus-istio-system.apps-crc.testing:192.168.130.11" --env DORP=podman --env OPERATOR_IMAGE_PULL_SECRET_NAME= --env MOLECULE_KIALI_CR_SPEC_VERSION=default  --env MOLECULE_OPERATOR_PROFILER_ENABLED=true --env MOLECULE_OPERATOR_INSTALLER=helm --env MOLECULE_DUMP_LOGS_ON_ERROR=true  --env MOLECULE_WAIT_RETRIES=120 localhost/kiali-molecule:latest molecule --debug test  --scenario-name ${msn}; if [ "$?" != "0" ]; then echo "Molecule test failed: ${msn}"; podman volume rm molecule-tests-volume; exit 1; fi; done
[2;37mDEBUG   [0m Validating schema [35m/tmp/molecule/operator/molecule/cluster-wide-access-test/[0m[95mmolecule.yml.[0m
[34mINFO    [0m cluster-wide-access-test scenario test matrix: prepare, converge, destroy
[34mINFO    [0m Performing prerun[33m...[0m
[34mINFO    [0m Running ansible-galaxy collection install -vr requirements.yml -p [35m/home/runner/.cache/ansible-compat/06e55b/[0m[95mcollections[0m
[34mINFO    [0m Set [33mANSIBLE_LIBRARY[0m=[35m/home/runner/.cache/ansible-compat/06e55b/[0m[95mmodules[0m:[35m/home/runner/.ansible/plugins/[0m[95mmodules[0m:[35m/usr/share/ansible/plugins/[0m[95mmodules[0m
[34mINFO    [0m Set [33mANSIBLE_COLLECTIONS_PATH[0m=[35m/home/runner/.cache/ansible-compat/06e55b/[0m[95mcollections[0m:[35m/home/runner/.ansible/[0m[95mcollections[0m:[35m/usr/share/ansible/[0m[95mcollections[0m
[34mINFO    [0m Set [33mANSIBLE_ROLES_PATH[0m=[35m/home/runner/.cache/ansible-compat/06e55b/[0m[95mroles[0m:roles:[35m/home/runner/.ansible/[0m[95mroles[0m:[35m/usr/share/ansible/[0m[95mroles[0m:[35m/etc/ansible/[0m[95mroles[0m
[34mINFO    [0m [2;36mRunning [0m[2;32mcluster-wide-access-test[0m[2;36m > [0m[2;32mprepare[0m
[34mINFO    [0m Sanity checks: [32m'podman'[0m
DEBUG: ANSIBLE ENVIRONMENT:
ANSIBLE_COLLECTIONS_PATH: [35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/[0m[95mcollections[0m:[35m/home/runner/.ansible/[0m[95mcollections[0m:[35m/usr/share/ansible/[0m[95mcollections[0m:[35m/etc/ansible/[0m[95mcollections[0m
ANSIBLE_CONFIG: [35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/[0m[95mansible.cfg[0m
ANSIBLE_FILTER_PLUGINS: [35m/usr/local/lib/python3.8/site-packages/molecule/provisioner/ansible/plugins/[0m[95mfilter[0m:[35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/plugins/[0m[95mfilter[0m:[35m/tmp/molecule/operator/plugins/[0m[95mfilter[0m:[35m/home/runner/.ansible/plugins/[0m[95mfilter[0m:[35m/usr/share/ansible/plugins/[0m[95mfilter[0m
ANSIBLE_FORCE_COLOR: [32m'1'[0m
ANSIBLE_LIBRARY: [35m/usr/local/lib/python3.8/site-packages/molecule/provisioner/ansible/plugins/[0m[95mmodules[0m:[35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/[0m[95mlibrary[0m:[35m/tmp/molecule/operator/[0m[95mlibrary[0m:[35m/home/runner/.ansible/plugins/[0m[95mmodules[0m:[35m/usr/share/ansible/plugins/[0m[95mmodules[0m
ANSIBLE_ROLES_PATH: [32m'/home/runner/.cache/molecule/operator/cluster-wide-access-test/roles:/tmp/molecule:/home/runner/.ansible/roles:/usr/share/ansible/roles:/etc/ansible/roles:'[0m

DEBUG: MOLECULE ENVIRONMENT:
MOLECULE_CLUSTER_TYPE: kind
MOLECULE_DEBUG: [32m'True'[0m
MOLECULE_DEPENDENCY_NAME: galaxy
MOLECULE_DRIVER_NAME: podman
MOLECULE_DUMP_LOGS_ON_ERROR: [32m'true'[0m
MOLECULE_ENV_FILE: [35m/tmp/molecule/operator/[0m[95m.env.yml[0m
MOLECULE_EPHEMERAL_DIRECTORY: [35m/home/runner/.cache/molecule/operator/[0m[95mcluster-wide-access-test[0m
MOLECULE_FILE: [35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/[0m[95mmolecule.yml[0m
MOLECULE_HELM_CHARTS_REPO: [35m/tmp/molecule/[0m[95mhelm-charts-repo[0m
MOLECULE_INSTANCE_CONFIG: [35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/[0m[95minstance_config.yml[0m
MOLECULE_INVENTORY_FILE: [35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/inventory/[0m[95mansible_inventory.yml[0m
MOLECULE_KIALI_CR_SPEC_VERSION: default
MOLECULE_KIND_IP: [32m''[0m
MOLECULE_OPERATOR_INSTALLER: helm
MOLECULE_OPERATOR_PROFILER_ENABLED: [32m'true'[0m
MOLECULE_PROJECT_DIRECTORY: [35m/tmp/molecule/[0m[95moperator[0m
MOLECULE_PROVISIONER_NAME: ansible
MOLECULE_SCENARIO_DIRECTORY: [35m/tmp/molecule/operator/molecule/[0m[95mcluster-wide-access-test[0m
MOLECULE_SCENARIO_NAME: cluster-wide-access-test
MOLECULE_STATE_FILE: [35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/[0m[95mstate.yml[0m
MOLECULE_VERIFIER_NAME: ansible
MOLECULE_VERIFIER_TEST_DIRECTORY: [35m/tmp/molecule/operator/molecule/cluster-wide-access-test/[0m[95mtests[0m
MOLECULE_WAIT_RETRIES: [32m'120'[0m

DEBUG: SHELL REPLAY:
[33mANSIBLE_COLLECTIONS_PATH[0m=[35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/[0m[95mcollections[0m:[35m/home/runner/.ansible/[0m[95mcollections[0m:[35m/usr/share/ansible/[0m[95mcollections[0m:[35m/etc/ansible/[0m[95mcollections[0m [33mANSIBLE_CONFIG[0m=[35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/[0m[95mansible.cfg[0m [33mANSIBLE_FILTER_PLUGINS[0m=[35m/usr/local/lib/python3.8/site-packages/molecule/provisioner/ansible/plugins/[0m[95mfilter[0m:[35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/plugins/[0m[95mfilter[0m:[35m/tmp/molecule/operator/plugins/[0m[95mfilter[0m:[35m/home/runner/.ansible/plugins/[0m[95mfilter[0m:[35m/usr/share/ansible/plugins/[0m[95mfilter[0m [33mANSIBLE_FORCE_COLOR[0m=[1;36m1[0m [33mANSIBLE_LIBRARY[0m=[35m/usr/local/lib/python3.8/site-packages/molecule/provisioner/ansible/plugins/[0m[95mmodules[0m:[35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/[0m[95mlibrary[0m:[35m/tmp/molecule/operator/[0m[95mlibrary[0m:[35m/home/runner/.ansible/plugins/[0m[95mmodules[0m:[35m/usr/share/ansible/plugins/[0m[95mmodules[0m [33mANSIBLE_ROLES_PATH[0m=[35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/[0m[95mroles[0m:[35m/tmp/[0m[95mmolecule[0m:[35m/home/runner/.ansible/[0m[95mroles[0m:[35m/usr/share/ansible/[0m[95mroles[0m:[35m/etc/ansible/[0m[95mroles[0m: [33mMOLECULE_CLUSTER_TYPE[0m=[35mkind[0m [33mMOLECULE_DEBUG[0m=[3;92mTrue[0m [33mMOLECULE_DEPENDENCY_NAME[0m=[35mgalaxy[0m [33mMOLECULE_DRIVER_NAME[0m=[35mpodman[0m [33mMOLECULE_DUMP_LOGS_ON_ERROR[0m=[35mtrue[0m [33mMOLECULE_ENV_FILE[0m=[35m/tmp/molecule/operator/[0m[95m.env.yml[0m [33mMOLECULE_EPHEMERAL_DIRECTORY[0m=[35m/home/runner/.cache/molecule/operator/[0m[95mcluster-wide-access-test[0m [33mMOLECULE_FILE[0m=[35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/[0m[95mmolecule.yml[0m [33mMOLECULE_HELM_CHARTS_REPO[0m=[35m/tmp/molecule/[0m[95mhelm-charts-repo[0m [33mMOLECULE_INSTANCE_CONFIG[0m=[35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/[0m[95minstance_config.yml[0m [33mMOLECULE_INVENTORY_FILE[0m=[35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/inventory/[0m[95mansible_inventory.yml[0m [33mMOLECULE_KIALI_CR_SPEC_VERSION[0m=[35mdefault[0m [33mMOLECULE_KIND_IP[0m= [33mMOLECULE_OPERATOR_INSTALLER[0m=[35mhelm[0m [33mMOLECULE_OPERATOR_PROFILER_ENABLED[0m=[35mtrue[0m [33mMOLECULE_PROJECT_DIRECTORY[0m=[35m/tmp/molecule/[0m[95moperator[0m [33mMOLECULE_PROVISIONER_NAME[0m=[35mansible[0m [33mMOLECULE_SCENARIO_DIRECTORY[0m=[35m/tmp/molecule/operator/molecule/[0m[95mcluster-wide-access-test[0m [33mMOLECULE_SCENARIO_NAME[0m=[35mcluster[0m-wide-access-test [33mMOLECULE_STATE_FILE[0m=[35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/[0m[95mstate.yml[0m [33mMOLECULE_VERIFIER_NAME[0m=[35mansible[0m [33mMOLECULE_VERIFIER_TEST_DIRECTORY[0m=[35m/tmp/molecule/operator/molecule/cluster-wide-access-test/[0m[95mtests[0m [33mMOLECULE_WAIT_RETRIES[0m=[1;36m120[0m


PLAY [Prepare] *****************************************************************

TASK [Gathering Facts] *********************************************************
[32mok: [localhost][0m

PLAY [Process Test Namespaces [state=present]] *********************************

TASK [Gathering Facts] *********************************************************
[32mok: [localhost][0m

TASK [k8s] *********************************************************************
[33mchanged: [localhost][0m

TASK [k8s] *********************************************************************
[33mchanged: [localhost][0m

TASK [k8s] *********************************************************************
[33mchanged: [localhost][0m

PLAY [Prepare] *****************************************************************

TASK [Gathering Facts] *********************************************************
[32mok: [localhost][0m

TASK [Get information about the cluster] ***************************************
[32mok: [localhost][0m

TASK [Determine the cluster type] **********************************************
[32mok: [localhost][0m

TASK [Determine the Istio implementation] **************************************
[32mok: [localhost][0m

TASK [Determine if the operator installation is managed externally or not] *****
[32mok: [localhost][0m

TASK [Get the SMCP name if on Maistra] *****************************************
[36mskipping: [localhost][0m

TASK [set_fact] ****************************************************************
[36mskipping: [localhost][0m

TASK [See if we have Maistra htpasswd secret for accessing external services like Prometheus] ***
[36mskipping: [localhost][0m

TASK [set_fact] ****************************************************************
[36mskipping: [localhost][0m

TASK [Make sure the operator namespace exists] *********************************
[33mchanged: [localhost][0m

TASK [Find the latest Operator Helm Chart] *************************************
[33mchanged: [localhost][0m

TASK [set_fact] ****************************************************************
[32mok: [localhost][0m

TASK [fail] ********************************************************************
[36mskipping: [localhost][0m

TASK [Install Operator via Helm] ***********************************************
[33mchanged: [localhost][0m

TASK [Make sure the CR namespace exists] ***************************************
[32mok: [localhost][0m

TASK [Process NetworkPolicy needed to access the Kiali UI when in Maistra environment [state=present]] ***
[36mskipping: [localhost][0m

TASK [Wait for the CRD to be established] **************************************
[32mok: [localhost][0m

TASK [Prepare initial Kiali CR definition based solely on the template] ********
[32mok: [localhost][0m

TASK [Modify the Kiali CR definition with specific Maistra config for Prometheus, Tracing, Grafana and Istio] ***
[36mskipping: [localhost][0m

TASK [Create Kiali CR] *********************************************************
[33mchanged: [localhost][0m

TASK [Asserting that Kiali is Deployed] ****************************************
[1;30mFAILED - RETRYING: [localhost]: Asserting that Kiali is Deployed (120 retries left).[0m
[1;30mFAILED - RETRYING: [localhost]: Asserting that Kiali is Deployed (119 retries left).[0m
[1;30mFAILED - RETRYING: [localhost]: Asserting that Kiali is Deployed (118 retries left).[0m
[1;30mFAILED - RETRYING: [localhost]: Asserting that Kiali is Deployed (117 retries left).[0m
[1;30mFAILED - RETRYING: [localhost]: Asserting that Kiali is Deployed (116 retries left).[0m
[1;30mFAILED - RETRYING: [localhost]: Asserting that Kiali is Deployed (115 retries left).[0m
[1;30mFAILED - RETRYING: [localhost]: Asserting that Kiali is Deployed (114 retries left).[0m
[1;30mFAILED - RETRYING: [localhost]: Asserting that Kiali is Deployed (113 retries left).[0m
[32mok: [localhost][0m

PLAY RECAP *********************************************************************
[33mlocalhost[0m                  : [32mok=19  [0m [33mchanged=7   [0m unreachable=0    failed=0    [36mskipped=7   [0m rescued=0    ignored=0

[34mINFO    [0m [2;36mRunning [0m[2;32mcluster-wide-access-test[0m[2;36m > [0m[2;32mconverge[0m
DEBUG: ANSIBLE ENVIRONMENT:
ANSIBLE_COLLECTIONS_PATH: [35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/[0m[95mcollections[0m:[35m/home/runner/.ansible/[0m[95mcollections[0m:[35m/usr/share/ansible/[0m[95mcollections[0m:[35m/etc/ansible/[0m[95mcollections[0m
ANSIBLE_CONFIG: [35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/[0m[95mansible.cfg[0m
ANSIBLE_FILTER_PLUGINS: [35m/usr/local/lib/python3.8/site-packages/molecule/provisioner/ansible/plugins/[0m[95mfilter[0m:[35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/plugins/[0m[95mfilter[0m:[35m/tmp/molecule/operator/plugins/[0m[95mfilter[0m:[35m/home/runner/.ansible/plugins/[0m[95mfilter[0m:[35m/usr/share/ansible/plugins/[0m[95mfilter[0m
ANSIBLE_FORCE_COLOR: [32m'1'[0m
ANSIBLE_LIBRARY: [35m/usr/local/lib/python3.8/site-packages/molecule/provisioner/ansible/plugins/[0m[95mmodules[0m:[35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/[0m[95mlibrary[0m:[35m/tmp/molecule/operator/[0m[95mlibrary[0m:[35m/home/runner/.ansible/plugins/[0m[95mmodules[0m:[35m/usr/share/ansible/plugins/[0m[95mmodules[0m
ANSIBLE_ROLES_PATH: [32m'/home/runner/.cache/molecule/operator/cluster-wide-access-test/roles:/tmp/molecule:/home/runner/.ansible/roles:/usr/share/ansible/roles:/etc/ansible/roles:'[0m

DEBUG: MOLECULE ENVIRONMENT:
MOLECULE_CLUSTER_TYPE: kind
MOLECULE_DEBUG: [32m'True'[0m
MOLECULE_DEPENDENCY_NAME: galaxy
MOLECULE_DRIVER_NAME: podman
MOLECULE_DUMP_LOGS_ON_ERROR: [32m'true'[0m
MOLECULE_ENV_FILE: [35m/tmp/molecule/operator/[0m[95m.env.yml[0m
MOLECULE_EPHEMERAL_DIRECTORY: [35m/home/runner/.cache/molecule/operator/[0m[95mcluster-wide-access-test[0m
MOLECULE_FILE: [35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/[0m[95mmolecule.yml[0m
MOLECULE_HELM_CHARTS_REPO: [35m/tmp/molecule/[0m[95mhelm-charts-repo[0m
MOLECULE_INSTANCE_CONFIG: [35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/[0m[95minstance_config.yml[0m
MOLECULE_INVENTORY_FILE: [35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/inventory/[0m[95mansible_inventory.yml[0m
MOLECULE_KIALI_CR_SPEC_VERSION: default
MOLECULE_KIND_IP: [32m''[0m
MOLECULE_OPERATOR_INSTALLER: helm
MOLECULE_OPERATOR_PROFILER_ENABLED: [32m'true'[0m
MOLECULE_PROJECT_DIRECTORY: [35m/tmp/molecule/[0m[95moperator[0m
MOLECULE_PROVISIONER_NAME: ansible
MOLECULE_SCENARIO_DIRECTORY: [35m/tmp/molecule/operator/molecule/[0m[95mcluster-wide-access-test[0m
MOLECULE_SCENARIO_NAME: cluster-wide-access-test
MOLECULE_STATE_FILE: [35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/[0m[95mstate.yml[0m
MOLECULE_VERIFIER_NAME: ansible
MOLECULE_VERIFIER_TEST_DIRECTORY: [35m/tmp/molecule/operator/molecule/cluster-wide-access-test/[0m[95mtests[0m
MOLECULE_WAIT_RETRIES: [32m'120'[0m

DEBUG: SHELL REPLAY:
[33mANSIBLE_COLLECTIONS_PATH[0m=[35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/[0m[95mcollections[0m:[35m/home/runner/.ansible/[0m[95mcollections[0m:[35m/usr/share/ansible/[0m[95mcollections[0m:[35m/etc/ansible/[0m[95mcollections[0m [33mANSIBLE_CONFIG[0m=[35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/[0m[95mansible.cfg[0m [33mANSIBLE_FILTER_PLUGINS[0m=[35m/usr/local/lib/python3.8/site-packages/molecule/provisioner/ansible/plugins/[0m[95mfilter[0m:[35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/plugins/[0m[95mfilter[0m:[35m/tmp/molecule/operator/plugins/[0m[95mfilter[0m:[35m/home/runner/.ansible/plugins/[0m[95mfilter[0m:[35m/usr/share/ansible/plugins/[0m[95mfilter[0m [33mANSIBLE_FORCE_COLOR[0m=[1;36m1[0m [33mANSIBLE_LIBRARY[0m=[35m/usr/local/lib/python3.8/site-packages/molecule/provisioner/ansible/plugins/[0m[95mmodules[0m:[35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/[0m[95mlibrary[0m:[35m/tmp/molecule/operator/[0m[95mlibrary[0m:[35m/home/runner/.ansible/plugins/[0m[95mmodules[0m:[35m/usr/share/ansible/plugins/[0m[95mmodules[0m [33mANSIBLE_ROLES_PATH[0m=[35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/[0m[95mroles[0m:[35m/tmp/[0m[95mmolecule[0m:[35m/home/runner/.ansible/[0m[95mroles[0m:[35m/usr/share/ansible/[0m[95mroles[0m:[35m/etc/ansible/[0m[95mroles[0m: [33mMOLECULE_CLUSTER_TYPE[0m=[35mkind[0m [33mMOLECULE_DEBUG[0m=[3;92mTrue[0m [33mMOLECULE_DEPENDENCY_NAME[0m=[35mgalaxy[0m [33mMOLECULE_DRIVER_NAME[0m=[35mpodman[0m [33mMOLECULE_DUMP_LOGS_ON_ERROR[0m=[35mtrue[0m [33mMOLECULE_ENV_FILE[0m=[35m/tmp/molecule/operator/[0m[95m.env.yml[0m [33mMOLECULE_EPHEMERAL_DIRECTORY[0m=[35m/home/runner/.cache/molecule/operator/[0m[95mcluster-wide-access-test[0m [33mMOLECULE_FILE[0m=[35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/[0m[95mmolecule.yml[0m [33mMOLECULE_HELM_CHARTS_REPO[0m=[35m/tmp/molecule/[0m[95mhelm-charts-repo[0m [33mMOLECULE_INSTANCE_CONFIG[0m=[35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/[0m[95minstance_config.yml[0m [33mMOLECULE_INVENTORY_FILE[0m=[35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/inventory/[0m[95mansible_inventory.yml[0m [33mMOLECULE_KIALI_CR_SPEC_VERSION[0m=[35mdefault[0m [33mMOLECULE_KIND_IP[0m= [33mMOLECULE_OPERATOR_INSTALLER[0m=[35mhelm[0m [33mMOLECULE_OPERATOR_PROFILER_ENABLED[0m=[35mtrue[0m [33mMOLECULE_PROJECT_DIRECTORY[0m=[35m/tmp/molecule/[0m[95moperator[0m [33mMOLECULE_PROVISIONER_NAME[0m=[35mansible[0m [33mMOLECULE_SCENARIO_DIRECTORY[0m=[35m/tmp/molecule/operator/molecule/[0m[95mcluster-wide-access-test[0m [33mMOLECULE_SCENARIO_NAME[0m=[35mcluster[0m-wide-access-test [33mMOLECULE_STATE_FILE[0m=[35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/[0m[95mstate.yml[0m [33mMOLECULE_VERIFIER_NAME[0m=[35mansible[0m [33mMOLECULE_VERIFIER_TEST_DIRECTORY[0m=[35m/tmp/molecule/operator/molecule/cluster-wide-access-test/[0m[95mtests[0m [33mMOLECULE_WAIT_RETRIES[0m=[1;36m120[0m


PLAY [Tests] *******************************************************************

TASK [Gathering Facts] *********************************************************
[32mok: [localhost][0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/common/tasks.yml for localhost[0m

TASK [Get information about the cluster] ***************************************
[32mok: [localhost][0m

TASK [Determine the cluster type] **********************************************
[32mok: [localhost][0m

TASK [Determine the Istio implementation] **************************************
[32mok: [localhost][0m

TASK [Get SMCP if running in Maistra environment] ******************************
[36mskipping: [localhost][0m

TASK [There must one and only one SMCP already installed in the control plane] ***
[36mskipping: [localhost][0m

TASK [Get Kiali CR if present] *************************************************
[32mok: [localhost][0m

TASK [Get Kiali Operator Pod] **************************************************
[32mok: [localhost][0m

TASK [Get Kiali Pod] ***********************************************************
[32mok: [localhost][0m

TASK [Get Kiali Configmap] *****************************************************
[32mok: [localhost][0m

TASK [Format Configmap] ********************************************************
[32mok: [localhost][0m

TASK [Get Kiali Deployment] ****************************************************
[32mok: [localhost][0m

TASK [Get Kiali Service] *******************************************************
[32mok: [localhost][0m

TASK [Get Kiali Route] *********************************************************
[36mskipping: [localhost][0m

TASK [Determine the Kiali Route URL on OpenShift] ******************************
[36mskipping: [localhost][0m

TASK [Determine the Kiali Ingress URL on minikube] *****************************
[36mskipping: [localhost][0m

TASK [Determine the Kiali Ingress URL on kind] *********************************
[32mok: [localhost][0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/asserts/pod_asserts.yml for localhost[0m

TASK [Assert Kiali Pod is Running and there is only one] ***********************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Assert Kiali Pod is Running on the correct Namespace] ********************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/asserts/accessible_namespaces_contains.yml for localhost[0m

TASK [Assert Accessible Namespaces contains ['**']] ****************************
[32mok: [localhost] => (item=**) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": "**",[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [debug] *******************************************************************
[32mok: [localhost] => {[0m
[32m    "msg": "test to make sure the default AN=** behavior works (cluster-wide-access is True)"[0m
[32m}[0m

TASK [assert] ******************************************************************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [debug] *******************************************************************
[32mok: [localhost] => {[0m
[32m    "msg": "assert that we have clusterroles since we have been given cluster wide access"[0m
[32m}[0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/asserts/roles-test/rw_clusterrole_asserts.yml for localhost[0m

TASK [Get cluster roles] *******************************************************
[32mok: [localhost][0m

TASK [Assert that cluster roles exist] *****************************************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Get cluster role binding] ************************************************
[32mok: [localhost][0m

TASK [Assert the cluster role binding provides the read-write role] ************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/asserts/roles-test/none_role_asserts.yml for localhost[0m

TASK [Get roles] ***************************************************************
[32mok: [localhost] => (item=['istio-system', 'kiali'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-1', 'kiali'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-2', 'kiali'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-x', 'kiali'])[0m

TASK [Assert that namespaces do not have the roles] ****************************
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'istio-system', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['istio-system', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "istio-system",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "istio-system",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'cluster-wide-access-test-1', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-1', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "cluster-wide-access-test-1",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-1",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'cluster-wide-access-test-2', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-2', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "cluster-wide-access-test-2",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-2",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'cluster-wide-access-test-x', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-x', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "cluster-wide-access-test-x",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-x",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Get viewer roles] ********************************************************
[32mok: [localhost] => (item=['istio-system', 'kiali-viewer'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-1', 'kiali-viewer'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-2', 'kiali-viewer'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-x', 'kiali-viewer'])[0m

TASK [Assert that namespaces do not have the viewer roles] *********************
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'istio-system', 'name': 'kiali-viewer', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['istio-system', 'kiali-viewer'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali-viewer",[0m
[32m                "namespace": "istio-system",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "istio-system",[0m
[32m            "kiali-viewer"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'cluster-wide-access-test-1', 'name': 'kiali-viewer', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-1', 'kiali-viewer'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali-viewer",[0m
[32m                "namespace": "cluster-wide-access-test-1",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-1",[0m
[32m            "kiali-viewer"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'cluster-wide-access-test-2', 'name': 'kiali-viewer', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-2', 'kiali-viewer'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali-viewer",[0m
[32m                "namespace": "cluster-wide-access-test-2",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-2",[0m
[32m            "kiali-viewer"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'cluster-wide-access-test-x', 'name': 'kiali-viewer', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-x', 'kiali-viewer'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali-viewer",[0m
[32m                "namespace": "cluster-wide-access-test-x",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-x",[0m
[32m            "kiali-viewer"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Get role bindings] *******************************************************
[32mok: [localhost] => (item=['istio-system', 'kiali'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-1', 'kiali'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-2', 'kiali'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-x', 'kiali'])[0m

TASK [Assert the role bindings do not exist] ***********************************
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'RoleBinding', 'namespace': 'istio-system', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['istio-system', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "RoleBinding",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "istio-system",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "istio-system",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'RoleBinding', 'namespace': 'cluster-wide-access-test-1', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-1', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "RoleBinding",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "cluster-wide-access-test-1",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-1",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'RoleBinding', 'namespace': 'cluster-wide-access-test-2', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-2', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "RoleBinding",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "cluster-wide-access-test-2",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-2",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'RoleBinding', 'namespace': 'cluster-wide-access-test-x', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-x', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "RoleBinding",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "cluster-wide-access-test-x",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-x",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [debug] *******************************************************************
[32mok: [localhost] => {[0m
[32m    "msg": "The server should return all namespaces"[0m
[32m}[0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/asserts/assert-api-namespaces-result.yml for localhost[0m

TASK [Call /namespaces API] ****************************************************
[32mok: [localhost][0m

TASK [Results of /namespaces API] **********************************************
[32mok: [localhost] => {[0m
[32m    "msg": {[0m
[32m        "changed": false,[0m
[32m        "connection": "close",[0m
[32m        "content": "[{\"name\":\"cluster-wide-access-test-1\",\"cluster\":\"Kubernetes\",\"isAmbient\":false,\"labels\":{\"discoverySelectorLabel1\":\"test\",\"kubernetes.io/metadata.name\":\"cluster-wide-access-test-1\"},\"annotations\":{}},{\"name\":\"cluster-wide-access-test-2\",\"cluster\":\"Kubernetes\",\"isAmbient\":false,\"labels\":{\"discoverySelectorLabel2\":\"matchme\",\"kubernetes.io/metadata.name\":\"cluster-wide-access-test-2\"},\"annotations\":{}},{\"name\":\"cluster-wide-access-test-x\",\"cluster\":\"Kubernetes\",\"isAmbient\":false,\"labels\":{\"kubernetes.io/metadata.name\":\"cluster-wide-access-test-x\"},\"annotations\":{}},{\"name\":\"default\",\"cluster\":\"Kubernetes\",\"isAmbient\":false,\"labels\":{\"kubernetes.io/metadata.name\":\"default\"},\"annotations\":{}},{\"name\":\"istio-system\",\"cluster\":\"Kubernetes\",\"isAmbient\":false,\"labels\":{\"kubernetes.io/metadata.name\":\"istio-system\",\"topology.istio.io/network\":\"\"},\"annotations\":{}},{\"name\":\"local-path-storage\",\"cluster\":\"Kubernetes\",\"isAmbient\":false,\"labels\":{\"kubernetes.io/metadata.name\":\"local-path-storage\"},\"annotations\":{}},{\"name\":\"metallb-system\",\"cluster\":\"Kubernetes\",\"isAmbient\":false,\"labels\":{\"kubernetes.io/metadata.name\":\"metallb-system\",\"pod-security.kubernetes.io/audit\":\"privileged\",\"pod-security.kubernetes.io/enforce\":\"privileged\",\"pod-security.kubernetes.io/warn\":\"privileged\"},\"annotations\":{}}]",[0m
[32m        "content_length": "1302",[0m
[32m        "content_type": "application/json",[0m
[32m        "cookies": {},[0m
[32m        "cookies_string": "",[0m
[32m        "date": "Thu, 17 Aug 2023 07:17:19 GMT",[0m
[32m        "elapsed": 0,[0m
[32m        "failed": false,[0m
[32m        "json": [[0m
[32m            {[0m
[32m                "annotations": {},[0m
[32m                "cluster": "Kubernetes",[0m
[32m                "isAmbient": false,[0m
[32m                "labels": {[0m
[32m                    "discoverySelectorLabel1": "test",[0m
[32m                    "kubernetes.io/metadata.name": "cluster-wide-access-test-1"[0m
[32m                },[0m
[32m                "name": "cluster-wide-access-test-1"[0m
[32m            },[0m
[32m            {[0m
[32m                "annotations": {},[0m
[32m                "cluster": "Kubernetes",[0m
[32m                "isAmbient": false,[0m
[32m                "labels": {[0m
[32m                    "discoverySelectorLabel2": "matchme",[0m
[32m                    "kubernetes.io/metadata.name": "cluster-wide-access-test-2"[0m
[32m                },[0m
[32m                "name": "cluster-wide-access-test-2"[0m
[32m            },[0m
[32m            {[0m
[32m                "annotations": {},[0m
[32m                "cluster": "Kubernetes",[0m
[32m                "isAmbient": false,[0m
[32m                "labels": {[0m
[32m                    "kubernetes.io/metadata.name": "cluster-wide-access-test-x"[0m
[32m                },[0m
[32m                "name": "cluster-wide-access-test-x"[0m
[32m            },[0m
[32m            {[0m
[32m                "annotations": {},[0m
[32m                "cluster": "Kubernetes",[0m
[32m                "isAmbient": false,[0m
[32m                "labels": {[0m
[32m                    "kubernetes.io/metadata.name": "default"[0m
[32m                },[0m
[32m                "name": "default"[0m
[32m            },[0m
[32m            {[0m
[32m                "annotations": {},[0m
[32m                "cluster": "Kubernetes",[0m
[32m                "isAmbient": false,[0m
[32m                "labels": {[0m
[32m                    "kubernetes.io/metadata.name": "istio-system",[0m
[32m                    "topology.istio.io/network": ""[0m
[32m                },[0m
[32m                "name": "istio-system"[0m
[32m            },[0m
[32m            {[0m
[32m                "annotations": {},[0m
[32m                "cluster": "Kubernetes",[0m
[32m                "isAmbient": false,[0m
[32m                "labels": {[0m
[32m                    "kubernetes.io/metadata.name": "local-path-storage"[0m
[32m                },[0m
[32m                "name": "local-path-storage"[0m
[32m            },[0m
[32m            {[0m
[32m                "annotations": {},[0m
[32m                "cluster": "Kubernetes",[0m
[32m                "isAmbient": false,[0m
[32m                "labels": {[0m
[32m                    "kubernetes.io/metadata.name": "metallb-system",[0m
[32m                    "pod-security.kubernetes.io/audit": "privileged",[0m
[32m                    "pod-security.kubernetes.io/enforce": "privileged",[0m
[32m                    "pod-security.kubernetes.io/warn": "privileged"[0m
[32m                },[0m
[32m                "name": "metallb-system"[0m
[32m            }[0m
[32m        ],[0m
[32m        "msg": "OK (1302 bytes)",[0m
[32m        "redirected": false,[0m
[32m        "status": 200,[0m
[32m        "url": "http://172.18.255.71:20001/kiali/api/namespaces",[0m
[32m        "vary": "Accept-Encoding"[0m
[32m    }[0m
[32m}[0m

TASK [Assert that we got no less than the minimum number of namespaces expected] ***
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Assert that we got no more than the maximum number of namespaces expected] ***
[36mskipping: [localhost][0m

TASK [Assert that we got the namespaces expected] ******************************
[32mok: [localhost] => (item=istio-system) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": "istio-system",[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item=cluster-wide-access-test-1) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": "cluster-wide-access-test-1",[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item=cluster-wide-access-test-2) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": "cluster-wide-access-test-2",[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item=cluster-wide-access-test-x) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": "cluster-wide-access-test-x",[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Assert that we did not get namespaces that were not expected] ************
[32mok: [localhost] => (item=kiali-operator) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": "kiali-operator",[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [debug] *******************************************************************
[32mok: [localhost] => {[0m
[32m    "msg": "change to accessible_namespaces to a fixed list of namespaces but keep cluster-wide-access (set to True)"[0m
[32m}[0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/common/set_accessible_namespaces_to_list.yml for localhost[0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/cluster-wide-access-test/../common/../common/wait_for_kiali_cr_changes.yml for localhost[0m

TASK [Wait for Kiali CR changes to take effect] ********************************
[32mok: [localhost][0m

TASK [Set accessible namespace to ['istio-system', 'cluster-wide-access-test-[1x]'] in current Kiali CR] ***
[32mok: [localhost][0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/cluster-wide-access-test/../common/../common/set_kiali_cr.yml for localhost[0m

TASK [Change Kiali CR with new Kiali CR] ***************************************
[31m--- before[0m
[32m+++ after[0m
[36m@@ -1,43 +1,7 @@[0m
 {
     "metadata": {
[31m-        "generation": 1,[0m
[32m+        "generation": 2,[0m
         "managedFields": [
[31m-            {[0m
[31m-                "apiVersion": "kiali.io/v1alpha1",[0m
[31m-                "fieldsType": "FieldsV1",[0m
[31m-                "fieldsV1": {[0m
[31m-                    "f:spec": {[0m
[31m-                        ".": {},[0m
[31m-                        "f:auth": {[0m
[31m-                            ".": {},[0m
[31m-                            "f:strategy": {}[0m
[31m-                        },[0m
[31m-                        "f:deployment": {[0m
[31m-                            ".": {},[0m
[31m-                            "f:accessible_namespaces": {},[0m
[31m-                            "f:cluster_wide_access": {},[0m
[31m-                            "f:image_name": {},[0m
[31m-                            "f:image_pull_policy": {},[0m
[31m-                            "f:image_version": {},[0m
[31m-                            "f:ingress": {[0m
[31m-                                ".": {},[0m
[31m-                                "f:enabled": {}[0m
[31m-                            },[0m
[31m-                            "f:logger": {[0m
[31m-                                ".": {},[0m
[31m-                                "f:log_level": {}[0m
[31m-                            },[0m
[31m-                            "f:namespace": {},[0m
[31m-                            "f:service_type": {}[0m
[31m-                        },[0m
[31m-                        "f:istio_namespace": {},[0m
[31m-                        "f:version": {}[0m
[31m-                    }[0m
[31m-                },[0m
[31m-                "manager": "OpenAPI-Generator",[0m
[31m-                "operation": "Update",[0m
[31m-                "time": "2023-08-17T07:16:19Z"[0m
[31m-            },[0m
             {
                 "apiVersion": "kiali.io/v1alpha1",
                 "fieldsType": "FieldsV1",
[36m@@ -96,14 +60,51 @@[0m
                 "operation": "Update",
                 "subresource": "status",
                 "time": "2023-08-17T07:16:35Z"
[32m+            },[0m
[32m+            {[0m
[32m+                "apiVersion": "kiali.io/v1alpha1",[0m
[32m+                "fieldsType": "FieldsV1",[0m
[32m+                "fieldsV1": {[0m
[32m+                    "f:spec": {[0m
[32m+                        ".": {},[0m
[32m+                        "f:auth": {[0m
[32m+                            ".": {},[0m
[32m+                            "f:strategy": {}[0m
[32m+                        },[0m
[32m+                        "f:deployment": {[0m
[32m+                            ".": {},[0m
[32m+                            "f:accessible_namespaces": {},[0m
[32m+                            "f:cluster_wide_access": {},[0m
[32m+                            "f:image_name": {},[0m
[32m+                            "f:image_pull_policy": {},[0m
[32m+                            "f:image_version": {},[0m
[32m+                            "f:ingress": {[0m
[32m+                                ".": {},[0m
[32m+                                "f:enabled": {}[0m
[32m+                            },[0m
[32m+                            "f:logger": {[0m
[32m+                                ".": {},[0m
[32m+                                "f:log_level": {}[0m
[32m+                            },[0m
[32m+                            "f:namespace": {},[0m
[32m+                            "f:service_type": {}[0m
[32m+                        },[0m
[32m+                        "f:istio_namespace": {},[0m
[32m+                        "f:version": {}[0m
[32m+                    }[0m
[32m+                },[0m
[32m+                "manager": "OpenAPI-Generator",[0m
[32m+                "operation": "Update",[0m
[32m+                "time": "2023-08-17T07:17:21Z"[0m
             }
         ],
[31m-        "resourceVersion": "3730"[0m
[32m+        "resourceVersion": "3825"[0m
     },
     "spec": {
         "deployment": {
             "accessible_namespaces": [
[31m-                "**"[0m
[32m+                "istio-system",[0m
[32m+                "cluster-wide-access-test-[1x]"[0m
             ]
         }
     }

[33mchanged: [localhost][0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/common/wait_for_kiali_cr_changes.yml for localhost[0m

TASK [Wait for Kiali CR changes to take effect] ********************************
[1;30mFAILED - RETRYING: [localhost]: Wait for Kiali CR changes to take effect (120 retries left).[0m
[1;30mFAILED - RETRYING: [localhost]: Wait for Kiali CR changes to take effect (119 retries left).[0m
[1;30mFAILED - RETRYING: [localhost]: Wait for Kiali CR changes to take effect (118 retries left).[0m
[32mok: [localhost][0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/common/wait_for_kiali_running.yml for localhost[0m

TASK [Asserting that Kiali Pod exists and there is only one] *******************
[32mok: [localhost][0m

TASK [Wait for Kiali to be running and accepting requests] *********************
[1;30mFAILED - RETRYING: [localhost]: Wait for Kiali to be running and accepting requests (120 retries left).[0m
[32mok: [localhost][0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/common/tasks.yml for localhost[0m

TASK [Get information about the cluster] ***************************************
[32mok: [localhost][0m

TASK [Determine the cluster type] **********************************************
[32mok: [localhost][0m

TASK [Determine the Istio implementation] **************************************
[32mok: [localhost][0m

TASK [Get SMCP if running in Maistra environment] ******************************
[36mskipping: [localhost][0m

TASK [There must one and only one SMCP already installed in the control plane] ***
[36mskipping: [localhost][0m

TASK [Get Kiali CR if present] *************************************************
[32mok: [localhost][0m

TASK [Get Kiali Operator Pod] **************************************************
[32mok: [localhost][0m

TASK [Get Kiali Pod] ***********************************************************
[32mok: [localhost][0m

TASK [Get Kiali Configmap] *****************************************************
[32mok: [localhost][0m

TASK [Format Configmap] ********************************************************
[32mok: [localhost][0m

TASK [Get Kiali Deployment] ****************************************************
[32mok: [localhost][0m

TASK [Get Kiali Service] *******************************************************
[32mok: [localhost][0m

TASK [Get Kiali Route] *********************************************************
[36mskipping: [localhost][0m

TASK [Determine the Kiali Route URL on OpenShift] ******************************
[36mskipping: [localhost][0m

TASK [Determine the Kiali Ingress URL on minikube] *****************************
[36mskipping: [localhost][0m

TASK [Determine the Kiali Ingress URL on kind] *********************************
[32mok: [localhost][0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/asserts/pod_asserts.yml for localhost[0m

TASK [Assert Kiali Pod is Running and there is only one] ***********************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Assert Kiali Pod is Running on the correct Namespace] ********************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/asserts/accessible_namespaces_equals.yml for localhost[0m

TASK [Assert Accessible Namespaces is ['istio-system', 'cluster-wide-access-test-1', 'cluster-wide-access-test-x']] ***
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [debug] *******************************************************************
[32mok: [localhost] => {[0m
[32m    "msg": "test the normal accessible namespaces"[0m
[32m}[0m

TASK [Even though AN is not **, cluster wide access should still be True because we explicitly asked for it] ***
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [debug] *******************************************************************
[32mok: [localhost] => {[0m
[32m    "msg": "assert that we have clusterroles since we have been given cluster wide access"[0m
[32m}[0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/asserts/roles-test/rw_clusterrole_asserts.yml for localhost[0m

TASK [Get cluster roles] *******************************************************
[32mok: [localhost][0m

TASK [Assert that cluster roles exist] *****************************************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Get cluster role binding] ************************************************
[32mok: [localhost][0m

TASK [Assert the cluster role binding provides the read-write role] ************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/asserts/roles-test/none_role_asserts.yml for localhost[0m

TASK [Get roles] ***************************************************************
[32mok: [localhost] => (item=['istio-system', 'kiali'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-1', 'kiali'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-2', 'kiali'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-x', 'kiali'])[0m

TASK [Assert that namespaces do not have the roles] ****************************
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'istio-system', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['istio-system', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "istio-system",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "istio-system",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'cluster-wide-access-test-1', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-1', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "cluster-wide-access-test-1",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-1",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'cluster-wide-access-test-2', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-2', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "cluster-wide-access-test-2",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-2",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'cluster-wide-access-test-x', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-x', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "cluster-wide-access-test-x",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-x",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Get viewer roles] ********************************************************
[32mok: [localhost] => (item=['istio-system', 'kiali-viewer'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-1', 'kiali-viewer'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-2', 'kiali-viewer'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-x', 'kiali-viewer'])[0m

TASK [Assert that namespaces do not have the viewer roles] *********************
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'istio-system', 'name': 'kiali-viewer', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['istio-system', 'kiali-viewer'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali-viewer",[0m
[32m                "namespace": "istio-system",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "istio-system",[0m
[32m            "kiali-viewer"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'cluster-wide-access-test-1', 'name': 'kiali-viewer', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-1', 'kiali-viewer'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali-viewer",[0m
[32m                "namespace": "cluster-wide-access-test-1",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-1",[0m
[32m            "kiali-viewer"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'cluster-wide-access-test-2', 'name': 'kiali-viewer', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-2', 'kiali-viewer'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali-viewer",[0m
[32m                "namespace": "cluster-wide-access-test-2",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-2",[0m
[32m            "kiali-viewer"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'cluster-wide-access-test-x', 'name': 'kiali-viewer', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-x', 'kiali-viewer'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali-viewer",[0m
[32m                "namespace": "cluster-wide-access-test-x",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-x",[0m
[32m            "kiali-viewer"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Get role bindings] *******************************************************
[32mok: [localhost] => (item=['istio-system', 'kiali'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-1', 'kiali'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-2', 'kiali'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-x', 'kiali'])[0m

TASK [Assert the role bindings do not exist] ***********************************
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'RoleBinding', 'namespace': 'istio-system', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['istio-system', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "RoleBinding",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "istio-system",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "istio-system",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'RoleBinding', 'namespace': 'cluster-wide-access-test-1', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-1', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "RoleBinding",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "cluster-wide-access-test-1",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-1",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'RoleBinding', 'namespace': 'cluster-wide-access-test-2', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-2', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "RoleBinding",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "cluster-wide-access-test-2",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-2",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'RoleBinding', 'namespace': 'cluster-wide-access-test-x', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-x', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "RoleBinding",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "cluster-wide-access-test-x",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-x",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [debug] *******************************************************************
[32mok: [localhost] => {[0m
[32m    "msg": "the server should only return the AN namespaces (istio-system, cluster-wide-access-test-1, cluster-wide-access-test-x)"[0m
[32m}[0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/asserts/assert-api-namespaces-result.yml for localhost[0m

TASK [Call /namespaces API] ****************************************************
[32mok: [localhost][0m

TASK [Results of /namespaces API] **********************************************
[32mok: [localhost] => {[0m
[32m    "msg": {[0m
[32m        "changed": false,[0m
[32m        "connection": "close",[0m
[32m        "content": "[{\"name\":\"cluster-wide-access-test-1\",\"cluster\":\"Kubernetes\",\"isAmbient\":false,\"labels\":{\"discoverySelectorLabel1\":\"test\",\"kubernetes.io/metadata.name\":\"cluster-wide-access-test-1\"},\"annotations\":{}},{\"name\":\"cluster-wide-access-test-x\",\"cluster\":\"Kubernetes\",\"isAmbient\":false,\"labels\":{\"kubernetes.io/metadata.name\":\"cluster-wide-access-test-x\"},\"annotations\":{}},{\"name\":\"istio-system\",\"cluster\":\"Kubernetes\",\"isAmbient\":false,\"labels\":{\"kubernetes.io/metadata.name\":\"istio-system\",\"topology.istio.io/network\":\"\"},\"annotations\":{}}]",[0m
[32m        "content_length": "535",[0m
[32m        "content_type": "application/json",[0m
[32m        "cookies": {},[0m
[32m        "cookies_string": "",[0m
[32m        "date": "Thu, 17 Aug 2023 07:18:28 GMT",[0m
[32m        "elapsed": 0,[0m
[32m        "failed": false,[0m
[32m        "json": [[0m
[32m            {[0m
[32m                "annotations": {},[0m
[32m                "cluster": "Kubernetes",[0m
[32m                "isAmbient": false,[0m
[32m                "labels": {[0m
[32m                    "discoverySelectorLabel1": "test",[0m
[32m                    "kubernetes.io/metadata.name": "cluster-wide-access-test-1"[0m
[32m                },[0m
[32m                "name": "cluster-wide-access-test-1"[0m
[32m            },[0m
[32m            {[0m
[32m                "annotations": {},[0m
[32m                "cluster": "Kubernetes",[0m
[32m                "isAmbient": false,[0m
[32m                "labels": {[0m
[32m                    "kubernetes.io/metadata.name": "cluster-wide-access-test-x"[0m
[32m                },[0m
[32m                "name": "cluster-wide-access-test-x"[0m
[32m            },[0m
[32m            {[0m
[32m                "annotations": {},[0m
[32m                "cluster": "Kubernetes",[0m
[32m                "isAmbient": false,[0m
[32m                "labels": {[0m
[32m                    "kubernetes.io/metadata.name": "istio-system",[0m
[32m                    "topology.istio.io/network": ""[0m
[32m                },[0m
[32m                "name": "istio-system"[0m
[32m            }[0m
[32m        ],[0m
[32m        "msg": "OK (535 bytes)",[0m
[32m        "redirected": false,[0m
[32m        "status": 200,[0m
[32m        "url": "http://172.18.255.71:20001/kiali/api/namespaces",[0m
[32m        "vary": "Accept-Encoding"[0m
[32m    }[0m
[32m}[0m

TASK [Assert that we got no less than the minimum number of namespaces expected] ***
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Assert that we got no more than the maximum number of namespaces expected] ***
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Assert that we got the namespaces expected] ******************************
[32mok: [localhost] => (item=istio-system) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": "istio-system",[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item=cluster-wide-access-test-1) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": "cluster-wide-access-test-1",[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item=cluster-wide-access-test-x) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": "cluster-wide-access-test-x",[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Assert that we did not get namespaces that were not expected] ************
[36mskipping: [localhost][0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/cluster-wide-access-test/set-istio-configmap-discovery-selectors.yml for localhost[0m

TASK [fail] ********************************************************************
[36mskipping: [localhost][0m

TASK [Get the Istio ConfigMap data.mesh configuration] *************************
[32mok: [localhost][0m

TASK [fail] ********************************************************************
[36mskipping: [localhost][0m

TASK [Setting discoverySelectors in Istio ConfigMap data.mesh] *****************
[31m--- before[0m
[32m+++ after[0m
[36m@@ -1,6 +1,6 @@[0m
 {
     "data": {
[31m-        "mesh": "accessLogFile: /dev/stdout\ndefaultConfig:\n  discoveryAddress: istiod.istio-system.svc:15012\n  proxyMetadata: {}\n  tracing:\n    zipkin:\n      address: zipkin.istio-system:9411\ndefaultProviders:\n  metrics:\n  - prometheus\nenableAutoMtls: true\nenablePrometheusMerge: true\nextensionProviders:\n- envoyOtelAls:\n    port: 4317\n    service: opentelemetry-collector.istio-system.svc.cluster.local\n  name: otel\n- name: skywalking\n  skywalking:\n    port: 11800\n    service: tracing.istio-system.svc.cluster.local\n- name: otel-tracing\n  opentelemetry:\n    port: 4317\n    service: opentelemetry-collector.otel-collector.svc.cluster.local\nrootNamespace: istio-system\ntrustDomain: cluster.local"[0m
[32m+        "mesh": "accessLogFile: /dev/stdout\ndefaultConfig:\n  discoveryAddress: istiod.istio-system.svc:15012\n  proxyMetadata: {}\n  tracing:\n    zipkin:\n      address: zipkin.istio-system:9411\ndefaultProviders:\n  metrics:\n  - prometheus\ndiscoverySelectors:\n- matchLabels:\n    discoverySelectorLabel1: test\n- matchExpressions:\n  - key: discoverySelectorLabel2\n    operator: In\n    values:\n    - matchme\nenableAutoMtls: true\nenablePrometheusMerge: true\nextensionProviders:\n- envoyOtelAls:\n    port: 4317\n    service: opentelemetry-collector.istio-system.svc.cluster.local\n  name: otel\n- name: skywalking\n  skywalking:\n    port: 11800\n    service: tracing.istio-system.svc.cluster.local\n- name: otel-tracing\n  opentelemetry:\n    port: 4317\n    service: opentelemetry-collector.otel-collector.svc.cluster.local\nrootNamespace: istio-system\ntrustDomain: cluster.local\n"[0m
     },
     "metadata": {
         "managedFields": [
[36m@@ -9,7 +9,6 @@[0m
                 "fieldsType": "FieldsV1",
                 "fieldsV1": {
                     "f:data": {
[31m-                        "f:mesh": {},[0m
                         "f:meshNetworks": {}
                     },
                     "f:metadata": {
[36m@@ -30,8 +29,20 @@[0m
                 "manager": "istio-operator",
                 "operation": "Apply",
                 "time": "2023-08-17T07:01:28Z"
[32m+            },[0m
[32m+            {[0m
[32m+                "apiVersion": "v1",[0m
[32m+                "fieldsType": "FieldsV1",[0m
[32m+                "fieldsV1": {[0m
[32m+                    "f:data": {[0m
[32m+                        "f:mesh": {}[0m
[32m+                    }[0m
[32m+                },[0m
[32m+                "manager": "OpenAPI-Generator",[0m
[32m+                "operation": "Update",[0m
[32m+                "time": "2023-08-17T07:18:29Z"[0m
             }
         ],
[31m-        "resourceVersion": "731"[0m
[32m+        "resourceVersion": "4008"[0m
     }
 }

[33mchanged: [localhost][0m

TASK [debug] *******************************************************************
[32mok: [localhost] => {[0m
[32m    "msg": "SET AN back to ** (but the server will only show us namespaces filtered by discoverySelectors)"[0m
[32m}[0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/common/set_accessible_namespaces_to_all.yml for localhost[0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/cluster-wide-access-test/../common/../common/wait_for_kiali_cr_changes.yml for localhost[0m

TASK [Wait for Kiali CR changes to take effect] ********************************
[32mok: [localhost][0m

TASK [Unset accessible namespace (defaults to ** behavior) in current Kiali CR] ***
[31m--- before[0m
[32m+++ after[0m
[36m@@ -1,6 +1,6 @@[0m
 {
     "metadata": {
[31m-        "generation": 2,[0m
[32m+        "generation": 3,[0m
         "managedFields": [
             {
                 "apiVersion": "kiali.io/v1alpha1",
[36m@@ -29,7 +29,6 @@[0m
                         },
                         "f:deployment": {
                             ".": {},
[31m-                            "f:accessible_namespaces": {},[0m
                             "f:cluster_wide_access": {},
                             "f:image_name": {},
                             "f:image_pull_policy": {},
[36m@@ -98,14 +97,9 @@[0m
                 "time": "2023-08-17T07:17:37Z"
             }
         ],
[31m-        "resourceVersion": "3899"[0m
[32m+        "resourceVersion": "4011"[0m
     },
     "spec": {
[31m-        "deployment": {[0m
[31m-            "accessible_namespaces": [[0m
[31m-                "istio-system",[0m
[31m-                "cluster-wide-access-test-[1x]"[0m
[31m-            ][0m
[31m-        }[0m
[32m+        "deployment": {}[0m
     }
 }

[33mchanged: [localhost][0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/common/wait_for_kiali_cr_changes.yml for localhost[0m

TASK [Wait for Kiali CR changes to take effect] ********************************
[1;30mFAILED - RETRYING: [localhost]: Wait for Kiali CR changes to take effect (120 retries left).[0m
[1;30mFAILED - RETRYING: [localhost]: Wait for Kiali CR changes to take effect (119 retries left).[0m
[1;30mFAILED - RETRYING: [localhost]: Wait for Kiali CR changes to take effect (118 retries left).[0m
[32mok: [localhost][0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/common/wait_for_kiali_running.yml for localhost[0m

TASK [Asserting that Kiali Pod exists and there is only one] *******************
[32mok: [localhost][0m

TASK [Wait for Kiali to be running and accepting requests] *********************
[1;30mFAILED - RETRYING: [localhost]: Wait for Kiali to be running and accepting requests (120 retries left).[0m
[32mok: [localhost][0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/common/tasks.yml for localhost[0m

TASK [Get information about the cluster] ***************************************
[32mok: [localhost][0m

TASK [Determine the cluster type] **********************************************
[32mok: [localhost][0m

TASK [Determine the Istio implementation] **************************************
[32mok: [localhost][0m

TASK [Get SMCP if running in Maistra environment] ******************************
[36mskipping: [localhost][0m

TASK [There must one and only one SMCP already installed in the control plane] ***
[36mskipping: [localhost][0m

TASK [Get Kiali CR if present] *************************************************
[32mok: [localhost][0m

TASK [Get Kiali Operator Pod] **************************************************
[32mok: [localhost][0m

TASK [Get Kiali Pod] ***********************************************************
[32mok: [localhost][0m

TASK [Get Kiali Configmap] *****************************************************
[32mok: [localhost][0m

TASK [Format Configmap] ********************************************************
[32mok: [localhost][0m

TASK [Get Kiali Deployment] ****************************************************
[32mok: [localhost][0m

TASK [Get Kiali Service] *******************************************************
[32mok: [localhost][0m

TASK [Get Kiali Route] *********************************************************
[36mskipping: [localhost][0m

TASK [Determine the Kiali Route URL on OpenShift] ******************************
[36mskipping: [localhost][0m

TASK [Determine the Kiali Ingress URL on minikube] *****************************
[36mskipping: [localhost][0m

TASK [Determine the Kiali Ingress URL on kind] *********************************
[32mok: [localhost][0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/asserts/pod_asserts.yml for localhost[0m

TASK [Assert Kiali Pod is Running and there is only one] ***********************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Assert Kiali Pod is Running on the correct Namespace] ********************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/asserts/accessible_namespaces_contains.yml for localhost[0m

TASK [Assert Accessible Namespaces contains ['**']] ****************************
[32mok: [localhost] => (item=**) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": "**",[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [assert] ******************************************************************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [debug] *******************************************************************
[32mok: [localhost] => {[0m
[32m    "msg": "the server should only return AN namespaces with discoverySelectors also filtering the namespaces"[0m
[32m}[0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/asserts/assert-api-namespaces-result.yml for localhost[0m

TASK [Call /namespaces API] ****************************************************
[32mok: [localhost][0m

TASK [Results of /namespaces API] **********************************************
[32mok: [localhost] => {[0m
[32m    "msg": {[0m
[32m        "changed": false,[0m
[32m        "connection": "close",[0m
[32m        "content": "[{\"name\":\"cluster-wide-access-test-1\",\"cluster\":\"Kubernetes\",\"isAmbient\":false,\"labels\":{\"discoverySelectorLabel1\":\"test\",\"kubernetes.io/metadata.name\":\"cluster-wide-access-test-1\"},\"annotations\":{}},{\"name\":\"cluster-wide-access-test-2\",\"cluster\":\"Kubernetes\",\"isAmbient\":false,\"labels\":{\"discoverySelectorLabel2\":\"matchme\",\"kubernetes.io/metadata.name\":\"cluster-wide-access-test-2\"},\"annotations\":{}},{\"name\":\"istio-system\",\"cluster\":\"Kubernetes\",\"isAmbient\":false,\"labels\":{\"kubernetes.io/metadata.name\":\"istio-system\",\"topology.istio.io/network\":\"\"},\"annotations\":{}}]",[0m
[32m        "content_length": "571",[0m
[32m        "content_type": "application/json",[0m
[32m        "cookies": {},[0m
[32m        "cookies_string": "",[0m
[32m        "date": "Thu, 17 Aug 2023 07:19:20 GMT",[0m
[32m        "elapsed": 0,[0m
[32m        "failed": false,[0m
[32m        "json": [[0m
[32m            {[0m
[32m                "annotations": {},[0m
[32m                "cluster": "Kubernetes",[0m
[32m                "isAmbient": false,[0m
[32m                "labels": {[0m
[32m                    "discoverySelectorLabel1": "test",[0m
[32m                    "kubernetes.io/metadata.name": "cluster-wide-access-test-1"[0m
[32m                },[0m
[32m                "name": "cluster-wide-access-test-1"[0m
[32m            },[0m
[32m            {[0m
[32m                "annotations": {},[0m
[32m                "cluster": "Kubernetes",[0m
[32m                "isAmbient": false,[0m
[32m                "labels": {[0m
[32m                    "discoverySelectorLabel2": "matchme",[0m
[32m                    "kubernetes.io/metadata.name": "cluster-wide-access-test-2"[0m
[32m                },[0m
[32m                "name": "cluster-wide-access-test-2"[0m
[32m            },[0m
[32m            {[0m
[32m                "annotations": {},[0m
[32m                "cluster": "Kubernetes",[0m
[32m                "isAmbient": false,[0m
[32m                "labels": {[0m
[32m                    "kubernetes.io/metadata.name": "istio-system",[0m
[32m                    "topology.istio.io/network": ""[0m
[32m                },[0m
[32m                "name": "istio-system"[0m
[32m            }[0m
[32m        ],[0m
[32m        "msg": "OK (571 bytes)",[0m
[32m        "redirected": false,[0m
[32m        "status": 200,[0m
[32m        "url": "http://172.18.255.71:20001/kiali/api/namespaces",[0m
[32m        "vary": "Accept-Encoding"[0m
[32m    }[0m
[32m}[0m

TASK [Assert that we got no less than the minimum number of namespaces expected] ***
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Assert that we got no more than the maximum number of namespaces expected] ***
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Assert that we got the namespaces expected] ******************************
[32mok: [localhost] => (item=istio-system) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": "istio-system",[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item=cluster-wide-access-test-1) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": "cluster-wide-access-test-1",[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item=cluster-wide-access-test-2) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": "cluster-wide-access-test-2",[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Assert that we did not get namespaces that were not expected] ************
[36mskipping: [localhost][0m

TASK [debug] *******************************************************************
[32mok: [localhost] => {[0m
[32m    "msg": "assert that we have clusterroles since we have been given cluster wide access"[0m
[32m}[0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/asserts/roles-test/rw_clusterrole_asserts.yml for localhost[0m

TASK [Get cluster roles] *******************************************************
[32mok: [localhost][0m

TASK [Assert that cluster roles exist] *****************************************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Get cluster role binding] ************************************************
[32mok: [localhost][0m

TASK [Assert the cluster role binding provides the read-write role] ************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/asserts/roles-test/none_role_asserts.yml for localhost[0m

TASK [Get roles] ***************************************************************
[32mok: [localhost] => (item=['istio-system', 'kiali'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-1', 'kiali'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-2', 'kiali'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-x', 'kiali'])[0m

TASK [Assert that namespaces do not have the roles] ****************************
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'istio-system', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['istio-system', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "istio-system",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "istio-system",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'cluster-wide-access-test-1', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-1', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "cluster-wide-access-test-1",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-1",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'cluster-wide-access-test-2', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-2', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "cluster-wide-access-test-2",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-2",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'cluster-wide-access-test-x', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-x', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "cluster-wide-access-test-x",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-x",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Get viewer roles] ********************************************************
[32mok: [localhost] => (item=['istio-system', 'kiali-viewer'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-1', 'kiali-viewer'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-2', 'kiali-viewer'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-x', 'kiali-viewer'])[0m

TASK [Assert that namespaces do not have the viewer roles] *********************
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'istio-system', 'name': 'kiali-viewer', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['istio-system', 'kiali-viewer'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali-viewer",[0m
[32m                "namespace": "istio-system",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "istio-system",[0m
[32m            "kiali-viewer"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'cluster-wide-access-test-1', 'name': 'kiali-viewer', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-1', 'kiali-viewer'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali-viewer",[0m
[32m                "namespace": "cluster-wide-access-test-1",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-1",[0m
[32m            "kiali-viewer"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'cluster-wide-access-test-2', 'name': 'kiali-viewer', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-2', 'kiali-viewer'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali-viewer",[0m
[32m                "namespace": "cluster-wide-access-test-2",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-2",[0m
[32m            "kiali-viewer"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'cluster-wide-access-test-x', 'name': 'kiali-viewer', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-x', 'kiali-viewer'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali-viewer",[0m
[32m                "namespace": "cluster-wide-access-test-x",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-x",[0m
[32m            "kiali-viewer"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Get role bindings] *******************************************************
[32mok: [localhost] => (item=['istio-system', 'kiali'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-1', 'kiali'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-2', 'kiali'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-x', 'kiali'])[0m

TASK [Assert the role bindings do not exist] ***********************************
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'RoleBinding', 'namespace': 'istio-system', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['istio-system', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "RoleBinding",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "istio-system",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "istio-system",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'RoleBinding', 'namespace': 'cluster-wide-access-test-1', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-1', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "RoleBinding",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "cluster-wide-access-test-1",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-1",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'RoleBinding', 'namespace': 'cluster-wide-access-test-2', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-2', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "RoleBinding",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "cluster-wide-access-test-2",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-2",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'RoleBinding', 'namespace': 'cluster-wide-access-test-x', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-x', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "RoleBinding",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "cluster-wide-access-test-x",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-x",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [debug] *******************************************************************
[32mok: [localhost] => {[0m
[32m    "msg": "Turn off cluster wide access and set AN to [istio-system, cluster-wide-access-test-1, cluster-wide-access-test-2, cluster-wide-access-test-x]"[0m
[32m}[0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/common/set_kiali_cr.yml for localhost[0m

TASK [Change Kiali CR with new Kiali CR] ***************************************
[31m--- before[0m
[32m+++ after[0m
[36m@@ -1,6 +1,6 @@[0m
 {
     "metadata": {
[31m-        "generation": 3,[0m
[32m+        "generation": 4,[0m
         "managedFields": [
             {
                 "apiVersion": "kiali.io/v1alpha1",
[36m@@ -16,41 +16,6 @@[0m
                 "manager": "ansible-operator",
                 "operation": "Update",
                 "time": "2023-08-17T07:16:19Z"
[31m-            },[0m
[31m-            {[0m
[31m-                "apiVersion": "kiali.io/v1alpha1",[0m
[31m-                "fieldsType": "FieldsV1",[0m
[31m-                "fieldsV1": {[0m
[31m-                    "f:spec": {[0m
[31m-                        ".": {},[0m
[31m-                        "f:auth": {[0m
[31m-                            ".": {},[0m
[31m-                            "f:strategy": {}[0m
[31m-                        },[0m
[31m-                        "f:deployment": {[0m
[31m-                            ".": {},[0m
[31m-                            "f:cluster_wide_access": {},[0m
[31m-                            "f:image_name": {},[0m
[31m-                            "f:image_pull_policy": {},[0m
[31m-                            "f:image_version": {},[0m
[31m-                            "f:ingress": {[0m
[31m-                                ".": {},[0m
[31m-                                "f:enabled": {}[0m
[31m-                            },[0m
[31m-                            "f:logger": {[0m
[31m-                                ".": {},[0m
[31m-                                "f:log_level": {}[0m
[31m-                            },[0m
[31m-                            "f:namespace": {},[0m
[31m-                            "f:service_type": {}[0m
[31m-                        },[0m
[31m-                        "f:istio_namespace": {},[0m
[31m-                        "f:version": {}[0m
[31m-                    }[0m
[31m-                },[0m
[31m-                "manager": "OpenAPI-Generator",[0m
[31m-                "operation": "Update",[0m
[31m-                "time": "2023-08-17T07:17:21Z"[0m
             },
             {
                 "apiVersion": "kiali.io/v1alpha1",
[36m@@ -95,13 +60,52 @@[0m
                 "operation": "Update",
                 "subresource": "status",
                 "time": "2023-08-17T07:18:46Z"
[32m+            },[0m
[32m+            {[0m
[32m+                "apiVersion": "kiali.io/v1alpha1",[0m
[32m+                "fieldsType": "FieldsV1",[0m
[32m+                "fieldsV1": {[0m
[32m+                    "f:spec": {[0m
[32m+                        ".": {},[0m
[32m+                        "f:auth": {[0m
[32m+                            ".": {},[0m
[32m+                            "f:strategy": {}[0m
[32m+                        },[0m
[32m+                        "f:deployment": {[0m
[32m+                            ".": {},[0m
[32m+                            "f:accessible_namespaces": {},[0m
[32m+                            "f:cluster_wide_access": {},[0m
[32m+                            "f:image_name": {},[0m
[32m+                            "f:image_pull_policy": {},[0m
[32m+                            "f:image_version": {},[0m
[32m+                            "f:ingress": {[0m
[32m+                                ".": {},[0m
[32m+                                "f:enabled": {}[0m
[32m+                            },[0m
[32m+                            "f:logger": {[0m
[32m+                                ".": {},[0m
[32m+                                "f:log_level": {}[0m
[32m+                            },[0m
[32m+                            "f:namespace": {},[0m
[32m+                            "f:service_type": {}[0m
[32m+                        },[0m
[32m+                        "f:istio_namespace": {},[0m
[32m+                        "f:version": {}[0m
[32m+                    }[0m
[32m+                },[0m
[32m+                "manager": "OpenAPI-Generator",[0m
[32m+                "operation": "Update",[0m
[32m+                "time": "2023-08-17T07:19:29Z"[0m
             }
         ],
[31m-        "resourceVersion": "4083"[0m
[32m+        "resourceVersion": "4175"[0m
     },
     "spec": {
         "deployment": {
[31m-            "cluster_wide_access": true[0m
[32m+            "accessible_namespaces": [[0m
[32m+                "cluster-wide-access-test-[12x]"[0m
[32m+            ],[0m
[32m+            "cluster_wide_access": false[0m
         }
     }
 }

[33mchanged: [localhost][0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/common/wait_for_kiali_cr_changes.yml for localhost[0m

TASK [Wait for Kiali CR changes to take effect] ********************************
[1;30mFAILED - RETRYING: [localhost]: Wait for Kiali CR changes to take effect (120 retries left).[0m
[1;30mFAILED - RETRYING: [localhost]: Wait for Kiali CR changes to take effect (119 retries left).[0m
[1;30mFAILED - RETRYING: [localhost]: Wait for Kiali CR changes to take effect (118 retries left).[0m
[32mok: [localhost][0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/common/wait_for_kiali_running.yml for localhost[0m

TASK [Asserting that Kiali Pod exists and there is only one] *******************
[32mok: [localhost][0m

TASK [Wait for Kiali to be running and accepting requests] *********************
[1;30mFAILED - RETRYING: [localhost]: Wait for Kiali to be running and accepting requests (120 retries left).[0m
[1;30mFAILED - RETRYING: [localhost]: Wait for Kiali to be running and accepting requests (119 retries left).[0m
[32mok: [localhost][0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/common/tasks.yml for localhost[0m

TASK [Get information about the cluster] ***************************************
[32mok: [localhost][0m

TASK [Determine the cluster type] **********************************************
[32mok: [localhost][0m

TASK [Determine the Istio implementation] **************************************
[32mok: [localhost][0m

TASK [Get SMCP if running in Maistra environment] ******************************
[36mskipping: [localhost][0m

TASK [There must one and only one SMCP already installed in the control plane] ***
[36mskipping: [localhost][0m

TASK [Get Kiali CR if present] *************************************************
[32mok: [localhost][0m

TASK [Get Kiali Operator Pod] **************************************************
[32mok: [localhost][0m

TASK [Get Kiali Pod] ***********************************************************
[32mok: [localhost][0m

TASK [Get Kiali Configmap] *****************************************************
[32mok: [localhost][0m

TASK [Format Configmap] ********************************************************
[32mok: [localhost][0m

TASK [Get Kiali Deployment] ****************************************************
[32mok: [localhost][0m

TASK [Get Kiali Service] *******************************************************
[32mok: [localhost][0m

TASK [Get Kiali Route] *********************************************************
[36mskipping: [localhost][0m

TASK [Determine the Kiali Route URL on OpenShift] ******************************
[36mskipping: [localhost][0m

TASK [Determine the Kiali Ingress URL on minikube] *****************************
[36mskipping: [localhost][0m

TASK [Determine the Kiali Ingress URL on kind] *********************************
[32mok: [localhost][0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/asserts/pod_asserts.yml for localhost[0m

TASK [Assert Kiali Pod is Running and there is only one] ***********************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Assert Kiali Pod is Running on the correct Namespace] ********************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/asserts/accessible_namespaces_equals.yml for localhost[0m

TASK [Assert Accessible Namespaces is ['istio-system', 'cluster-wide-access-test-1', 'cluster-wide-access-test-2', 'cluster-wide-access-test-x']] ***
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [assert] ******************************************************************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [debug] *******************************************************************
[32mok: [localhost] => {[0m
[32m    "msg": "assert that we have roles since we have NOT been given cluster wide access"[0m
[32m}[0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/asserts/roles-test/rw_role_asserts.yml for localhost[0m

TASK [Get roles] ***************************************************************
[32mok: [localhost] => (item=['istio-system', 'kiali'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-1', 'kiali'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-2', 'kiali'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-x', 'kiali'])[0m

TASK [Assert that namespaces have the correct roles] ***************************
[32mok: [localhost] => (item={'changed': False, 'resources': [{'kind': 'Role', 'apiVersion': 'rbac.authorization.k8s.io/v1', 'metadata': {'name': 'kiali', 'namespace': 'istio-system', 'uid': '994510a4-207e-44f6-ade8-545f8db92e60', 'resourceVersion': '4216', 'creationTimestamp': '2023-08-17T07:19:43Z', 'labels': {'app': 'kiali', 'app.kubernetes.io/instance': 'kiali', 'app.kubernetes.io/name': 'kiali', 'app.kubernetes.io/part-of': 'kiali', 'app.kubernetes.io/version': 'master', 'version': 'master'}, 'annotations': {'operator-sdk/primary-resource': 'kiali-operator/kiali', 'operator-sdk/primary-resource-type': 'Kiali.kiali.io'}, 'managedFields': [{'manager': 'OpenAPI-Generator', 'operation': 'Update', 'apiVersion': 'rbac.authorization.k8s.io/v1', 'time': '2023-08-17T07:19:43Z', 'fieldsType': 'FieldsV1', 'fieldsV1': {'f:metadata': {'f:annotations': {'.': {}, 'f:operator-sdk/primary-resource': {}, 'f:operator-sdk/primary-resource-type': {}}, 'f:labels': {'.': {}, 'f:app': {}, 'f:app.kubernetes.io/instance': {}, 'f:app.kubernetes.io/name': {}, 'f:app.kubernetes.io/part-of': {}, 'f:app.kubernetes.io/version': {}, 'f:version': {}}}, 'f:rules': {}}}]}, 'rules': [{'verbs': ['get', 'list', 'watch'], 'apiGroups': [''], 'resources': ['configmaps', 'endpoints', 'pods/log']}, {'verbs': ['get', 'list', 'watch', 'patch'], 'apiGroups': [''], 'resources': ['namespaces', 'pods', 'replicationcontrollers', 'services']}, {'verbs': ['create', 'post'], 'apiGroups': [''], 'resources': ['pods/portforward']}, {'verbs': ['get', 'list', 'watch', 'patch'], 'apiGroups': ['extensions', 'apps'], 'resources': ['daemonsets', 'deployments', 'replicasets', 'statefulsets']}, {'verbs': ['get', 'list', 'watch', 'patch'], 'apiGroups': ['batch'], 'resources': ['cronjobs', 'jobs']}, {'verbs': ['get', 'list', 'watch', 'create', 'delete', 'patch'], 'apiGroups': ['networking.istio.io', 'security.istio.io', 'extensions.istio.io', 'telemetry.istio.io', 'gateway.networking.k8s.io'], 'resources': ['*']}, {'verbs': ['create'], 'apiGroups': ['authentication.k8s.io'], 'resources': ['tokenreviews']}]}], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'istio-system', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['istio-system', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "istio-system",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "istio-system",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [[0m
[32m            {[0m
[32m                "apiVersion": "rbac.authorization.k8s.io/v1",[0m
[32m                "kind": "Role",[0m
[32m                "metadata": {[0m
[32m                    "annotations": {[0m
[32m                        "operator-sdk/primary-resource": "kiali-operator/kiali",[0m
[32m                        "operator-sdk/primary-resource-type": "Kiali.kiali.io"[0m
[32m                    },[0m
[32m                    "creationTimestamp": "2023-08-17T07:19:43Z",[0m
[32m                    "labels": {[0m
[32m                        "app": "kiali",[0m
[32m                        "app.kubernetes.io/instance": "kiali",[0m
[32m                        "app.kubernetes.io/name": "kiali",[0m
[32m                        "app.kubernetes.io/part-of": "kiali",[0m
[32m                        "app.kubernetes.io/version": "master",[0m
[32m                        "version": "master"[0m
[32m                    },[0m
[32m                    "managedFields": [[0m
[32m                        {[0m
[32m                            "apiVersion": "rbac.authorization.k8s.io/v1",[0m
[32m                            "fieldsType": "FieldsV1",[0m
[32m                            "fieldsV1": {[0m
[32m                                "f:metadata": {[0m
[32m                                    "f:annotations": {[0m
[32m                                        ".": {},[0m
[32m                                        "f:operator-sdk/primary-resource": {},[0m
[32m                                        "f:operator-sdk/primary-resource-type": {}[0m
[32m                                    },[0m
[32m                                    "f:labels": {[0m
[32m                                        ".": {},[0m
[32m                                        "f:app": {},[0m
[32m                                        "f:app.kubernetes.io/instance": {},[0m
[32m                                        "f:app.kubernetes.io/name": {},[0m
[32m                                        "f:app.kubernetes.io/part-of": {},[0m
[32m                                        "f:app.kubernetes.io/version": {},[0m
[32m                                        "f:version": {}[0m
[32m                                    }[0m
[32m                                },[0m
[32m                                "f:rules": {}[0m
[32m                            },[0m
[32m                            "manager": "OpenAPI-Generator",[0m
[32m                            "operation": "Update",[0m
[32m                            "time": "2023-08-17T07:19:43Z"[0m
[32m                        }[0m
[32m                    ],[0m
[32m                    "name": "kiali",[0m
[32m                    "namespace": "istio-system",[0m
[32m                    "resourceVersion": "4216",[0m
[32m                    "uid": "994510a4-207e-44f6-ade8-545f8db92e60"[0m
[32m                },[0m
[32m                "rules": [[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            ""[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "configmaps",[0m
[32m                            "endpoints",[0m
[32m                            "pods/log"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "get",[0m
[32m                            "list",[0m
[32m                            "watch"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            ""[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "namespaces",[0m
[32m                            "pods",[0m
[32m                            "replicationcontrollers",[0m
[32m                            "services"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "get",[0m
[32m                            "list",[0m
[32m                            "watch",[0m
[32m                            "patch"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            ""[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "pods/portforward"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "create",[0m
[32m                            "post"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            "extensions",[0m
[32m                            "apps"[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "daemonsets",[0m
[32m                            "deployments",[0m
[32m                            "replicasets",[0m
[32m                            "statefulsets"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "get",[0m
[32m                            "list",[0m
[32m                            "watch",[0m
[32m                            "patch"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            "batch"[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "cronjobs",[0m
[32m                            "jobs"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "get",[0m
[32m                            "list",[0m
[32m                            "watch",[0m
[32m                            "patch"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            "networking.istio.io",[0m
[32m                            "security.istio.io",[0m
[32m                            "extensions.istio.io",[0m
[32m                            "telemetry.istio.io",[0m
[32m                            "gateway.networking.k8s.io"[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "*"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "get",[0m
[32m                            "list",[0m
[32m                            "watch",[0m
[32m                            "create",[0m
[32m                            "delete",[0m
[32m                            "patch"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            "authentication.k8s.io"[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "tokenreviews"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "create"[0m
[32m                        ][0m
[32m                    }[0m
[32m                ][0m
[32m            }[0m
[32m        ][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [{'kind': 'Role', 'apiVersion': 'rbac.authorization.k8s.io/v1', 'metadata': {'name': 'kiali', 'namespace': 'cluster-wide-access-test-1', 'uid': '0f87fae2-34ea-4ac5-aa1f-aa5fffab3c6e', 'resourceVersion': '4222', 'creationTimestamp': '2023-08-17T07:19:44Z', 'labels': {'app': 'kiali', 'app.kubernetes.io/instance': 'kiali', 'app.kubernetes.io/name': 'kiali', 'app.kubernetes.io/part-of': 'kiali', 'app.kubernetes.io/version': 'master', 'version': 'master'}, 'annotations': {'operator-sdk/primary-resource': 'kiali-operator/kiali', 'operator-sdk/primary-resource-type': 'Kiali.kiali.io'}, 'managedFields': [{'manager': 'OpenAPI-Generator', 'operation': 'Update', 'apiVersion': 'rbac.authorization.k8s.io/v1', 'time': '2023-08-17T07:19:44Z', 'fieldsType': 'FieldsV1', 'fieldsV1': {'f:metadata': {'f:annotations': {'.': {}, 'f:operator-sdk/primary-resource': {}, 'f:operator-sdk/primary-resource-type': {}}, 'f:labels': {'.': {}, 'f:app': {}, 'f:app.kubernetes.io/instance': {}, 'f:app.kubernetes.io/name': {}, 'f:app.kubernetes.io/part-of': {}, 'f:app.kubernetes.io/version': {}, 'f:version': {}}}, 'f:rules': {}}}]}, 'rules': [{'verbs': ['get', 'list', 'watch'], 'apiGroups': [''], 'resources': ['configmaps', 'endpoints', 'pods/log']}, {'verbs': ['get', 'list', 'watch', 'patch'], 'apiGroups': [''], 'resources': ['namespaces', 'pods', 'replicationcontrollers', 'services']}, {'verbs': ['create', 'post'], 'apiGroups': [''], 'resources': ['pods/portforward']}, {'verbs': ['get', 'list', 'watch', 'patch'], 'apiGroups': ['extensions', 'apps'], 'resources': ['daemonsets', 'deployments', 'replicasets', 'statefulsets']}, {'verbs': ['get', 'list', 'watch', 'patch'], 'apiGroups': ['batch'], 'resources': ['cronjobs', 'jobs']}, {'verbs': ['get', 'list', 'watch', 'create', 'delete', 'patch'], 'apiGroups': ['networking.istio.io', 'security.istio.io', 'extensions.istio.io', 'telemetry.istio.io', 'gateway.networking.k8s.io'], 'resources': ['*']}, {'verbs': ['create'], 'apiGroups': ['authentication.k8s.io'], 'resources': ['tokenreviews']}]}], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'cluster-wide-access-test-1', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-1', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "cluster-wide-access-test-1",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-1",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [[0m
[32m            {[0m
[32m                "apiVersion": "rbac.authorization.k8s.io/v1",[0m
[32m                "kind": "Role",[0m
[32m                "metadata": {[0m
[32m                    "annotations": {[0m
[32m                        "operator-sdk/primary-resource": "kiali-operator/kiali",[0m
[32m                        "operator-sdk/primary-resource-type": "Kiali.kiali.io"[0m
[32m                    },[0m
[32m                    "creationTimestamp": "2023-08-17T07:19:44Z",[0m
[32m                    "labels": {[0m
[32m                        "app": "kiali",[0m
[32m                        "app.kubernetes.io/instance": "kiali",[0m
[32m                        "app.kubernetes.io/name": "kiali",[0m
[32m                        "app.kubernetes.io/part-of": "kiali",[0m
[32m                        "app.kubernetes.io/version": "master",[0m
[32m                        "version": "master"[0m
[32m                    },[0m
[32m                    "managedFields": [[0m
[32m                        {[0m
[32m                            "apiVersion": "rbac.authorization.k8s.io/v1",[0m
[32m                            "fieldsType": "FieldsV1",[0m
[32m                            "fieldsV1": {[0m
[32m                                "f:metadata": {[0m
[32m                                    "f:annotations": {[0m
[32m                                        ".": {},[0m
[32m                                        "f:operator-sdk/primary-resource": {},[0m
[32m                                        "f:operator-sdk/primary-resource-type": {}[0m
[32m                                    },[0m
[32m                                    "f:labels": {[0m
[32m                                        ".": {},[0m
[32m                                        "f:app": {},[0m
[32m                                        "f:app.kubernetes.io/instance": {},[0m
[32m                                        "f:app.kubernetes.io/name": {},[0m
[32m                                        "f:app.kubernetes.io/part-of": {},[0m
[32m                                        "f:app.kubernetes.io/version": {},[0m
[32m                                        "f:version": {}[0m
[32m                                    }[0m
[32m                                },[0m
[32m                                "f:rules": {}[0m
[32m                            },[0m
[32m                            "manager": "OpenAPI-Generator",[0m
[32m                            "operation": "Update",[0m
[32m                            "time": "2023-08-17T07:19:44Z"[0m
[32m                        }[0m
[32m                    ],[0m
[32m                    "name": "kiali",[0m
[32m                    "namespace": "cluster-wide-access-test-1",[0m
[32m                    "resourceVersion": "4222",[0m
[32m                    "uid": "0f87fae2-34ea-4ac5-aa1f-aa5fffab3c6e"[0m
[32m                },[0m
[32m                "rules": [[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            ""[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "configmaps",[0m
[32m                            "endpoints",[0m
[32m                            "pods/log"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "get",[0m
[32m                            "list",[0m
[32m                            "watch"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            ""[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "namespaces",[0m
[32m                            "pods",[0m
[32m                            "replicationcontrollers",[0m
[32m                            "services"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "get",[0m
[32m                            "list",[0m
[32m                            "watch",[0m
[32m                            "patch"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            ""[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "pods/portforward"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "create",[0m
[32m                            "post"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            "extensions",[0m
[32m                            "apps"[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "daemonsets",[0m
[32m                            "deployments",[0m
[32m                            "replicasets",[0m
[32m                            "statefulsets"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "get",[0m
[32m                            "list",[0m
[32m                            "watch",[0m
[32m                            "patch"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            "batch"[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "cronjobs",[0m
[32m                            "jobs"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "get",[0m
[32m                            "list",[0m
[32m                            "watch",[0m
[32m                            "patch"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            "networking.istio.io",[0m
[32m                            "security.istio.io",[0m
[32m                            "extensions.istio.io",[0m
[32m                            "telemetry.istio.io",[0m
[32m                            "gateway.networking.k8s.io"[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "*"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "get",[0m
[32m                            "list",[0m
[32m                            "watch",[0m
[32m                            "create",[0m
[32m                            "delete",[0m
[32m                            "patch"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            "authentication.k8s.io"[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "tokenreviews"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "create"[0m
[32m                        ][0m
[32m                    }[0m
[32m                ][0m
[32m            }[0m
[32m        ][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [{'kind': 'Role', 'apiVersion': 'rbac.authorization.k8s.io/v1', 'metadata': {'name': 'kiali', 'namespace': 'cluster-wide-access-test-2', 'uid': 'fad81121-1df8-4c50-807d-5951ed3c4018', 'resourceVersion': '4223', 'creationTimestamp': '2023-08-17T07:19:44Z', 'labels': {'app': 'kiali', 'app.kubernetes.io/instance': 'kiali', 'app.kubernetes.io/name': 'kiali', 'app.kubernetes.io/part-of': 'kiali', 'app.kubernetes.io/version': 'master', 'version': 'master'}, 'annotations': {'operator-sdk/primary-resource': 'kiali-operator/kiali', 'operator-sdk/primary-resource-type': 'Kiali.kiali.io'}, 'managedFields': [{'manager': 'OpenAPI-Generator', 'operation': 'Update', 'apiVersion': 'rbac.authorization.k8s.io/v1', 'time': '2023-08-17T07:19:44Z', 'fieldsType': 'FieldsV1', 'fieldsV1': {'f:metadata': {'f:annotations': {'.': {}, 'f:operator-sdk/primary-resource': {}, 'f:operator-sdk/primary-resource-type': {}}, 'f:labels': {'.': {}, 'f:app': {}, 'f:app.kubernetes.io/instance': {}, 'f:app.kubernetes.io/name': {}, 'f:app.kubernetes.io/part-of': {}, 'f:app.kubernetes.io/version': {}, 'f:version': {}}}, 'f:rules': {}}}]}, 'rules': [{'verbs': ['get', 'list', 'watch'], 'apiGroups': [''], 'resources': ['configmaps', 'endpoints', 'pods/log']}, {'verbs': ['get', 'list', 'watch', 'patch'], 'apiGroups': [''], 'resources': ['namespaces', 'pods', 'replicationcontrollers', 'services']}, {'verbs': ['create', 'post'], 'apiGroups': [''], 'resources': ['pods/portforward']}, {'verbs': ['get', 'list', 'watch', 'patch'], 'apiGroups': ['extensions', 'apps'], 'resources': ['daemonsets', 'deployments', 'replicasets', 'statefulsets']}, {'verbs': ['get', 'list', 'watch', 'patch'], 'apiGroups': ['batch'], 'resources': ['cronjobs', 'jobs']}, {'verbs': ['get', 'list', 'watch', 'create', 'delete', 'patch'], 'apiGroups': ['networking.istio.io', 'security.istio.io', 'extensions.istio.io', 'telemetry.istio.io', 'gateway.networking.k8s.io'], 'resources': ['*']}, {'verbs': ['create'], 'apiGroups': ['authentication.k8s.io'], 'resources': ['tokenreviews']}]}], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'cluster-wide-access-test-2', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-2', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "cluster-wide-access-test-2",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-2",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [[0m
[32m            {[0m
[32m                "apiVersion": "rbac.authorization.k8s.io/v1",[0m
[32m                "kind": "Role",[0m
[32m                "metadata": {[0m
[32m                    "annotations": {[0m
[32m                        "operator-sdk/primary-resource": "kiali-operator/kiali",[0m
[32m                        "operator-sdk/primary-resource-type": "Kiali.kiali.io"[0m
[32m                    },[0m
[32m                    "creationTimestamp": "2023-08-17T07:19:44Z",[0m
[32m                    "labels": {[0m
[32m                        "app": "kiali",[0m
[32m                        "app.kubernetes.io/instance": "kiali",[0m
[32m                        "app.kubernetes.io/name": "kiali",[0m
[32m                        "app.kubernetes.io/part-of": "kiali",[0m
[32m                        "app.kubernetes.io/version": "master",[0m
[32m                        "version": "master"[0m
[32m                    },[0m
[32m                    "managedFields": [[0m
[32m                        {[0m
[32m                            "apiVersion": "rbac.authorization.k8s.io/v1",[0m
[32m                            "fieldsType": "FieldsV1",[0m
[32m                            "fieldsV1": {[0m
[32m                                "f:metadata": {[0m
[32m                                    "f:annotations": {[0m
[32m                                        ".": {},[0m
[32m                                        "f:operator-sdk/primary-resource": {},[0m
[32m                                        "f:operator-sdk/primary-resource-type": {}[0m
[32m                                    },[0m
[32m                                    "f:labels": {[0m
[32m                                        ".": {},[0m
[32m                                        "f:app": {},[0m
[32m                                        "f:app.kubernetes.io/instance": {},[0m
[32m                                        "f:app.kubernetes.io/name": {},[0m
[32m                                        "f:app.kubernetes.io/part-of": {},[0m
[32m                                        "f:app.kubernetes.io/version": {},[0m
[32m                                        "f:version": {}[0m
[32m                                    }[0m
[32m                                },[0m
[32m                                "f:rules": {}[0m
[32m                            },[0m
[32m                            "manager": "OpenAPI-Generator",[0m
[32m                            "operation": "Update",[0m
[32m                            "time": "2023-08-17T07:19:44Z"[0m
[32m                        }[0m
[32m                    ],[0m
[32m                    "name": "kiali",[0m
[32m                    "namespace": "cluster-wide-access-test-2",[0m
[32m                    "resourceVersion": "4223",[0m
[32m                    "uid": "fad81121-1df8-4c50-807d-5951ed3c4018"[0m
[32m                },[0m
[32m                "rules": [[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            ""[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "configmaps",[0m
[32m                            "endpoints",[0m
[32m                            "pods/log"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "get",[0m
[32m                            "list",[0m
[32m                            "watch"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            ""[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "namespaces",[0m
[32m                            "pods",[0m
[32m                            "replicationcontrollers",[0m
[32m                            "services"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "get",[0m
[32m                            "list",[0m
[32m                            "watch",[0m
[32m                            "patch"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            ""[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "pods/portforward"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "create",[0m
[32m                            "post"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            "extensions",[0m
[32m                            "apps"[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "daemonsets",[0m
[32m                            "deployments",[0m
[32m                            "replicasets",[0m
[32m                            "statefulsets"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "get",[0m
[32m                            "list",[0m
[32m                            "watch",[0m
[32m                            "patch"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            "batch"[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "cronjobs",[0m
[32m                            "jobs"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "get",[0m
[32m                            "list",[0m
[32m                            "watch",[0m
[32m                            "patch"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            "networking.istio.io",[0m
[32m                            "security.istio.io",[0m
[32m                            "extensions.istio.io",[0m
[32m                            "telemetry.istio.io",[0m
[32m                            "gateway.networking.k8s.io"[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "*"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "get",[0m
[32m                            "list",[0m
[32m                            "watch",[0m
[32m                            "create",[0m
[32m                            "delete",[0m
[32m                            "patch"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            "authentication.k8s.io"[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "tokenreviews"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "create"[0m
[32m                        ][0m
[32m                    }[0m
[32m                ][0m
[32m            }[0m
[32m        ][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [{'kind': 'Role', 'apiVersion': 'rbac.authorization.k8s.io/v1', 'metadata': {'name': 'kiali', 'namespace': 'cluster-wide-access-test-x', 'uid': '3b556164-59c5-44c7-b17f-c60ad730a0ed', 'resourceVersion': '4224', 'creationTimestamp': '2023-08-17T07:19:44Z', 'labels': {'app': 'kiali', 'app.kubernetes.io/instance': 'kiali', 'app.kubernetes.io/name': 'kiali', 'app.kubernetes.io/part-of': 'kiali', 'app.kubernetes.io/version': 'master', 'version': 'master'}, 'annotations': {'operator-sdk/primary-resource': 'kiali-operator/kiali', 'operator-sdk/primary-resource-type': 'Kiali.kiali.io'}, 'managedFields': [{'manager': 'OpenAPI-Generator', 'operation': 'Update', 'apiVersion': 'rbac.authorization.k8s.io/v1', 'time': '2023-08-17T07:19:44Z', 'fieldsType': 'FieldsV1', 'fieldsV1': {'f:metadata': {'f:annotations': {'.': {}, 'f:operator-sdk/primary-resource': {}, 'f:operator-sdk/primary-resource-type': {}}, 'f:labels': {'.': {}, 'f:app': {}, 'f:app.kubernetes.io/instance': {}, 'f:app.kubernetes.io/name': {}, 'f:app.kubernetes.io/part-of': {}, 'f:app.kubernetes.io/version': {}, 'f:version': {}}}, 'f:rules': {}}}]}, 'rules': [{'verbs': ['get', 'list', 'watch'], 'apiGroups': [''], 'resources': ['configmaps', 'endpoints', 'pods/log']}, {'verbs': ['get', 'list', 'watch', 'patch'], 'apiGroups': [''], 'resources': ['namespaces', 'pods', 'replicationcontrollers', 'services']}, {'verbs': ['create', 'post'], 'apiGroups': [''], 'resources': ['pods/portforward']}, {'verbs': ['get', 'list', 'watch', 'patch'], 'apiGroups': ['extensions', 'apps'], 'resources': ['daemonsets', 'deployments', 'replicasets', 'statefulsets']}, {'verbs': ['get', 'list', 'watch', 'patch'], 'apiGroups': ['batch'], 'resources': ['cronjobs', 'jobs']}, {'verbs': ['get', 'list', 'watch', 'create', 'delete', 'patch'], 'apiGroups': ['networking.istio.io', 'security.istio.io', 'extensions.istio.io', 'telemetry.istio.io', 'gateway.networking.k8s.io'], 'resources': ['*']}, {'verbs': ['create'], 'apiGroups': ['authentication.k8s.io'], 'resources': ['tokenreviews']}]}], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'cluster-wide-access-test-x', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-x', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "cluster-wide-access-test-x",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-x",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [[0m
[32m            {[0m
[32m                "apiVersion": "rbac.authorization.k8s.io/v1",[0m
[32m                "kind": "Role",[0m
[32m                "metadata": {[0m
[32m                    "annotations": {[0m
[32m                        "operator-sdk/primary-resource": "kiali-operator/kiali",[0m
[32m                        "operator-sdk/primary-resource-type": "Kiali.kiali.io"[0m
[32m                    },[0m
[32m                    "creationTimestamp": "2023-08-17T07:19:44Z",[0m
[32m                    "labels": {[0m
[32m                        "app": "kiali",[0m
[32m                        "app.kubernetes.io/instance": "kiali",[0m
[32m                        "app.kubernetes.io/name": "kiali",[0m
[32m                        "app.kubernetes.io/part-of": "kiali",[0m
[32m                        "app.kubernetes.io/version": "master",[0m
[32m                        "version": "master"[0m
[32m                    },[0m
[32m                    "managedFields": [[0m
[32m                        {[0m
[32m                            "apiVersion": "rbac.authorization.k8s.io/v1",[0m
[32m                            "fieldsType": "FieldsV1",[0m
[32m                            "fieldsV1": {[0m
[32m                                "f:metadata": {[0m
[32m                                    "f:annotations": {[0m
[32m                                        ".": {},[0m
[32m                                        "f:operator-sdk/primary-resource": {},[0m
[32m                                        "f:operator-sdk/primary-resource-type": {}[0m
[32m                                    },[0m
[32m                                    "f:labels": {[0m
[32m                                        ".": {},[0m
[32m                                        "f:app": {},[0m
[32m                                        "f:app.kubernetes.io/instance": {},[0m
[32m                                        "f:app.kubernetes.io/name": {},[0m
[32m                                        "f:app.kubernetes.io/part-of": {},[0m
[32m                                        "f:app.kubernetes.io/version": {},[0m
[32m                                        "f:version": {}[0m
[32m                                    }[0m
[32m                                },[0m
[32m                                "f:rules": {}[0m
[32m                            },[0m
[32m                            "manager": "OpenAPI-Generator",[0m
[32m                            "operation": "Update",[0m
[32m                            "time": "2023-08-17T07:19:44Z"[0m
[32m                        }[0m
[32m                    ],[0m
[32m                    "name": "kiali",[0m
[32m                    "namespace": "cluster-wide-access-test-x",[0m
[32m                    "resourceVersion": "4224",[0m
[32m                    "uid": "3b556164-59c5-44c7-b17f-c60ad730a0ed"[0m
[32m                },[0m
[32m                "rules": [[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            ""[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "configmaps",[0m
[32m                            "endpoints",[0m
[32m                            "pods/log"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "get",[0m
[32m                            "list",[0m
[32m                            "watch"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            ""[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "namespaces",[0m
[32m                            "pods",[0m
[32m                            "replicationcontrollers",[0m
[32m                            "services"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "get",[0m
[32m                            "list",[0m
[32m                            "watch",[0m
[32m                            "patch"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            ""[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "pods/portforward"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "create",[0m
[32m                            "post"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            "extensions",[0m
[32m                            "apps"[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "daemonsets",[0m
[32m                            "deployments",[0m
[32m                            "replicasets",[0m
[32m                            "statefulsets"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "get",[0m
[32m                            "list",[0m
[32m                            "watch",[0m
[32m                            "patch"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            "batch"[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "cronjobs",[0m
[32m                            "jobs"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "get",[0m
[32m                            "list",[0m
[32m                            "watch",[0m
[32m                            "patch"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            "networking.istio.io",[0m
[32m                            "security.istio.io",[0m
[32m                            "extensions.istio.io",[0m
[32m                            "telemetry.istio.io",[0m
[32m                            "gateway.networking.k8s.io"[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "*"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "get",[0m
[32m                            "list",[0m
[32m                            "watch",[0m
[32m                            "create",[0m
[32m                            "delete",[0m
[32m                            "patch"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            "authentication.k8s.io"[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "tokenreviews"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "create"[0m
[32m                        ][0m
[32m                    }[0m
[32m                ][0m
[32m            }[0m
[32m        ][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Get role binding] ********************************************************
[32mok: [localhost] => (item=['istio-system', 'kiali'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-1', 'kiali'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-2', 'kiali'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-x', 'kiali'])[0m

TASK [Assert the role binding provides the read-write role] ********************
[32mok: [localhost] => (item={'changed': False, 'resources': [{'kind': 'RoleBinding', 'apiVersion': 'rbac.authorization.k8s.io/v1', 'metadata': {'name': 'kiali', 'namespace': 'istio-system', 'uid': 'ef823a02-fc45-41ea-b648-9c2dd7e1d31f', 'resourceVersion': '4217', 'creationTimestamp': '2023-08-17T07:19:43Z', 'labels': {'app': 'kiali', 'app.kubernetes.io/instance': 'kiali', 'app.kubernetes.io/name': 'kiali', 'app.kubernetes.io/part-of': 'kiali', 'app.kubernetes.io/version': 'master', 'version': 'master'}, 'annotations': {'operator-sdk/primary-resource': 'kiali-operator/kiali', 'operator-sdk/primary-resource-type': 'Kiali.kiali.io'}, 'managedFields': [{'manager': 'OpenAPI-Generator', 'operation': 'Update', 'apiVersion': 'rbac.authorization.k8s.io/v1', 'time': '2023-08-17T07:19:43Z', 'fieldsType': 'FieldsV1', 'fieldsV1': {'f:metadata': {'f:annotations': {'.': {}, 'f:operator-sdk/primary-resource': {}, 'f:operator-sdk/primary-resource-type': {}}, 'f:labels': {'.': {}, 'f:app': {}, 'f:app.kubernetes.io/instance': {}, 'f:app.kubernetes.io/name': {}, 'f:app.kubernetes.io/part-of': {}, 'f:app.kubernetes.io/version': {}, 'f:version': {}}}, 'f:roleRef': {}, 'f:subjects': {}}}]}, 'subjects': [{'kind': 'ServiceAccount', 'name': 'kiali-service-account', 'namespace': 'istio-system'}], 'roleRef': {'apiGroup': 'rbac.authorization.k8s.io', 'kind': 'Role', 'name': 'kiali'}}], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'RoleBinding', 'namespace': 'istio-system', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['istio-system', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "RoleBinding",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "istio-system",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "istio-system",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [[0m
[32m            {[0m
[32m                "apiVersion": "rbac.authorization.k8s.io/v1",[0m
[32m                "kind": "RoleBinding",[0m
[32m                "metadata": {[0m
[32m                    "annotations": {[0m
[32m                        "operator-sdk/primary-resource": "kiali-operator/kiali",[0m
[32m                        "operator-sdk/primary-resource-type": "Kiali.kiali.io"[0m
[32m                    },[0m
[32m                    "creationTimestamp": "2023-08-17T07:19:43Z",[0m
[32m                    "labels": {[0m
[32m                        "app": "kiali",[0m
[32m                        "app.kubernetes.io/instance": "kiali",[0m
[32m                        "app.kubernetes.io/name": "kiali",[0m
[32m                        "app.kubernetes.io/part-of": "kiali",[0m
[32m                        "app.kubernetes.io/version": "master",[0m
[32m                        "version": "master"[0m
[32m                    },[0m
[32m                    "managedFields": [[0m
[32m                        {[0m
[32m                            "apiVersion": "rbac.authorization.k8s.io/v1",[0m
[32m                            "fieldsType": "FieldsV1",[0m
[32m                            "fieldsV1": {[0m
[32m                                "f:metadata": {[0m
[32m                                    "f:annotations": {[0m
[32m                                        ".": {},[0m
[32m                                        "f:operator-sdk/primary-resource": {},[0m
[32m                                        "f:operator-sdk/primary-resource-type": {}[0m
[32m                                    },[0m
[32m                                    "f:labels": {[0m
[32m                                        ".": {},[0m
[32m                                        "f:app": {},[0m
[32m                                        "f:app.kubernetes.io/instance": {},[0m
[32m                                        "f:app.kubernetes.io/name": {},[0m
[32m                                        "f:app.kubernetes.io/part-of": {},[0m
[32m                                        "f:app.kubernetes.io/version": {},[0m
[32m                                        "f:version": {}[0m
[32m                                    }[0m
[32m                                },[0m
[32m                                "f:roleRef": {},[0m
[32m                                "f:subjects": {}[0m
[32m                            },[0m
[32m                            "manager": "OpenAPI-Generator",[0m
[32m                            "operation": "Update",[0m
[32m                            "time": "2023-08-17T07:19:43Z"[0m
[32m                        }[0m
[32m                    ],[0m
[32m                    "name": "kiali",[0m
[32m                    "namespace": "istio-system",[0m
[32m                    "resourceVersion": "4217",[0m
[32m                    "uid": "ef823a02-fc45-41ea-b648-9c2dd7e1d31f"[0m
[32m                },[0m
[32m                "roleRef": {[0m
[32m                    "apiGroup": "rbac.authorization.k8s.io",[0m
[32m                    "kind": "Role",[0m
[32m                    "name": "kiali"[0m
[32m                },[0m
[32m                "subjects": [[0m
[32m                    {[0m
[32m                        "kind": "ServiceAccount",[0m
[32m                        "name": "kiali-service-account",[0m
[32m                        "namespace": "istio-system"[0m
[32m                    }[0m
[32m                ][0m
[32m            }[0m
[32m        ][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [{'kind': 'RoleBinding', 'apiVersion': 'rbac.authorization.k8s.io/v1', 'metadata': {'name': 'kiali', 'namespace': 'cluster-wide-access-test-1', 'uid': '061d8298-a5db-40a9-9a7d-5d3f5eac03ce', 'resourceVersion': '4225', 'creationTimestamp': '2023-08-17T07:19:45Z', 'labels': {'app': 'kiali', 'app.kubernetes.io/instance': 'kiali', 'app.kubernetes.io/name': 'kiali', 'app.kubernetes.io/part-of': 'kiali', 'app.kubernetes.io/version': 'master', 'version': 'master'}, 'annotations': {'operator-sdk/primary-resource': 'kiali-operator/kiali', 'operator-sdk/primary-resource-type': 'Kiali.kiali.io'}, 'managedFields': [{'manager': 'OpenAPI-Generator', 'operation': 'Update', 'apiVersion': 'rbac.authorization.k8s.io/v1', 'time': '2023-08-17T07:19:45Z', 'fieldsType': 'FieldsV1', 'fieldsV1': {'f:metadata': {'f:annotations': {'.': {}, 'f:operator-sdk/primary-resource': {}, 'f:operator-sdk/primary-resource-type': {}}, 'f:labels': {'.': {}, 'f:app': {}, 'f:app.kubernetes.io/instance': {}, 'f:app.kubernetes.io/name': {}, 'f:app.kubernetes.io/part-of': {}, 'f:app.kubernetes.io/version': {}, 'f:version': {}}}, 'f:roleRef': {}, 'f:subjects': {}}}]}, 'subjects': [{'kind': 'ServiceAccount', 'name': 'kiali-service-account', 'namespace': 'istio-system'}], 'roleRef': {'apiGroup': 'rbac.authorization.k8s.io', 'kind': 'Role', 'name': 'kiali'}}], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'RoleBinding', 'namespace': 'cluster-wide-access-test-1', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-1', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "RoleBinding",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "cluster-wide-access-test-1",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-1",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [[0m
[32m            {[0m
[32m                "apiVersion": "rbac.authorization.k8s.io/v1",[0m
[32m                "kind": "RoleBinding",[0m
[32m                "metadata": {[0m
[32m                    "annotations": {[0m
[32m                        "operator-sdk/primary-resource": "kiali-operator/kiali",[0m
[32m                        "operator-sdk/primary-resource-type": "Kiali.kiali.io"[0m
[32m                    },[0m
[32m                    "creationTimestamp": "2023-08-17T07:19:45Z",[0m
[32m                    "labels": {[0m
[32m                        "app": "kiali",[0m
[32m                        "app.kubernetes.io/instance": "kiali",[0m
[32m                        "app.kubernetes.io/name": "kiali",[0m
[32m                        "app.kubernetes.io/part-of": "kiali",[0m
[32m                        "app.kubernetes.io/version": "master",[0m
[32m                        "version": "master"[0m
[32m                    },[0m
[32m                    "managedFields": [[0m
[32m                        {[0m
[32m                            "apiVersion": "rbac.authorization.k8s.io/v1",[0m
[32m                            "fieldsType": "FieldsV1",[0m
[32m                            "fieldsV1": {[0m
[32m                                "f:metadata": {[0m
[32m                                    "f:annotations": {[0m
[32m                                        ".": {},[0m
[32m                                        "f:operator-sdk/primary-resource": {},[0m
[32m                                        "f:operator-sdk/primary-resource-type": {}[0m
[32m                                    },[0m
[32m                                    "f:labels": {[0m
[32m                                        ".": {},[0m
[32m                                        "f:app": {},[0m
[32m                                        "f:app.kubernetes.io/instance": {},[0m
[32m                                        "f:app.kubernetes.io/name": {},[0m
[32m                                        "f:app.kubernetes.io/part-of": {},[0m
[32m                                        "f:app.kubernetes.io/version": {},[0m
[32m                                        "f:version": {}[0m
[32m                                    }[0m
[32m                                },[0m
[32m                                "f:roleRef": {},[0m
[32m                                "f:subjects": {}[0m
[32m                            },[0m
[32m                            "manager": "OpenAPI-Generator",[0m
[32m                            "operation": "Update",[0m
[32m                            "time": "2023-08-17T07:19:45Z"[0m
[32m                        }[0m
[32m                    ],[0m
[32m                    "name": "kiali",[0m
[32m                    "namespace": "cluster-wide-access-test-1",[0m
[32m                    "resourceVersion": "4225",[0m
[32m                    "uid": "061d8298-a5db-40a9-9a7d-5d3f5eac03ce"[0m
[32m                },[0m
[32m                "roleRef": {[0m
[32m                    "apiGroup": "rbac.authorization.k8s.io",[0m
[32m                    "kind": "Role",[0m
[32m                    "name": "kiali"[0m
[32m                },[0m
[32m                "subjects": [[0m
[32m                    {[0m
[32m                        "kind": "ServiceAccount",[0m
[32m                        "name": "kiali-service-account",[0m
[32m                        "namespace": "istio-system"[0m
[32m                    }[0m
[32m                ][0m
[32m            }[0m
[32m        ][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [{'kind': 'RoleBinding', 'apiVersion': 'rbac.authorization.k8s.io/v1', 'metadata': {'name': 'kiali', 'namespace': 'cluster-wide-access-test-2', 'uid': '9443c7a7-4369-4899-86a7-3c9f97957c48', 'resourceVersion': '4226', 'creationTimestamp': '2023-08-17T07:19:45Z', 'labels': {'app': 'kiali', 'app.kubernetes.io/instance': 'kiali', 'app.kubernetes.io/name': 'kiali', 'app.kubernetes.io/part-of': 'kiali', 'app.kubernetes.io/version': 'master', 'version': 'master'}, 'annotations': {'operator-sdk/primary-resource': 'kiali-operator/kiali', 'operator-sdk/primary-resource-type': 'Kiali.kiali.io'}, 'managedFields': [{'manager': 'OpenAPI-Generator', 'operation': 'Update', 'apiVersion': 'rbac.authorization.k8s.io/v1', 'time': '2023-08-17T07:19:45Z', 'fieldsType': 'FieldsV1', 'fieldsV1': {'f:metadata': {'f:annotations': {'.': {}, 'f:operator-sdk/primary-resource': {}, 'f:operator-sdk/primary-resource-type': {}}, 'f:labels': {'.': {}, 'f:app': {}, 'f:app.kubernetes.io/instance': {}, 'f:app.kubernetes.io/name': {}, 'f:app.kubernetes.io/part-of': {}, 'f:app.kubernetes.io/version': {}, 'f:version': {}}}, 'f:roleRef': {}, 'f:subjects': {}}}]}, 'subjects': [{'kind': 'ServiceAccount', 'name': 'kiali-service-account', 'namespace': 'istio-system'}], 'roleRef': {'apiGroup': 'rbac.authorization.k8s.io', 'kind': 'Role', 'name': 'kiali'}}], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'RoleBinding', 'namespace': 'cluster-wide-access-test-2', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-2', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "RoleBinding",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "cluster-wide-access-test-2",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-2",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [[0m
[32m            {[0m
[32m                "apiVersion": "rbac.authorization.k8s.io/v1",[0m
[32m                "kind": "RoleBinding",[0m
[32m                "metadata": {[0m
[32m                    "annotations": {[0m
[32m                        "operator-sdk/primary-resource": "kiali-operator/kiali",[0m
[32m                        "operator-sdk/primary-resource-type": "Kiali.kiali.io"[0m
[32m                    },[0m
[32m                    "creationTimestamp": "2023-08-17T07:19:45Z",[0m
[32m                    "labels": {[0m
[32m                        "app": "kiali",[0m
[32m                        "app.kubernetes.io/instance": "kiali",[0m
[32m                        "app.kubernetes.io/name": "kiali",[0m
[32m                        "app.kubernetes.io/part-of": "kiali",[0m
[32m                        "app.kubernetes.io/version": "master",[0m
[32m                        "version": "master"[0m
[32m                    },[0m
[32m                    "managedFields": [[0m
[32m                        {[0m
[32m                            "apiVersion": "rbac.authorization.k8s.io/v1",[0m
[32m                            "fieldsType": "FieldsV1",[0m
[32m                            "fieldsV1": {[0m
[32m                                "f:metadata": {[0m
[32m                                    "f:annotations": {[0m
[32m                                        ".": {},[0m
[32m                                        "f:operator-sdk/primary-resource": {},[0m
[32m                                        "f:operator-sdk/primary-resource-type": {}[0m
[32m                                    },[0m
[32m                                    "f:labels": {[0m
[32m                                        ".": {},[0m
[32m                                        "f:app": {},[0m
[32m                                        "f:app.kubernetes.io/instance": {},[0m
[32m                                        "f:app.kubernetes.io/name": {},[0m
[32m                                        "f:app.kubernetes.io/part-of": {},[0m
[32m                                        "f:app.kubernetes.io/version": {},[0m
[32m                                        "f:version": {}[0m
[32m                                    }[0m
[32m                                },[0m
[32m                                "f:roleRef": {},[0m
[32m                                "f:subjects": {}[0m
[32m                            },[0m
[32m                            "manager": "OpenAPI-Generator",[0m
[32m                            "operation": "Update",[0m
[32m                            "time": "2023-08-17T07:19:45Z"[0m
[32m                        }[0m
[32m                    ],[0m
[32m                    "name": "kiali",[0m
[32m                    "namespace": "cluster-wide-access-test-2",[0m
[32m                    "resourceVersion": "4226",[0m
[32m                    "uid": "9443c7a7-4369-4899-86a7-3c9f97957c48"[0m
[32m                },[0m
[32m                "roleRef": {[0m
[32m                    "apiGroup": "rbac.authorization.k8s.io",[0m
[32m                    "kind": "Role",[0m
[32m                    "name": "kiali"[0m
[32m                },[0m
[32m                "subjects": [[0m
[32m                    {[0m
[32m                        "kind": "ServiceAccount",[0m
[32m                        "name": "kiali-service-account",[0m
[32m                        "namespace": "istio-system"[0m
[32m                    }[0m
[32m                ][0m
[32m            }[0m
[32m        ][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [{'kind': 'RoleBinding', 'apiVersion': 'rbac.authorization.k8s.io/v1', 'metadata': {'name': 'kiali', 'namespace': 'cluster-wide-access-test-x', 'uid': 'dbf8ed4d-55f3-4c28-8895-f7fdec2b9932', 'resourceVersion': '4227', 'creationTimestamp': '2023-08-17T07:19:45Z', 'labels': {'app': 'kiali', 'app.kubernetes.io/instance': 'kiali', 'app.kubernetes.io/name': 'kiali', 'app.kubernetes.io/part-of': 'kiali', 'app.kubernetes.io/version': 'master', 'version': 'master'}, 'annotations': {'operator-sdk/primary-resource': 'kiali-operator/kiali', 'operator-sdk/primary-resource-type': 'Kiali.kiali.io'}, 'managedFields': [{'manager': 'OpenAPI-Generator', 'operation': 'Update', 'apiVersion': 'rbac.authorization.k8s.io/v1', 'time': '2023-08-17T07:19:45Z', 'fieldsType': 'FieldsV1', 'fieldsV1': {'f:metadata': {'f:annotations': {'.': {}, 'f:operator-sdk/primary-resource': {}, 'f:operator-sdk/primary-resource-type': {}}, 'f:labels': {'.': {}, 'f:app': {}, 'f:app.kubernetes.io/instance': {}, 'f:app.kubernetes.io/name': {}, 'f:app.kubernetes.io/part-of': {}, 'f:app.kubernetes.io/version': {}, 'f:version': {}}}, 'f:roleRef': {}, 'f:subjects': {}}}]}, 'subjects': [{'kind': 'ServiceAccount', 'name': 'kiali-service-account', 'namespace': 'istio-system'}], 'roleRef': {'apiGroup': 'rbac.authorization.k8s.io', 'kind': 'Role', 'name': 'kiali'}}], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'RoleBinding', 'namespace': 'cluster-wide-access-test-x', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-x', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "RoleBinding",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "cluster-wide-access-test-x",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-x",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [[0m
[32m            {[0m
[32m                "apiVersion": "rbac.authorization.k8s.io/v1",[0m
[32m                "kind": "RoleBinding",[0m
[32m                "metadata": {[0m
[32m                    "annotations": {[0m
[32m                        "operator-sdk/primary-resource": "kiali-operator/kiali",[0m
[32m                        "operator-sdk/primary-resource-type": "Kiali.kiali.io"[0m
[32m                    },[0m
[32m                    "creationTimestamp": "2023-08-17T07:19:45Z",[0m
[32m                    "labels": {[0m
[32m                        "app": "kiali",[0m
[32m                        "app.kubernetes.io/instance": "kiali",[0m
[32m                        "app.kubernetes.io/name": "kiali",[0m
[32m                        "app.kubernetes.io/part-of": "kiali",[0m
[32m                        "app.kubernetes.io/version": "master",[0m
[32m                        "version": "master"[0m
[32m                    },[0m
[32m                    "managedFields": [[0m
[32m                        {[0m
[32m                            "apiVersion": "rbac.authorization.k8s.io/v1",[0m
[32m                            "fieldsType": "FieldsV1",[0m
[32m                            "fieldsV1": {[0m
[32m                                "f:metadata": {[0m
[32m                                    "f:annotations": {[0m
[32m                                        ".": {},[0m
[32m                                        "f:operator-sdk/primary-resource": {},[0m
[32m                                        "f:operator-sdk/primary-resource-type": {}[0m
[32m                                    },[0m
[32m                                    "f:labels": {[0m
[32m                                        ".": {},[0m
[32m                                        "f:app": {},[0m
[32m                                        "f:app.kubernetes.io/instance": {},[0m
[32m                                        "f:app.kubernetes.io/name": {},[0m
[32m                                        "f:app.kubernetes.io/part-of": {},[0m
[32m                                        "f:app.kubernetes.io/version": {},[0m
[32m                                        "f:version": {}[0m
[32m                                    }[0m
[32m                                },[0m
[32m                                "f:roleRef": {},[0m
[32m                                "f:subjects": {}[0m
[32m                            },[0m
[32m                            "manager": "OpenAPI-Generator",[0m
[32m                            "operation": "Update",[0m
[32m                            "time": "2023-08-17T07:19:45Z"[0m
[32m                        }[0m
[32m                    ],[0m
[32m                    "name": "kiali",[0m
[32m                    "namespace": "cluster-wide-access-test-x",[0m
[32m                    "resourceVersion": "4227",[0m
[32m                    "uid": "dbf8ed4d-55f3-4c28-8895-f7fdec2b9932"[0m
[32m                },[0m
[32m                "roleRef": {[0m
[32m                    "apiGroup": "rbac.authorization.k8s.io",[0m
[32m                    "kind": "Role",[0m
[32m                    "name": "kiali"[0m
[32m                },[0m
[32m                "subjects": [[0m
[32m                    {[0m
[32m                        "kind": "ServiceAccount",[0m
[32m                        "name": "kiali-service-account",[0m
[32m                        "namespace": "istio-system"[0m
[32m                    }[0m
[32m                ][0m
[32m            }[0m
[32m        ][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/asserts/roles-test/none_clusterrole_asserts.yml for localhost[0m

TASK [Get cluster roles] *******************************************************
[32mok: [localhost][0m

TASK [Get viewer cluster roles] ************************************************
[32mok: [localhost][0m

TASK [Assert that no cluster roles exist] **************************************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Assert that no viewer cluster roles exist] *******************************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Get cluster role binding] ************************************************
[32mok: [localhost][0m

TASK [Assert that no cluster role binding exists] ******************************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [debug] *******************************************************************
[32mok: [localhost] => {[0m
[32m    "msg": "the server should only return those namespaces filtered by the discoverySelectors - the roles still let us see them"[0m
[32m}[0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/asserts/assert-api-namespaces-result.yml for localhost[0m

TASK [Call /namespaces API] ****************************************************
[32mok: [localhost][0m

TASK [Results of /namespaces API] **********************************************
[32mok: [localhost] => {[0m
[32m    "msg": {[0m
[32m        "changed": false,[0m
[32m        "connection": "close",[0m
[32m        "content": "[{\"name\":\"cluster-wide-access-test-1\",\"cluster\":\"Kubernetes\",\"isAmbient\":false,\"labels\":{\"discoverySelectorLabel1\":\"test\",\"kiali.io/member-of\":\"istio-system\",\"kubernetes.io/metadata.name\":\"cluster-wide-access-test-1\"},\"annotations\":{}},{\"name\":\"cluster-wide-access-test-2\",\"cluster\":\"Kubernetes\",\"isAmbient\":false,\"labels\":{\"discoverySelectorLabel2\":\"matchme\",\"kiali.io/member-of\":\"istio-system\",\"kubernetes.io/metadata.name\":\"cluster-wide-access-test-2\"},\"annotations\":{}},{\"name\":\"istio-system\",\"cluster\":\"Kubernetes\",\"isAmbient\":false,\"labels\":{\"kiali.io/member-of\":\"istio-system\",\"kubernetes.io/metadata.name\":\"istio-system\",\"topology.istio.io/network\":\"\"},\"annotations\":{}}]",[0m
[32m        "content_length": "679",[0m
[32m        "content_type": "application/json",[0m
[32m        "cookies": {},[0m
[32m        "cookies_string": "",[0m
[32m        "date": "Thu, 17 Aug 2023 07:20:31 GMT",[0m
[32m        "elapsed": 0,[0m
[32m        "failed": false,[0m
[32m        "json": [[0m
[32m            {[0m
[32m                "annotations": {},[0m
[32m                "cluster": "Kubernetes",[0m
[32m                "isAmbient": false,[0m
[32m                "labels": {[0m
[32m                    "discoverySelectorLabel1": "test",[0m
[32m                    "kiali.io/member-of": "istio-system",[0m
[32m                    "kubernetes.io/metadata.name": "cluster-wide-access-test-1"[0m
[32m                },[0m
[32m                "name": "cluster-wide-access-test-1"[0m
[32m            },[0m
[32m            {[0m
[32m                "annotations": {},[0m
[32m                "cluster": "Kubernetes",[0m
[32m                "isAmbient": false,[0m
[32m                "labels": {[0m
[32m                    "discoverySelectorLabel2": "matchme",[0m
[32m                    "kiali.io/member-of": "istio-system",[0m
[32m                    "kubernetes.io/metadata.name": "cluster-wide-access-test-2"[0m
[32m                },[0m
[32m                "name": "cluster-wide-access-test-2"[0m
[32m            },[0m
[32m            {[0m
[32m                "annotations": {},[0m
[32m                "cluster": "Kubernetes",[0m
[32m                "isAmbient": false,[0m
[32m                "labels": {[0m
[32m                    "kiali.io/member-of": "istio-system",[0m
[32m                    "kubernetes.io/metadata.name": "istio-system",[0m
[32m                    "topology.istio.io/network": ""[0m
[32m                },[0m
[32m                "name": "istio-system"[0m
[32m            }[0m
[32m        ],[0m
[32m        "msg": "OK (679 bytes)",[0m
[32m        "redirected": false,[0m
[32m        "status": 200,[0m
[32m        "url": "http://172.18.255.71:20001/kiali/api/namespaces",[0m
[32m        "vary": "Accept-Encoding"[0m
[32m    }[0m
[32m}[0m

TASK [Assert that we got no less than the minimum number of namespaces expected] ***
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Assert that we got no more than the maximum number of namespaces expected] ***
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Assert that we got the namespaces expected] ******************************
[32mok: [localhost] => (item=istio-system) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": "istio-system",[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item=cluster-wide-access-test-1) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": "cluster-wide-access-test-1",[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item=cluster-wide-access-test-2) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": "cluster-wide-access-test-2",[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Assert that we did not get namespaces that were not expected] ************
[36mskipping: [localhost][0m

TASK [Remove the discovery selectors] ******************************************
[36mincluded: /tmp/molecule/operator/molecule/cluster-wide-access-test/set-istio-configmap-discovery-selectors.yml for localhost[0m

TASK [fail] ********************************************************************
[36mskipping: [localhost][0m

TASK [Get the Istio ConfigMap data.mesh configuration] *************************
[36mskipping: [localhost][0m

TASK [fail] ********************************************************************
[36mskipping: [localhost][0m

TASK [Setting discoverySelectors in Istio ConfigMap data.mesh] *****************
[31m--- before[0m
[32m+++ after[0m
[36m@@ -1,6 +1,6 @@[0m
 {
     "data": {
[31m-        "mesh": "accessLogFile: /dev/stdout\ndefaultConfig:\n  discoveryAddress: istiod.istio-system.svc:15012\n  proxyMetadata: {}\n  tracing:\n    zipkin:\n      address: zipkin.istio-system:9411\ndefaultProviders:\n  metrics:\n  - prometheus\ndiscoverySelectors:\n- matchLabels:\n    discoverySelectorLabel1: test\n- matchExpressions:\n  - key: discoverySelectorLabel2\n    operator: In\n    values:\n    - matchme\nenableAutoMtls: true\nenablePrometheusMerge: true\nextensionProviders:\n- envoyOtelAls:\n    port: 4317\n    service: opentelemetry-collector.istio-system.svc.cluster.local\n  name: otel\n- name: skywalking\n  skywalking:\n    port: 11800\n    service: tracing.istio-system.svc.cluster.local\n- name: otel-tracing\n  opentelemetry:\n    port: 4317\n    service: opentelemetry-collector.otel-collector.svc.cluster.local\nrootNamespace: istio-system\ntrustDomain: cluster.local\n"[0m
[32m+        "mesh": "accessLogFile: /dev/stdout\ndefaultConfig:\n  discoveryAddress: istiod.istio-system.svc:15012\n  proxyMetadata: {}\n  tracing:\n    zipkin:\n      address: zipkin.istio-system:9411\ndefaultProviders:\n  metrics:\n  - prometheus\nenableAutoMtls: true\nenablePrometheusMerge: true\nextensionProviders:\n- envoyOtelAls:\n    port: 4317\n    service: opentelemetry-collector.istio-system.svc.cluster.local\n  name: otel\n- name: skywalking\n  skywalking:\n    port: 11800\n    service: tracing.istio-system.svc.cluster.local\n- name: otel-tracing\n  opentelemetry:\n    port: 4317\n    service: opentelemetry-collector.otel-collector.svc.cluster.local\nrootNamespace: istio-system\ntrustDomain: cluster.local\n"[0m
     },
     "metadata": {
         "managedFields": [
[36m@@ -40,9 +40,9 @@[0m
                 },
                 "manager": "OpenAPI-Generator",
                 "operation": "Update",
[31m-                "time": "2023-08-17T07:18:29Z"[0m
[32m+                "time": "2023-08-17T07:20:32Z"[0m
             }
         ],
[31m-        "resourceVersion": "4008"[0m
[32m+        "resourceVersion": "4364"[0m
     }
 }

[33mchanged: [localhost][0m

TASK [Pause for a few seconds to ensure the server gets notified of the change to the Istio ConfigMap] ***
Pausing for 15 seconds
(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
[32mok: [localhost][0m

TASK [debug] *******************************************************************
[32mok: [localhost] => {[0m
[32m    "msg": "Now that we do not have discoverySelectors, we should see all AN namespaces (istio-system, cluster-wide-access-test-1, cluster-wide-access-test-2, cluster-wide-access-test-x)"[0m
[32m}[0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/asserts/assert-api-namespaces-result.yml for localhost[0m

TASK [Call /namespaces API] ****************************************************
[32mok: [localhost][0m

TASK [Results of /namespaces API] **********************************************
[32mok: [localhost] => {[0m
[32m    "msg": {[0m
[32m        "changed": false,[0m
[32m        "connection": "close",[0m
[32m        "content": "[{\"name\":\"cluster-wide-access-test-1\",\"cluster\":\"Kubernetes\",\"isAmbient\":false,\"labels\":{\"discoverySelectorLabel1\":\"test\",\"kiali.io/member-of\":\"istio-system\",\"kubernetes.io/metadata.name\":\"cluster-wide-access-test-1\"},\"annotations\":{}},{\"name\":\"cluster-wide-access-test-2\",\"cluster\":\"Kubernetes\",\"isAmbient\":false,\"labels\":{\"discoverySelectorLabel2\":\"matchme\",\"kiali.io/member-of\":\"istio-system\",\"kubernetes.io/metadata.name\":\"cluster-wide-access-test-2\"},\"annotations\":{}},{\"name\":\"cluster-wide-access-test-x\",\"cluster\":\"Kubernetes\",\"isAmbient\":false,\"labels\":{\"kiali.io/member-of\":\"istio-system\",\"kubernetes.io/metadata.name\":\"cluster-wide-access-test-x\"},\"annotations\":{}},{\"name\":\"istio-system\",\"cluster\":\"Kubernetes\",\"isAmbient\":false,\"labels\":{\"kiali.io/member-of\":\"istio-system\",\"kubernetes.io/metadata.name\":\"istio-system\",\"topology.istio.io/network\":\"\"},\"annotations\":{}}]",[0m
[32m        "content_length": "881",[0m
[32m        "content_type": "application/json",[0m
[32m        "cookies": {},[0m
[32m        "cookies_string": "",[0m
[32m        "date": "Thu, 17 Aug 2023 07:20:47 GMT",[0m
[32m        "elapsed": 0,[0m
[32m        "failed": false,[0m
[32m        "json": [[0m
[32m            {[0m
[32m                "annotations": {},[0m
[32m                "cluster": "Kubernetes",[0m
[32m                "isAmbient": false,[0m
[32m                "labels": {[0m
[32m                    "discoverySelectorLabel1": "test",[0m
[32m                    "kiali.io/member-of": "istio-system",[0m
[32m                    "kubernetes.io/metadata.name": "cluster-wide-access-test-1"[0m
[32m                },[0m
[32m                "name": "cluster-wide-access-test-1"[0m
[32m            },[0m
[32m            {[0m
[32m                "annotations": {},[0m
[32m                "cluster": "Kubernetes",[0m
[32m                "isAmbient": false,[0m
[32m                "labels": {[0m
[32m                    "discoverySelectorLabel2": "matchme",[0m
[32m                    "kiali.io/member-of": "istio-system",[0m
[32m                    "kubernetes.io/metadata.name": "cluster-wide-access-test-2"[0m
[32m                },[0m
[32m                "name": "cluster-wide-access-test-2"[0m
[32m            },[0m
[32m            {[0m
[32m                "annotations": {},[0m
[32m                "cluster": "Kubernetes",[0m
[32m                "isAmbient": false,[0m
[32m                "labels": {[0m
[32m                    "kiali.io/member-of": "istio-system",[0m
[32m                    "kubernetes.io/metadata.name": "cluster-wide-access-test-x"[0m
[32m                },[0m
[32m                "name": "cluster-wide-access-test-x"[0m
[32m            },[0m
[32m            {[0m
[32m                "annotations": {},[0m
[32m                "cluster": "Kubernetes",[0m
[32m                "isAmbient": false,[0m
[32m                "labels": {[0m
[32m                    "kiali.io/member-of": "istio-system",[0m
[32m                    "kubernetes.io/metadata.name": "istio-system",[0m
[32m                    "topology.istio.io/network": ""[0m
[32m                },[0m
[32m                "name": "istio-system"[0m
[32m            }[0m
[32m        ],[0m
[32m        "msg": "OK (881 bytes)",[0m
[32m        "redirected": false,[0m
[32m        "status": 200,[0m
[32m        "url": "http://172.18.255.71:20001/kiali/api/namespaces",[0m
[32m        "vary": "Accept-Encoding"[0m
[32m    }[0m
[32m}[0m

TASK [Assert that we got no less than the minimum number of namespaces expected] ***
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Assert that we got no more than the maximum number of namespaces expected] ***
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Assert that we got the namespaces expected] ******************************
[32mok: [localhost] => (item=istio-system) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": "istio-system",[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item=cluster-wide-access-test-1) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": "cluster-wide-access-test-1",[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item=cluster-wide-access-test-2) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": "cluster-wide-access-test-2",[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item=cluster-wide-access-test-x) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": "cluster-wide-access-test-x",[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Assert that we did not get namespaces that were not expected] ************
[36mskipping: [localhost][0m

TASK [debug] *******************************************************************
[32mok: [localhost] => {[0m
[32m    "msg": "We have AN=list and CWA=false. Now let's set CWA=true and see the roles get removed and cluster roles added"[0m
[32m}[0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/common/set_kiali_cr.yml for localhost[0m

TASK [Change Kiali CR with new Kiali CR] ***************************************
[31m--- before[0m
[32m+++ after[0m
[36m@@ -1,6 +1,6 @@[0m
 {
     "metadata": {
[31m-        "generation": 4,[0m
[32m+        "generation": 5,[0m
         "managedFields": [
             {
                 "apiVersion": "kiali.io/v1alpha1",
[36m@@ -16,42 +16,6 @@[0m
                 "manager": "ansible-operator",
                 "operation": "Update",
                 "time": "2023-08-17T07:16:19Z"
[31m-            },[0m
[31m-            {[0m
[31m-                "apiVersion": "kiali.io/v1alpha1",[0m
[31m-                "fieldsType": "FieldsV1",[0m
[31m-                "fieldsV1": {[0m
[31m-                    "f:spec": {[0m
[31m-                        ".": {},[0m
[31m-                        "f:auth": {[0m
[31m-                            ".": {},[0m
[31m-                            "f:strategy": {}[0m
[31m-                        },[0m
[31m-                        "f:deployment": {[0m
[31m-                            ".": {},[0m
[31m-                            "f:accessible_namespaces": {},[0m
[31m-                            "f:cluster_wide_access": {},[0m
[31m-                            "f:image_name": {},[0m
[31m-                            "f:image_pull_policy": {},[0m
[31m-                            "f:image_version": {},[0m
[31m-                            "f:ingress": {[0m
[31m-                                ".": {},[0m
[31m-                                "f:enabled": {}[0m
[31m-                            },[0m
[31m-                            "f:logger": {[0m
[31m-                                ".": {},[0m
[31m-                                "f:log_level": {}[0m
[31m-                            },[0m
[31m-                            "f:namespace": {},[0m
[31m-                            "f:service_type": {}[0m
[31m-                        },[0m
[31m-                        "f:istio_namespace": {},[0m
[31m-                        "f:version": {}[0m
[31m-                    }[0m
[31m-                },[0m
[31m-                "manager": "OpenAPI-Generator",[0m
[31m-                "operation": "Update",[0m
[31m-                "time": "2023-08-17T07:19:29Z"[0m
             },
             {
                 "apiVersion": "kiali.io/v1alpha1",
[36m@@ -96,13 +60,49 @@[0m
                 "operation": "Update",
                 "subresource": "status",
                 "time": "2023-08-17T07:19:46Z"
[32m+            },[0m
[32m+            {[0m
[32m+                "apiVersion": "kiali.io/v1alpha1",[0m
[32m+                "fieldsType": "FieldsV1",[0m
[32m+                "fieldsV1": {[0m
[32m+                    "f:spec": {[0m
[32m+                        ".": {},[0m
[32m+                        "f:auth": {[0m
[32m+                            ".": {},[0m
[32m+                            "f:strategy": {}[0m
[32m+                        },[0m
[32m+                        "f:deployment": {[0m
[32m+                            ".": {},[0m
[32m+                            "f:accessible_namespaces": {},[0m
[32m+                            "f:cluster_wide_access": {},[0m
[32m+                            "f:image_name": {},[0m
[32m+                            "f:image_pull_policy": {},[0m
[32m+                            "f:image_version": {},[0m
[32m+                            "f:ingress": {[0m
[32m+                                ".": {},[0m
[32m+                                "f:enabled": {}[0m
[32m+                            },[0m
[32m+                            "f:logger": {[0m
[32m+                                ".": {},[0m
[32m+                                "f:log_level": {}[0m
[32m+                            },[0m
[32m+                            "f:namespace": {},[0m
[32m+                            "f:service_type": {}[0m
[32m+                        },[0m
[32m+                        "f:istio_namespace": {},[0m
[32m+                        "f:version": {}[0m
[32m+                    }[0m
[32m+                },[0m
[32m+                "manager": "OpenAPI-Generator",[0m
[32m+                "operation": "Update",[0m
[32m+                "time": "2023-08-17T07:20:48Z"[0m
             }
         ],
[31m-        "resourceVersion": "4264"[0m
[32m+        "resourceVersion": "4396"[0m
     },
     "spec": {
         "deployment": {
[31m-            "cluster_wide_access": false[0m
[32m+            "cluster_wide_access": true[0m
         }
     }
 }

[33mchanged: [localhost][0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/common/wait_for_kiali_cr_changes.yml for localhost[0m

TASK [Wait for Kiali CR changes to take effect] ********************************
[1;30mFAILED - RETRYING: [localhost]: Wait for Kiali CR changes to take effect (120 retries left).[0m
[1;30mFAILED - RETRYING: [localhost]: Wait for Kiali CR changes to take effect (119 retries left).[0m
[1;30mFAILED - RETRYING: [localhost]: Wait for Kiali CR changes to take effect (118 retries left).[0m
[32mok: [localhost][0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/common/wait_for_kiali_running.yml for localhost[0m

TASK [Asserting that Kiali Pod exists and there is only one] *******************
[32mok: [localhost][0m

TASK [Wait for Kiali to be running and accepting requests] *********************
[1;30mFAILED - RETRYING: [localhost]: Wait for Kiali to be running and accepting requests (120 retries left).[0m
[32mok: [localhost][0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/common/tasks.yml for localhost[0m

TASK [Get information about the cluster] ***************************************
[32mok: [localhost][0m

TASK [Determine the cluster type] **********************************************
[32mok: [localhost][0m

TASK [Determine the Istio implementation] **************************************
[32mok: [localhost][0m

TASK [Get SMCP if running in Maistra environment] ******************************
[36mskipping: [localhost][0m

TASK [There must one and only one SMCP already installed in the control plane] ***
[36mskipping: [localhost][0m

TASK [Get Kiali CR if present] *************************************************
[32mok: [localhost][0m

TASK [Get Kiali Operator Pod] **************************************************
[32mok: [localhost][0m

TASK [Get Kiali Pod] ***********************************************************
[32mok: [localhost][0m

TASK [Get Kiali Configmap] *****************************************************
[32mok: [localhost][0m

TASK [Format Configmap] ********************************************************
[32mok: [localhost][0m

TASK [Get Kiali Deployment] ****************************************************
[32mok: [localhost][0m

TASK [Get Kiali Service] *******************************************************
[32mok: [localhost][0m

TASK [Get Kiali Route] *********************************************************
[36mskipping: [localhost][0m

TASK [Determine the Kiali Route URL on OpenShift] ******************************
[36mskipping: [localhost][0m

TASK [Determine the Kiali Ingress URL on minikube] *****************************
[36mskipping: [localhost][0m

TASK [Determine the Kiali Ingress URL on kind] *********************************
[32mok: [localhost][0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/asserts/pod_asserts.yml for localhost[0m

TASK [Assert Kiali Pod is Running and there is only one] ***********************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Assert Kiali Pod is Running on the correct Namespace] ********************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/asserts/roles-test/rw_clusterrole_asserts.yml for localhost[0m

TASK [Get cluster roles] *******************************************************
[32mok: [localhost][0m

TASK [Assert that cluster roles exist] *****************************************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Get cluster role binding] ************************************************
[32mok: [localhost][0m

TASK [Assert the cluster role binding provides the read-write role] ************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/asserts/roles-test/none_role_asserts.yml for localhost[0m

TASK [Get roles] ***************************************************************
[32mok: [localhost] => (item=['istio-system', 'kiali'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-1', 'kiali'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-2', 'kiali'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-x', 'kiali'])[0m

TASK [Assert that namespaces do not have the roles] ****************************
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'istio-system', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['istio-system', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "istio-system",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "istio-system",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'cluster-wide-access-test-1', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-1', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "cluster-wide-access-test-1",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-1",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'cluster-wide-access-test-2', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-2', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "cluster-wide-access-test-2",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-2",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'cluster-wide-access-test-x', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-x', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "cluster-wide-access-test-x",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-x",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Get viewer roles] ********************************************************
[32mok: [localhost] => (item=['istio-system', 'kiali-viewer'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-1', 'kiali-viewer'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-2', 'kiali-viewer'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-x', 'kiali-viewer'])[0m

TASK [Assert that namespaces do not have the viewer roles] *********************
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'istio-system', 'name': 'kiali-viewer', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['istio-system', 'kiali-viewer'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali-viewer",[0m
[32m                "namespace": "istio-system",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "istio-system",[0m
[32m            "kiali-viewer"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'cluster-wide-access-test-1', 'name': 'kiali-viewer', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-1', 'kiali-viewer'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali-viewer",[0m
[32m                "namespace": "cluster-wide-access-test-1",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-1",[0m
[32m            "kiali-viewer"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'cluster-wide-access-test-2', 'name': 'kiali-viewer', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-2', 'kiali-viewer'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali-viewer",[0m
[32m                "namespace": "cluster-wide-access-test-2",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-2",[0m
[32m            "kiali-viewer"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'cluster-wide-access-test-x', 'name': 'kiali-viewer', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-x', 'kiali-viewer'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali-viewer",[0m
[32m                "namespace": "cluster-wide-access-test-x",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-x",[0m
[32m            "kiali-viewer"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Get role bindings] *******************************************************
[32mok: [localhost] => (item=['istio-system', 'kiali'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-1', 'kiali'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-2', 'kiali'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-x', 'kiali'])[0m

TASK [Assert the role bindings do not exist] ***********************************
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'RoleBinding', 'namespace': 'istio-system', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['istio-system', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "RoleBinding",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "istio-system",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "istio-system",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'RoleBinding', 'namespace': 'cluster-wide-access-test-1', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-1', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "RoleBinding",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "cluster-wide-access-test-1",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-1",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'RoleBinding', 'namespace': 'cluster-wide-access-test-2', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-2', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "RoleBinding",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "cluster-wide-access-test-2",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-2",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'RoleBinding', 'namespace': 'cluster-wide-access-test-x', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-x', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "RoleBinding",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "cluster-wide-access-test-x",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-x",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [debug] *******************************************************************
[32mok: [localhost] => {[0m
[32m    "msg": "We have AN=list and CWA=true. Now let's set CWA back to false and see the roles get added and cluster roles removed"[0m
[32m}[0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/common/set_kiali_cr.yml for localhost[0m

TASK [Change Kiali CR with new Kiali CR] ***************************************
[31m--- before[0m
[32m+++ after[0m
[36m@@ -1,6 +1,6 @@[0m
 {
     "metadata": {
[31m-        "generation": 5,[0m
[32m+        "generation": 6,[0m
         "managedFields": [
             {
                 "apiVersion": "kiali.io/v1alpha1",
[36m@@ -16,42 +16,6 @@[0m
                 "manager": "ansible-operator",
                 "operation": "Update",
                 "time": "2023-08-17T07:16:19Z"
[31m-            },[0m
[31m-            {[0m
[31m-                "apiVersion": "kiali.io/v1alpha1",[0m
[31m-                "fieldsType": "FieldsV1",[0m
[31m-                "fieldsV1": {[0m
[31m-                    "f:spec": {[0m
[31m-                        ".": {},[0m
[31m-                        "f:auth": {[0m
[31m-                            ".": {},[0m
[31m-                            "f:strategy": {}[0m
[31m-                        },[0m
[31m-                        "f:deployment": {[0m
[31m-                            ".": {},[0m
[31m-                            "f:accessible_namespaces": {},[0m
[31m-                            "f:cluster_wide_access": {},[0m
[31m-                            "f:image_name": {},[0m
[31m-                            "f:image_pull_policy": {},[0m
[31m-                            "f:image_version": {},[0m
[31m-                            "f:ingress": {[0m
[31m-                                ".": {},[0m
[31m-                                "f:enabled": {}[0m
[31m-                            },[0m
[31m-                            "f:logger": {[0m
[31m-                                ".": {},[0m
[31m-                                "f:log_level": {}[0m
[31m-                            },[0m
[31m-                            "f:namespace": {},[0m
[31m-                            "f:service_type": {}[0m
[31m-                        },[0m
[31m-                        "f:istio_namespace": {},[0m
[31m-                        "f:version": {}[0m
[31m-                    }[0m
[31m-                },[0m
[31m-                "manager": "OpenAPI-Generator",[0m
[31m-                "operation": "Update",[0m
[31m-                "time": "2023-08-17T07:20:48Z"[0m
             },
             {
                 "apiVersion": "kiali.io/v1alpha1",
[36m@@ -96,13 +60,49 @@[0m
                 "operation": "Update",
                 "subresource": "status",
                 "time": "2023-08-17T07:21:05Z"
[32m+            },[0m
[32m+            {[0m
[32m+                "apiVersion": "kiali.io/v1alpha1",[0m
[32m+                "fieldsType": "FieldsV1",[0m
[32m+                "fieldsV1": {[0m
[32m+                    "f:spec": {[0m
[32m+                        ".": {},[0m
[32m+                        "f:auth": {[0m
[32m+                            ".": {},[0m
[32m+                            "f:strategy": {}[0m
[32m+                        },[0m
[32m+                        "f:deployment": {[0m
[32m+                            ".": {},[0m
[32m+                            "f:accessible_namespaces": {},[0m
[32m+                            "f:cluster_wide_access": {},[0m
[32m+                            "f:image_name": {},[0m
[32m+                            "f:image_pull_policy": {},[0m
[32m+                            "f:image_version": {},[0m
[32m+                            "f:ingress": {[0m
[32m+                                ".": {},[0m
[32m+                                "f:enabled": {}[0m
[32m+                            },[0m
[32m+                            "f:logger": {[0m
[32m+                                ".": {},[0m
[32m+                                "f:log_level": {}[0m
[32m+                            },[0m
[32m+                            "f:namespace": {},[0m
[32m+                            "f:service_type": {}[0m
[32m+                        },[0m
[32m+                        "f:istio_namespace": {},[0m
[32m+                        "f:version": {}[0m
[32m+                    }[0m
[32m+                },[0m
[32m+                "manager": "OpenAPI-Generator",[0m
[32m+                "operation": "Update",[0m
[32m+                "time": "2023-08-17T07:21:55Z"[0m
             }
         ],
[31m-        "resourceVersion": "4486"[0m
[32m+        "resourceVersion": "4591"[0m
     },
     "spec": {
         "deployment": {
[31m-            "cluster_wide_access": true[0m
[32m+            "cluster_wide_access": false[0m
         }
     }
 }

[33mchanged: [localhost][0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/common/wait_for_kiali_cr_changes.yml for localhost[0m

TASK [Wait for Kiali CR changes to take effect] ********************************
[1;30mFAILED - RETRYING: [localhost]: Wait for Kiali CR changes to take effect (120 retries left).[0m
[1;30mFAILED - RETRYING: [localhost]: Wait for Kiali CR changes to take effect (119 retries left).[0m
[1;30mFAILED - RETRYING: [localhost]: Wait for Kiali CR changes to take effect (118 retries left).[0m
[32mok: [localhost][0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/common/wait_for_kiali_running.yml for localhost[0m

TASK [Asserting that Kiali Pod exists and there is only one] *******************
[32mok: [localhost][0m

TASK [Wait for Kiali to be running and accepting requests] *********************
[1;30mFAILED - RETRYING: [localhost]: Wait for Kiali to be running and accepting requests (120 retries left).[0m
[32mok: [localhost][0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/common/tasks.yml for localhost[0m

TASK [Get information about the cluster] ***************************************
[32mok: [localhost][0m

TASK [Determine the cluster type] **********************************************
[32mok: [localhost][0m

TASK [Determine the Istio implementation] **************************************
[32mok: [localhost][0m

TASK [Get SMCP if running in Maistra environment] ******************************
[36mskipping: [localhost][0m

TASK [There must one and only one SMCP already installed in the control plane] ***
[36mskipping: [localhost][0m

TASK [Get Kiali CR if present] *************************************************
[32mok: [localhost][0m

TASK [Get Kiali Operator Pod] **************************************************
[32mok: [localhost][0m

TASK [Get Kiali Pod] ***********************************************************
[32mok: [localhost][0m

TASK [Get Kiali Configmap] *****************************************************
[32mok: [localhost][0m

TASK [Format Configmap] ********************************************************
[32mok: [localhost][0m

TASK [Get Kiali Deployment] ****************************************************
[32mok: [localhost][0m

TASK [Get Kiali Service] *******************************************************
[32mok: [localhost][0m

TASK [Get Kiali Route] *********************************************************
[36mskipping: [localhost][0m

TASK [Determine the Kiali Route URL on OpenShift] ******************************
[36mskipping: [localhost][0m

TASK [Determine the Kiali Ingress URL on minikube] *****************************
[36mskipping: [localhost][0m

TASK [Determine the Kiali Ingress URL on kind] *********************************
[32mok: [localhost][0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/asserts/pod_asserts.yml for localhost[0m

TASK [Assert Kiali Pod is Running and there is only one] ***********************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Assert Kiali Pod is Running on the correct Namespace] ********************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/asserts/roles-test/rw_role_asserts.yml for localhost[0m

TASK [Get roles] ***************************************************************
[32mok: [localhost] => (item=['istio-system', 'kiali'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-1', 'kiali'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-2', 'kiali'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-x', 'kiali'])[0m

TASK [Assert that namespaces have the correct roles] ***************************
[32mok: [localhost] => (item={'changed': False, 'resources': [{'kind': 'Role', 'apiVersion': 'rbac.authorization.k8s.io/v1', 'metadata': {'name': 'kiali', 'namespace': 'istio-system', 'uid': 'd5dacb9a-da01-43e7-9864-4a74526757cf', 'resourceVersion': '4633', 'creationTimestamp': '2023-08-17T07:22:08Z', 'labels': {'app': 'kiali', 'app.kubernetes.io/instance': 'kiali', 'app.kubernetes.io/name': 'kiali', 'app.kubernetes.io/part-of': 'kiali', 'app.kubernetes.io/version': 'master', 'version': 'master'}, 'annotations': {'operator-sdk/primary-resource': 'kiali-operator/kiali', 'operator-sdk/primary-resource-type': 'Kiali.kiali.io'}, 'managedFields': [{'manager': 'OpenAPI-Generator', 'operation': 'Update', 'apiVersion': 'rbac.authorization.k8s.io/v1', 'time': '2023-08-17T07:22:08Z', 'fieldsType': 'FieldsV1', 'fieldsV1': {'f:metadata': {'f:annotations': {'.': {}, 'f:operator-sdk/primary-resource': {}, 'f:operator-sdk/primary-resource-type': {}}, 'f:labels': {'.': {}, 'f:app': {}, 'f:app.kubernetes.io/instance': {}, 'f:app.kubernetes.io/name': {}, 'f:app.kubernetes.io/part-of': {}, 'f:app.kubernetes.io/version': {}, 'f:version': {}}}, 'f:rules': {}}}]}, 'rules': [{'verbs': ['get', 'list', 'watch'], 'apiGroups': [''], 'resources': ['configmaps', 'endpoints', 'pods/log']}, {'verbs': ['get', 'list', 'watch', 'patch'], 'apiGroups': [''], 'resources': ['namespaces', 'pods', 'replicationcontrollers', 'services']}, {'verbs': ['create', 'post'], 'apiGroups': [''], 'resources': ['pods/portforward']}, {'verbs': ['get', 'list', 'watch', 'patch'], 'apiGroups': ['extensions', 'apps'], 'resources': ['daemonsets', 'deployments', 'replicasets', 'statefulsets']}, {'verbs': ['get', 'list', 'watch', 'patch'], 'apiGroups': ['batch'], 'resources': ['cronjobs', 'jobs']}, {'verbs': ['get', 'list', 'watch', 'create', 'delete', 'patch'], 'apiGroups': ['networking.istio.io', 'security.istio.io', 'extensions.istio.io', 'telemetry.istio.io', 'gateway.networking.k8s.io'], 'resources': ['*']}, {'verbs': ['create'], 'apiGroups': ['authentication.k8s.io'], 'resources': ['tokenreviews']}]}], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'istio-system', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['istio-system', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "istio-system",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "istio-system",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [[0m
[32m            {[0m
[32m                "apiVersion": "rbac.authorization.k8s.io/v1",[0m
[32m                "kind": "Role",[0m
[32m                "metadata": {[0m
[32m                    "annotations": {[0m
[32m                        "operator-sdk/primary-resource": "kiali-operator/kiali",[0m
[32m                        "operator-sdk/primary-resource-type": "Kiali.kiali.io"[0m
[32m                    },[0m
[32m                    "creationTimestamp": "2023-08-17T07:22:08Z",[0m
[32m                    "labels": {[0m
[32m                        "app": "kiali",[0m
[32m                        "app.kubernetes.io/instance": "kiali",[0m
[32m                        "app.kubernetes.io/name": "kiali",[0m
[32m                        "app.kubernetes.io/part-of": "kiali",[0m
[32m                        "app.kubernetes.io/version": "master",[0m
[32m                        "version": "master"[0m
[32m                    },[0m
[32m                    "managedFields": [[0m
[32m                        {[0m
[32m                            "apiVersion": "rbac.authorization.k8s.io/v1",[0m
[32m                            "fieldsType": "FieldsV1",[0m
[32m                            "fieldsV1": {[0m
[32m                                "f:metadata": {[0m
[32m                                    "f:annotations": {[0m
[32m                                        ".": {},[0m
[32m                                        "f:operator-sdk/primary-resource": {},[0m
[32m                                        "f:operator-sdk/primary-resource-type": {}[0m
[32m                                    },[0m
[32m                                    "f:labels": {[0m
[32m                                        ".": {},[0m
[32m                                        "f:app": {},[0m
[32m                                        "f:app.kubernetes.io/instance": {},[0m
[32m                                        "f:app.kubernetes.io/name": {},[0m
[32m                                        "f:app.kubernetes.io/part-of": {},[0m
[32m                                        "f:app.kubernetes.io/version": {},[0m
[32m                                        "f:version": {}[0m
[32m                                    }[0m
[32m                                },[0m
[32m                                "f:rules": {}[0m
[32m                            },[0m
[32m                            "manager": "OpenAPI-Generator",[0m
[32m                            "operation": "Update",[0m
[32m                            "time": "2023-08-17T07:22:08Z"[0m
[32m                        }[0m
[32m                    ],[0m
[32m                    "name": "kiali",[0m
[32m                    "namespace": "istio-system",[0m
[32m                    "resourceVersion": "4633",[0m
[32m                    "uid": "d5dacb9a-da01-43e7-9864-4a74526757cf"[0m
[32m                },[0m
[32m                "rules": [[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            ""[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "configmaps",[0m
[32m                            "endpoints",[0m
[32m                            "pods/log"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "get",[0m
[32m                            "list",[0m
[32m                            "watch"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            ""[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "namespaces",[0m
[32m                            "pods",[0m
[32m                            "replicationcontrollers",[0m
[32m                            "services"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "get",[0m
[32m                            "list",[0m
[32m                            "watch",[0m
[32m                            "patch"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            ""[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "pods/portforward"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "create",[0m
[32m                            "post"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            "extensions",[0m
[32m                            "apps"[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "daemonsets",[0m
[32m                            "deployments",[0m
[32m                            "replicasets",[0m
[32m                            "statefulsets"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "get",[0m
[32m                            "list",[0m
[32m                            "watch",[0m
[32m                            "patch"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            "batch"[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "cronjobs",[0m
[32m                            "jobs"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "get",[0m
[32m                            "list",[0m
[32m                            "watch",[0m
[32m                            "patch"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            "networking.istio.io",[0m
[32m                            "security.istio.io",[0m
[32m                            "extensions.istio.io",[0m
[32m                            "telemetry.istio.io",[0m
[32m                            "gateway.networking.k8s.io"[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "*"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "get",[0m
[32m                            "list",[0m
[32m                            "watch",[0m
[32m                            "create",[0m
[32m                            "delete",[0m
[32m                            "patch"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            "authentication.k8s.io"[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "tokenreviews"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "create"[0m
[32m                        ][0m
[32m                    }[0m
[32m                ][0m
[32m            }[0m
[32m        ][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [{'kind': 'Role', 'apiVersion': 'rbac.authorization.k8s.io/v1', 'metadata': {'name': 'kiali', 'namespace': 'cluster-wide-access-test-1', 'uid': '9ba454b8-a245-4c65-8a91-c796c7187b1d', 'resourceVersion': '4639', 'creationTimestamp': '2023-08-17T07:22:10Z', 'labels': {'app': 'kiali', 'app.kubernetes.io/instance': 'kiali', 'app.kubernetes.io/name': 'kiali', 'app.kubernetes.io/part-of': 'kiali', 'app.kubernetes.io/version': 'master', 'version': 'master'}, 'annotations': {'operator-sdk/primary-resource': 'kiali-operator/kiali', 'operator-sdk/primary-resource-type': 'Kiali.kiali.io'}, 'managedFields': [{'manager': 'OpenAPI-Generator', 'operation': 'Update', 'apiVersion': 'rbac.authorization.k8s.io/v1', 'time': '2023-08-17T07:22:10Z', 'fieldsType': 'FieldsV1', 'fieldsV1': {'f:metadata': {'f:annotations': {'.': {}, 'f:operator-sdk/primary-resource': {}, 'f:operator-sdk/primary-resource-type': {}}, 'f:labels': {'.': {}, 'f:app': {}, 'f:app.kubernetes.io/instance': {}, 'f:app.kubernetes.io/name': {}, 'f:app.kubernetes.io/part-of': {}, 'f:app.kubernetes.io/version': {}, 'f:version': {}}}, 'f:rules': {}}}]}, 'rules': [{'verbs': ['get', 'list', 'watch'], 'apiGroups': [''], 'resources': ['configmaps', 'endpoints', 'pods/log']}, {'verbs': ['get', 'list', 'watch', 'patch'], 'apiGroups': [''], 'resources': ['namespaces', 'pods', 'replicationcontrollers', 'services']}, {'verbs': ['create', 'post'], 'apiGroups': [''], 'resources': ['pods/portforward']}, {'verbs': ['get', 'list', 'watch', 'patch'], 'apiGroups': ['extensions', 'apps'], 'resources': ['daemonsets', 'deployments', 'replicasets', 'statefulsets']}, {'verbs': ['get', 'list', 'watch', 'patch'], 'apiGroups': ['batch'], 'resources': ['cronjobs', 'jobs']}, {'verbs': ['get', 'list', 'watch', 'create', 'delete', 'patch'], 'apiGroups': ['networking.istio.io', 'security.istio.io', 'extensions.istio.io', 'telemetry.istio.io', 'gateway.networking.k8s.io'], 'resources': ['*']}, {'verbs': ['create'], 'apiGroups': ['authentication.k8s.io'], 'resources': ['tokenreviews']}]}], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'cluster-wide-access-test-1', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-1', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "cluster-wide-access-test-1",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-1",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [[0m
[32m            {[0m
[32m                "apiVersion": "rbac.authorization.k8s.io/v1",[0m
[32m                "kind": "Role",[0m
[32m                "metadata": {[0m
[32m                    "annotations": {[0m
[32m                        "operator-sdk/primary-resource": "kiali-operator/kiali",[0m
[32m                        "operator-sdk/primary-resource-type": "Kiali.kiali.io"[0m
[32m                    },[0m
[32m                    "creationTimestamp": "2023-08-17T07:22:10Z",[0m
[32m                    "labels": {[0m
[32m                        "app": "kiali",[0m
[32m                        "app.kubernetes.io/instance": "kiali",[0m
[32m                        "app.kubernetes.io/name": "kiali",[0m
[32m                        "app.kubernetes.io/part-of": "kiali",[0m
[32m                        "app.kubernetes.io/version": "master",[0m
[32m                        "version": "master"[0m
[32m                    },[0m
[32m                    "managedFields": [[0m
[32m                        {[0m
[32m                            "apiVersion": "rbac.authorization.k8s.io/v1",[0m
[32m                            "fieldsType": "FieldsV1",[0m
[32m                            "fieldsV1": {[0m
[32m                                "f:metadata": {[0m
[32m                                    "f:annotations": {[0m
[32m                                        ".": {},[0m
[32m                                        "f:operator-sdk/primary-resource": {},[0m
[32m                                        "f:operator-sdk/primary-resource-type": {}[0m
[32m                                    },[0m
[32m                                    "f:labels": {[0m
[32m                                        ".": {},[0m
[32m                                        "f:app": {},[0m
[32m                                        "f:app.kubernetes.io/instance": {},[0m
[32m                                        "f:app.kubernetes.io/name": {},[0m
[32m                                        "f:app.kubernetes.io/part-of": {},[0m
[32m                                        "f:app.kubernetes.io/version": {},[0m
[32m                                        "f:version": {}[0m
[32m                                    }[0m
[32m                                },[0m
[32m                                "f:rules": {}[0m
[32m                            },[0m
[32m                            "manager": "OpenAPI-Generator",[0m
[32m                            "operation": "Update",[0m
[32m                            "time": "2023-08-17T07:22:10Z"[0m
[32m                        }[0m
[32m                    ],[0m
[32m                    "name": "kiali",[0m
[32m                    "namespace": "cluster-wide-access-test-1",[0m
[32m                    "resourceVersion": "4639",[0m
[32m                    "uid": "9ba454b8-a245-4c65-8a91-c796c7187b1d"[0m
[32m                },[0m
[32m                "rules": [[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            ""[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "configmaps",[0m
[32m                            "endpoints",[0m
[32m                            "pods/log"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "get",[0m
[32m                            "list",[0m
[32m                            "watch"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            ""[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "namespaces",[0m
[32m                            "pods",[0m
[32m                            "replicationcontrollers",[0m
[32m                            "services"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "get",[0m
[32m                            "list",[0m
[32m                            "watch",[0m
[32m                            "patch"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            ""[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "pods/portforward"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "create",[0m
[32m                            "post"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            "extensions",[0m
[32m                            "apps"[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "daemonsets",[0m
[32m                            "deployments",[0m
[32m                            "replicasets",[0m
[32m                            "statefulsets"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "get",[0m
[32m                            "list",[0m
[32m                            "watch",[0m
[32m                            "patch"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            "batch"[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "cronjobs",[0m
[32m                            "jobs"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "get",[0m
[32m                            "list",[0m
[32m                            "watch",[0m
[32m                            "patch"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            "networking.istio.io",[0m
[32m                            "security.istio.io",[0m
[32m                            "extensions.istio.io",[0m
[32m                            "telemetry.istio.io",[0m
[32m                            "gateway.networking.k8s.io"[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "*"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "get",[0m
[32m                            "list",[0m
[32m                            "watch",[0m
[32m                            "create",[0m
[32m                            "delete",[0m
[32m                            "patch"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            "authentication.k8s.io"[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "tokenreviews"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "create"[0m
[32m                        ][0m
[32m                    }[0m
[32m                ][0m
[32m            }[0m
[32m        ][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [{'kind': 'Role', 'apiVersion': 'rbac.authorization.k8s.io/v1', 'metadata': {'name': 'kiali', 'namespace': 'cluster-wide-access-test-2', 'uid': 'a2723a4f-6b92-47dd-8299-f32dd2c1ecbc', 'resourceVersion': '4640', 'creationTimestamp': '2023-08-17T07:22:10Z', 'labels': {'app': 'kiali', 'app.kubernetes.io/instance': 'kiali', 'app.kubernetes.io/name': 'kiali', 'app.kubernetes.io/part-of': 'kiali', 'app.kubernetes.io/version': 'master', 'version': 'master'}, 'annotations': {'operator-sdk/primary-resource': 'kiali-operator/kiali', 'operator-sdk/primary-resource-type': 'Kiali.kiali.io'}, 'managedFields': [{'manager': 'OpenAPI-Generator', 'operation': 'Update', 'apiVersion': 'rbac.authorization.k8s.io/v1', 'time': '2023-08-17T07:22:10Z', 'fieldsType': 'FieldsV1', 'fieldsV1': {'f:metadata': {'f:annotations': {'.': {}, 'f:operator-sdk/primary-resource': {}, 'f:operator-sdk/primary-resource-type': {}}, 'f:labels': {'.': {}, 'f:app': {}, 'f:app.kubernetes.io/instance': {}, 'f:app.kubernetes.io/name': {}, 'f:app.kubernetes.io/part-of': {}, 'f:app.kubernetes.io/version': {}, 'f:version': {}}}, 'f:rules': {}}}]}, 'rules': [{'verbs': ['get', 'list', 'watch'], 'apiGroups': [''], 'resources': ['configmaps', 'endpoints', 'pods/log']}, {'verbs': ['get', 'list', 'watch', 'patch'], 'apiGroups': [''], 'resources': ['namespaces', 'pods', 'replicationcontrollers', 'services']}, {'verbs': ['create', 'post'], 'apiGroups': [''], 'resources': ['pods/portforward']}, {'verbs': ['get', 'list', 'watch', 'patch'], 'apiGroups': ['extensions', 'apps'], 'resources': ['daemonsets', 'deployments', 'replicasets', 'statefulsets']}, {'verbs': ['get', 'list', 'watch', 'patch'], 'apiGroups': ['batch'], 'resources': ['cronjobs', 'jobs']}, {'verbs': ['get', 'list', 'watch', 'create', 'delete', 'patch'], 'apiGroups': ['networking.istio.io', 'security.istio.io', 'extensions.istio.io', 'telemetry.istio.io', 'gateway.networking.k8s.io'], 'resources': ['*']}, {'verbs': ['create'], 'apiGroups': ['authentication.k8s.io'], 'resources': ['tokenreviews']}]}], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'cluster-wide-access-test-2', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-2', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "cluster-wide-access-test-2",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-2",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [[0m
[32m            {[0m
[32m                "apiVersion": "rbac.authorization.k8s.io/v1",[0m
[32m                "kind": "Role",[0m
[32m                "metadata": {[0m
[32m                    "annotations": {[0m
[32m                        "operator-sdk/primary-resource": "kiali-operator/kiali",[0m
[32m                        "operator-sdk/primary-resource-type": "Kiali.kiali.io"[0m
[32m                    },[0m
[32m                    "creationTimestamp": "2023-08-17T07:22:10Z",[0m
[32m                    "labels": {[0m
[32m                        "app": "kiali",[0m
[32m                        "app.kubernetes.io/instance": "kiali",[0m
[32m                        "app.kubernetes.io/name": "kiali",[0m
[32m                        "app.kubernetes.io/part-of": "kiali",[0m
[32m                        "app.kubernetes.io/version": "master",[0m
[32m                        "version": "master"[0m
[32m                    },[0m
[32m                    "managedFields": [[0m
[32m                        {[0m
[32m                            "apiVersion": "rbac.authorization.k8s.io/v1",[0m
[32m                            "fieldsType": "FieldsV1",[0m
[32m                            "fieldsV1": {[0m
[32m                                "f:metadata": {[0m
[32m                                    "f:annotations": {[0m
[32m                                        ".": {},[0m
[32m                                        "f:operator-sdk/primary-resource": {},[0m
[32m                                        "f:operator-sdk/primary-resource-type": {}[0m
[32m                                    },[0m
[32m                                    "f:labels": {[0m
[32m                                        ".": {},[0m
[32m                                        "f:app": {},[0m
[32m                                        "f:app.kubernetes.io/instance": {},[0m
[32m                                        "f:app.kubernetes.io/name": {},[0m
[32m                                        "f:app.kubernetes.io/part-of": {},[0m
[32m                                        "f:app.kubernetes.io/version": {},[0m
[32m                                        "f:version": {}[0m
[32m                                    }[0m
[32m                                },[0m
[32m                                "f:rules": {}[0m
[32m                            },[0m
[32m                            "manager": "OpenAPI-Generator",[0m
[32m                            "operation": "Update",[0m
[32m                            "time": "2023-08-17T07:22:10Z"[0m
[32m                        }[0m
[32m                    ],[0m
[32m                    "name": "kiali",[0m
[32m                    "namespace": "cluster-wide-access-test-2",[0m
[32m                    "resourceVersion": "4640",[0m
[32m                    "uid": "a2723a4f-6b92-47dd-8299-f32dd2c1ecbc"[0m
[32m                },[0m
[32m                "rules": [[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            ""[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "configmaps",[0m
[32m                            "endpoints",[0m
[32m                            "pods/log"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "get",[0m
[32m                            "list",[0m
[32m                            "watch"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            ""[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "namespaces",[0m
[32m                            "pods",[0m
[32m                            "replicationcontrollers",[0m
[32m                            "services"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "get",[0m
[32m                            "list",[0m
[32m                            "watch",[0m
[32m                            "patch"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            ""[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "pods/portforward"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "create",[0m
[32m                            "post"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            "extensions",[0m
[32m                            "apps"[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "daemonsets",[0m
[32m                            "deployments",[0m
[32m                            "replicasets",[0m
[32m                            "statefulsets"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "get",[0m
[32m                            "list",[0m
[32m                            "watch",[0m
[32m                            "patch"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            "batch"[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "cronjobs",[0m
[32m                            "jobs"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "get",[0m
[32m                            "list",[0m
[32m                            "watch",[0m
[32m                            "patch"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            "networking.istio.io",[0m
[32m                            "security.istio.io",[0m
[32m                            "extensions.istio.io",[0m
[32m                            "telemetry.istio.io",[0m
[32m                            "gateway.networking.k8s.io"[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "*"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "get",[0m
[32m                            "list",[0m
[32m                            "watch",[0m
[32m                            "create",[0m
[32m                            "delete",[0m
[32m                            "patch"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            "authentication.k8s.io"[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "tokenreviews"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "create"[0m
[32m                        ][0m
[32m                    }[0m
[32m                ][0m
[32m            }[0m
[32m        ][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [{'kind': 'Role', 'apiVersion': 'rbac.authorization.k8s.io/v1', 'metadata': {'name': 'kiali', 'namespace': 'cluster-wide-access-test-x', 'uid': '26e1ab25-d250-46c3-b573-686e371ce124', 'resourceVersion': '4641', 'creationTimestamp': '2023-08-17T07:22:10Z', 'labels': {'app': 'kiali', 'app.kubernetes.io/instance': 'kiali', 'app.kubernetes.io/name': 'kiali', 'app.kubernetes.io/part-of': 'kiali', 'app.kubernetes.io/version': 'master', 'version': 'master'}, 'annotations': {'operator-sdk/primary-resource': 'kiali-operator/kiali', 'operator-sdk/primary-resource-type': 'Kiali.kiali.io'}, 'managedFields': [{'manager': 'OpenAPI-Generator', 'operation': 'Update', 'apiVersion': 'rbac.authorization.k8s.io/v1', 'time': '2023-08-17T07:22:10Z', 'fieldsType': 'FieldsV1', 'fieldsV1': {'f:metadata': {'f:annotations': {'.': {}, 'f:operator-sdk/primary-resource': {}, 'f:operator-sdk/primary-resource-type': {}}, 'f:labels': {'.': {}, 'f:app': {}, 'f:app.kubernetes.io/instance': {}, 'f:app.kubernetes.io/name': {}, 'f:app.kubernetes.io/part-of': {}, 'f:app.kubernetes.io/version': {}, 'f:version': {}}}, 'f:rules': {}}}]}, 'rules': [{'verbs': ['get', 'list', 'watch'], 'apiGroups': [''], 'resources': ['configmaps', 'endpoints', 'pods/log']}, {'verbs': ['get', 'list', 'watch', 'patch'], 'apiGroups': [''], 'resources': ['namespaces', 'pods', 'replicationcontrollers', 'services']}, {'verbs': ['create', 'post'], 'apiGroups': [''], 'resources': ['pods/portforward']}, {'verbs': ['get', 'list', 'watch', 'patch'], 'apiGroups': ['extensions', 'apps'], 'resources': ['daemonsets', 'deployments', 'replicasets', 'statefulsets']}, {'verbs': ['get', 'list', 'watch', 'patch'], 'apiGroups': ['batch'], 'resources': ['cronjobs', 'jobs']}, {'verbs': ['get', 'list', 'watch', 'create', 'delete', 'patch'], 'apiGroups': ['networking.istio.io', 'security.istio.io', 'extensions.istio.io', 'telemetry.istio.io', 'gateway.networking.k8s.io'], 'resources': ['*']}, {'verbs': ['create'], 'apiGroups': ['authentication.k8s.io'], 'resources': ['tokenreviews']}]}], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'cluster-wide-access-test-x', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-x', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "cluster-wide-access-test-x",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-x",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [[0m
[32m            {[0m
[32m                "apiVersion": "rbac.authorization.k8s.io/v1",[0m
[32m                "kind": "Role",[0m
[32m                "metadata": {[0m
[32m                    "annotations": {[0m
[32m                        "operator-sdk/primary-resource": "kiali-operator/kiali",[0m
[32m                        "operator-sdk/primary-resource-type": "Kiali.kiali.io"[0m
[32m                    },[0m
[32m                    "creationTimestamp": "2023-08-17T07:22:10Z",[0m
[32m                    "labels": {[0m
[32m                        "app": "kiali",[0m
[32m                        "app.kubernetes.io/instance": "kiali",[0m
[32m                        "app.kubernetes.io/name": "kiali",[0m
[32m                        "app.kubernetes.io/part-of": "kiali",[0m
[32m                        "app.kubernetes.io/version": "master",[0m
[32m                        "version": "master"[0m
[32m                    },[0m
[32m                    "managedFields": [[0m
[32m                        {[0m
[32m                            "apiVersion": "rbac.authorization.k8s.io/v1",[0m
[32m                            "fieldsType": "FieldsV1",[0m
[32m                            "fieldsV1": {[0m
[32m                                "f:metadata": {[0m
[32m                                    "f:annotations": {[0m
[32m                                        ".": {},[0m
[32m                                        "f:operator-sdk/primary-resource": {},[0m
[32m                                        "f:operator-sdk/primary-resource-type": {}[0m
[32m                                    },[0m
[32m                                    "f:labels": {[0m
[32m                                        ".": {},[0m
[32m                                        "f:app": {},[0m
[32m                                        "f:app.kubernetes.io/instance": {},[0m
[32m                                        "f:app.kubernetes.io/name": {},[0m
[32m                                        "f:app.kubernetes.io/part-of": {},[0m
[32m                                        "f:app.kubernetes.io/version": {},[0m
[32m                                        "f:version": {}[0m
[32m                                    }[0m
[32m                                },[0m
[32m                                "f:rules": {}[0m
[32m                            },[0m
[32m                            "manager": "OpenAPI-Generator",[0m
[32m                            "operation": "Update",[0m
[32m                            "time": "2023-08-17T07:22:10Z"[0m
[32m                        }[0m
[32m                    ],[0m
[32m                    "name": "kiali",[0m
[32m                    "namespace": "cluster-wide-access-test-x",[0m
[32m                    "resourceVersion": "4641",[0m
[32m                    "uid": "26e1ab25-d250-46c3-b573-686e371ce124"[0m
[32m                },[0m
[32m                "rules": [[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            ""[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "configmaps",[0m
[32m                            "endpoints",[0m
[32m                            "pods/log"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "get",[0m
[32m                            "list",[0m
[32m                            "watch"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            ""[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "namespaces",[0m
[32m                            "pods",[0m
[32m                            "replicationcontrollers",[0m
[32m                            "services"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "get",[0m
[32m                            "list",[0m
[32m                            "watch",[0m
[32m                            "patch"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            ""[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "pods/portforward"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "create",[0m
[32m                            "post"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            "extensions",[0m
[32m                            "apps"[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "daemonsets",[0m
[32m                            "deployments",[0m
[32m                            "replicasets",[0m
[32m                            "statefulsets"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "get",[0m
[32m                            "list",[0m
[32m                            "watch",[0m
[32m                            "patch"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            "batch"[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "cronjobs",[0m
[32m                            "jobs"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "get",[0m
[32m                            "list",[0m
[32m                            "watch",[0m
[32m                            "patch"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            "networking.istio.io",[0m
[32m                            "security.istio.io",[0m
[32m                            "extensions.istio.io",[0m
[32m                            "telemetry.istio.io",[0m
[32m                            "gateway.networking.k8s.io"[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "*"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "get",[0m
[32m                            "list",[0m
[32m                            "watch",[0m
[32m                            "create",[0m
[32m                            "delete",[0m
[32m                            "patch"[0m
[32m                        ][0m
[32m                    },[0m
[32m                    {[0m
[32m                        "apiGroups": [[0m
[32m                            "authentication.k8s.io"[0m
[32m                        ],[0m
[32m                        "resources": [[0m
[32m                            "tokenreviews"[0m
[32m                        ],[0m
[32m                        "verbs": [[0m
[32m                            "create"[0m
[32m                        ][0m
[32m                    }[0m
[32m                ][0m
[32m            }[0m
[32m        ][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Get role binding] ********************************************************
[32mok: [localhost] => (item=['istio-system', 'kiali'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-1', 'kiali'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-2', 'kiali'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-x', 'kiali'])[0m

TASK [Assert the role binding provides the read-write role] ********************
[32mok: [localhost] => (item={'changed': False, 'resources': [{'kind': 'RoleBinding', 'apiVersion': 'rbac.authorization.k8s.io/v1', 'metadata': {'name': 'kiali', 'namespace': 'istio-system', 'uid': 'e35e71eb-aa76-4c1d-9720-c4af509fb802', 'resourceVersion': '4634', 'creationTimestamp': '2023-08-17T07:22:08Z', 'labels': {'app': 'kiali', 'app.kubernetes.io/instance': 'kiali', 'app.kubernetes.io/name': 'kiali', 'app.kubernetes.io/part-of': 'kiali', 'app.kubernetes.io/version': 'master', 'version': 'master'}, 'annotations': {'operator-sdk/primary-resource': 'kiali-operator/kiali', 'operator-sdk/primary-resource-type': 'Kiali.kiali.io'}, 'managedFields': [{'manager': 'OpenAPI-Generator', 'operation': 'Update', 'apiVersion': 'rbac.authorization.k8s.io/v1', 'time': '2023-08-17T07:22:08Z', 'fieldsType': 'FieldsV1', 'fieldsV1': {'f:metadata': {'f:annotations': {'.': {}, 'f:operator-sdk/primary-resource': {}, 'f:operator-sdk/primary-resource-type': {}}, 'f:labels': {'.': {}, 'f:app': {}, 'f:app.kubernetes.io/instance': {}, 'f:app.kubernetes.io/name': {}, 'f:app.kubernetes.io/part-of': {}, 'f:app.kubernetes.io/version': {}, 'f:version': {}}}, 'f:roleRef': {}, 'f:subjects': {}}}]}, 'subjects': [{'kind': 'ServiceAccount', 'name': 'kiali-service-account', 'namespace': 'istio-system'}], 'roleRef': {'apiGroup': 'rbac.authorization.k8s.io', 'kind': 'Role', 'name': 'kiali'}}], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'RoleBinding', 'namespace': 'istio-system', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['istio-system', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "RoleBinding",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "istio-system",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "istio-system",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [[0m
[32m            {[0m
[32m                "apiVersion": "rbac.authorization.k8s.io/v1",[0m
[32m                "kind": "RoleBinding",[0m
[32m                "metadata": {[0m
[32m                    "annotations": {[0m
[32m                        "operator-sdk/primary-resource": "kiali-operator/kiali",[0m
[32m                        "operator-sdk/primary-resource-type": "Kiali.kiali.io"[0m
[32m                    },[0m
[32m                    "creationTimestamp": "2023-08-17T07:22:08Z",[0m
[32m                    "labels": {[0m
[32m                        "app": "kiali",[0m
[32m                        "app.kubernetes.io/instance": "kiali",[0m
[32m                        "app.kubernetes.io/name": "kiali",[0m
[32m                        "app.kubernetes.io/part-of": "kiali",[0m
[32m                        "app.kubernetes.io/version": "master",[0m
[32m                        "version": "master"[0m
[32m                    },[0m
[32m                    "managedFields": [[0m
[32m                        {[0m
[32m                            "apiVersion": "rbac.authorization.k8s.io/v1",[0m
[32m                            "fieldsType": "FieldsV1",[0m
[32m                            "fieldsV1": {[0m
[32m                                "f:metadata": {[0m
[32m                                    "f:annotations": {[0m
[32m                                        ".": {},[0m
[32m                                        "f:operator-sdk/primary-resource": {},[0m
[32m                                        "f:operator-sdk/primary-resource-type": {}[0m
[32m                                    },[0m
[32m                                    "f:labels": {[0m
[32m                                        ".": {},[0m
[32m                                        "f:app": {},[0m
[32m                                        "f:app.kubernetes.io/instance": {},[0m
[32m                                        "f:app.kubernetes.io/name": {},[0m
[32m                                        "f:app.kubernetes.io/part-of": {},[0m
[32m                                        "f:app.kubernetes.io/version": {},[0m
[32m                                        "f:version": {}[0m
[32m                                    }[0m
[32m                                },[0m
[32m                                "f:roleRef": {},[0m
[32m                                "f:subjects": {}[0m
[32m                            },[0m
[32m                            "manager": "OpenAPI-Generator",[0m
[32m                            "operation": "Update",[0m
[32m                            "time": "2023-08-17T07:22:08Z"[0m
[32m                        }[0m
[32m                    ],[0m
[32m                    "name": "kiali",[0m
[32m                    "namespace": "istio-system",[0m
[32m                    "resourceVersion": "4634",[0m
[32m                    "uid": "e35e71eb-aa76-4c1d-9720-c4af509fb802"[0m
[32m                },[0m
[32m                "roleRef": {[0m
[32m                    "apiGroup": "rbac.authorization.k8s.io",[0m
[32m                    "kind": "Role",[0m
[32m                    "name": "kiali"[0m
[32m                },[0m
[32m                "subjects": [[0m
[32m                    {[0m
[32m                        "kind": "ServiceAccount",[0m
[32m                        "name": "kiali-service-account",[0m
[32m                        "namespace": "istio-system"[0m
[32m                    }[0m
[32m                ][0m
[32m            }[0m
[32m        ][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [{'kind': 'RoleBinding', 'apiVersion': 'rbac.authorization.k8s.io/v1', 'metadata': {'name': 'kiali', 'namespace': 'cluster-wide-access-test-1', 'uid': 'e78f13d0-caea-46f5-babe-bafc45ed1e38', 'resourceVersion': '4642', 'creationTimestamp': '2023-08-17T07:22:10Z', 'labels': {'app': 'kiali', 'app.kubernetes.io/instance': 'kiali', 'app.kubernetes.io/name': 'kiali', 'app.kubernetes.io/part-of': 'kiali', 'app.kubernetes.io/version': 'master', 'version': 'master'}, 'annotations': {'operator-sdk/primary-resource': 'kiali-operator/kiali', 'operator-sdk/primary-resource-type': 'Kiali.kiali.io'}, 'managedFields': [{'manager': 'OpenAPI-Generator', 'operation': 'Update', 'apiVersion': 'rbac.authorization.k8s.io/v1', 'time': '2023-08-17T07:22:10Z', 'fieldsType': 'FieldsV1', 'fieldsV1': {'f:metadata': {'f:annotations': {'.': {}, 'f:operator-sdk/primary-resource': {}, 'f:operator-sdk/primary-resource-type': {}}, 'f:labels': {'.': {}, 'f:app': {}, 'f:app.kubernetes.io/instance': {}, 'f:app.kubernetes.io/name': {}, 'f:app.kubernetes.io/part-of': {}, 'f:app.kubernetes.io/version': {}, 'f:version': {}}}, 'f:roleRef': {}, 'f:subjects': {}}}]}, 'subjects': [{'kind': 'ServiceAccount', 'name': 'kiali-service-account', 'namespace': 'istio-system'}], 'roleRef': {'apiGroup': 'rbac.authorization.k8s.io', 'kind': 'Role', 'name': 'kiali'}}], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'RoleBinding', 'namespace': 'cluster-wide-access-test-1', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-1', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "RoleBinding",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "cluster-wide-access-test-1",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-1",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [[0m
[32m            {[0m
[32m                "apiVersion": "rbac.authorization.k8s.io/v1",[0m
[32m                "kind": "RoleBinding",[0m
[32m                "metadata": {[0m
[32m                    "annotations": {[0m
[32m                        "operator-sdk/primary-resource": "kiali-operator/kiali",[0m
[32m                        "operator-sdk/primary-resource-type": "Kiali.kiali.io"[0m
[32m                    },[0m
[32m                    "creationTimestamp": "2023-08-17T07:22:10Z",[0m
[32m                    "labels": {[0m
[32m                        "app": "kiali",[0m
[32m                        "app.kubernetes.io/instance": "kiali",[0m
[32m                        "app.kubernetes.io/name": "kiali",[0m
[32m                        "app.kubernetes.io/part-of": "kiali",[0m
[32m                        "app.kubernetes.io/version": "master",[0m
[32m                        "version": "master"[0m
[32m                    },[0m
[32m                    "managedFields": [[0m
[32m                        {[0m
[32m                            "apiVersion": "rbac.authorization.k8s.io/v1",[0m
[32m                            "fieldsType": "FieldsV1",[0m
[32m                            "fieldsV1": {[0m
[32m                                "f:metadata": {[0m
[32m                                    "f:annotations": {[0m
[32m                                        ".": {},[0m
[32m                                        "f:operator-sdk/primary-resource": {},[0m
[32m                                        "f:operator-sdk/primary-resource-type": {}[0m
[32m                                    },[0m
[32m                                    "f:labels": {[0m
[32m                                        ".": {},[0m
[32m                                        "f:app": {},[0m
[32m                                        "f:app.kubernetes.io/instance": {},[0m
[32m                                        "f:app.kubernetes.io/name": {},[0m
[32m                                        "f:app.kubernetes.io/part-of": {},[0m
[32m                                        "f:app.kubernetes.io/version": {},[0m
[32m                                        "f:version": {}[0m
[32m                                    }[0m
[32m                                },[0m
[32m                                "f:roleRef": {},[0m
[32m                                "f:subjects": {}[0m
[32m                            },[0m
[32m                            "manager": "OpenAPI-Generator",[0m
[32m                            "operation": "Update",[0m
[32m                            "time": "2023-08-17T07:22:10Z"[0m
[32m                        }[0m
[32m                    ],[0m
[32m                    "name": "kiali",[0m
[32m                    "namespace": "cluster-wide-access-test-1",[0m
[32m                    "resourceVersion": "4642",[0m
[32m                    "uid": "e78f13d0-caea-46f5-babe-bafc45ed1e38"[0m
[32m                },[0m
[32m                "roleRef": {[0m
[32m                    "apiGroup": "rbac.authorization.k8s.io",[0m
[32m                    "kind": "Role",[0m
[32m                    "name": "kiali"[0m
[32m                },[0m
[32m                "subjects": [[0m
[32m                    {[0m
[32m                        "kind": "ServiceAccount",[0m
[32m                        "name": "kiali-service-account",[0m
[32m                        "namespace": "istio-system"[0m
[32m                    }[0m
[32m                ][0m
[32m            }[0m
[32m        ][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [{'kind': 'RoleBinding', 'apiVersion': 'rbac.authorization.k8s.io/v1', 'metadata': {'name': 'kiali', 'namespace': 'cluster-wide-access-test-2', 'uid': '72175225-7cb2-48ee-bf72-392a67b1e0a7', 'resourceVersion': '4643', 'creationTimestamp': '2023-08-17T07:22:10Z', 'labels': {'app': 'kiali', 'app.kubernetes.io/instance': 'kiali', 'app.kubernetes.io/name': 'kiali', 'app.kubernetes.io/part-of': 'kiali', 'app.kubernetes.io/version': 'master', 'version': 'master'}, 'annotations': {'operator-sdk/primary-resource': 'kiali-operator/kiali', 'operator-sdk/primary-resource-type': 'Kiali.kiali.io'}, 'managedFields': [{'manager': 'OpenAPI-Generator', 'operation': 'Update', 'apiVersion': 'rbac.authorization.k8s.io/v1', 'time': '2023-08-17T07:22:10Z', 'fieldsType': 'FieldsV1', 'fieldsV1': {'f:metadata': {'f:annotations': {'.': {}, 'f:operator-sdk/primary-resource': {}, 'f:operator-sdk/primary-resource-type': {}}, 'f:labels': {'.': {}, 'f:app': {}, 'f:app.kubernetes.io/instance': {}, 'f:app.kubernetes.io/name': {}, 'f:app.kubernetes.io/part-of': {}, 'f:app.kubernetes.io/version': {}, 'f:version': {}}}, 'f:roleRef': {}, 'f:subjects': {}}}]}, 'subjects': [{'kind': 'ServiceAccount', 'name': 'kiali-service-account', 'namespace': 'istio-system'}], 'roleRef': {'apiGroup': 'rbac.authorization.k8s.io', 'kind': 'Role', 'name': 'kiali'}}], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'RoleBinding', 'namespace': 'cluster-wide-access-test-2', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-2', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "RoleBinding",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "cluster-wide-access-test-2",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-2",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [[0m
[32m            {[0m
[32m                "apiVersion": "rbac.authorization.k8s.io/v1",[0m
[32m                "kind": "RoleBinding",[0m
[32m                "metadata": {[0m
[32m                    "annotations": {[0m
[32m                        "operator-sdk/primary-resource": "kiali-operator/kiali",[0m
[32m                        "operator-sdk/primary-resource-type": "Kiali.kiali.io"[0m
[32m                    },[0m
[32m                    "creationTimestamp": "2023-08-17T07:22:10Z",[0m
[32m                    "labels": {[0m
[32m                        "app": "kiali",[0m
[32m                        "app.kubernetes.io/instance": "kiali",[0m
[32m                        "app.kubernetes.io/name": "kiali",[0m
[32m                        "app.kubernetes.io/part-of": "kiali",[0m
[32m                        "app.kubernetes.io/version": "master",[0m
[32m                        "version": "master"[0m
[32m                    },[0m
[32m                    "managedFields": [[0m
[32m                        {[0m
[32m                            "apiVersion": "rbac.authorization.k8s.io/v1",[0m
[32m                            "fieldsType": "FieldsV1",[0m
[32m                            "fieldsV1": {[0m
[32m                                "f:metadata": {[0m
[32m                                    "f:annotations": {[0m
[32m                                        ".": {},[0m
[32m                                        "f:operator-sdk/primary-resource": {},[0m
[32m                                        "f:operator-sdk/primary-resource-type": {}[0m
[32m                                    },[0m
[32m                                    "f:labels": {[0m
[32m                                        ".": {},[0m
[32m                                        "f:app": {},[0m
[32m                                        "f:app.kubernetes.io/instance": {},[0m
[32m                                        "f:app.kubernetes.io/name": {},[0m
[32m                                        "f:app.kubernetes.io/part-of": {},[0m
[32m                                        "f:app.kubernetes.io/version": {},[0m
[32m                                        "f:version": {}[0m
[32m                                    }[0m
[32m                                },[0m
[32m                                "f:roleRef": {},[0m
[32m                                "f:subjects": {}[0m
[32m                            },[0m
[32m                            "manager": "OpenAPI-Generator",[0m
[32m                            "operation": "Update",[0m
[32m                            "time": "2023-08-17T07:22:10Z"[0m
[32m                        }[0m
[32m                    ],[0m
[32m                    "name": "kiali",[0m
[32m                    "namespace": "cluster-wide-access-test-2",[0m
[32m                    "resourceVersion": "4643",[0m
[32m                    "uid": "72175225-7cb2-48ee-bf72-392a67b1e0a7"[0m
[32m                },[0m
[32m                "roleRef": {[0m
[32m                    "apiGroup": "rbac.authorization.k8s.io",[0m
[32m                    "kind": "Role",[0m
[32m                    "name": "kiali"[0m
[32m                },[0m
[32m                "subjects": [[0m
[32m                    {[0m
[32m                        "kind": "ServiceAccount",[0m
[32m                        "name": "kiali-service-account",[0m
[32m                        "namespace": "istio-system"[0m
[32m                    }[0m
[32m                ][0m
[32m            }[0m
[32m        ][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [{'kind': 'RoleBinding', 'apiVersion': 'rbac.authorization.k8s.io/v1', 'metadata': {'name': 'kiali', 'namespace': 'cluster-wide-access-test-x', 'uid': 'a157d6d1-a517-4ca7-a425-07baea7ed261', 'resourceVersion': '4644', 'creationTimestamp': '2023-08-17T07:22:10Z', 'labels': {'app': 'kiali', 'app.kubernetes.io/instance': 'kiali', 'app.kubernetes.io/name': 'kiali', 'app.kubernetes.io/part-of': 'kiali', 'app.kubernetes.io/version': 'master', 'version': 'master'}, 'annotations': {'operator-sdk/primary-resource': 'kiali-operator/kiali', 'operator-sdk/primary-resource-type': 'Kiali.kiali.io'}, 'managedFields': [{'manager': 'OpenAPI-Generator', 'operation': 'Update', 'apiVersion': 'rbac.authorization.k8s.io/v1', 'time': '2023-08-17T07:22:10Z', 'fieldsType': 'FieldsV1', 'fieldsV1': {'f:metadata': {'f:annotations': {'.': {}, 'f:operator-sdk/primary-resource': {}, 'f:operator-sdk/primary-resource-type': {}}, 'f:labels': {'.': {}, 'f:app': {}, 'f:app.kubernetes.io/instance': {}, 'f:app.kubernetes.io/name': {}, 'f:app.kubernetes.io/part-of': {}, 'f:app.kubernetes.io/version': {}, 'f:version': {}}}, 'f:roleRef': {}, 'f:subjects': {}}}]}, 'subjects': [{'kind': 'ServiceAccount', 'name': 'kiali-service-account', 'namespace': 'istio-system'}], 'roleRef': {'apiGroup': 'rbac.authorization.k8s.io', 'kind': 'Role', 'name': 'kiali'}}], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'RoleBinding', 'namespace': 'cluster-wide-access-test-x', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-x', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "RoleBinding",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "cluster-wide-access-test-x",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-x",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [[0m
[32m            {[0m
[32m                "apiVersion": "rbac.authorization.k8s.io/v1",[0m
[32m                "kind": "RoleBinding",[0m
[32m                "metadata": {[0m
[32m                    "annotations": {[0m
[32m                        "operator-sdk/primary-resource": "kiali-operator/kiali",[0m
[32m                        "operator-sdk/primary-resource-type": "Kiali.kiali.io"[0m
[32m                    },[0m
[32m                    "creationTimestamp": "2023-08-17T07:22:10Z",[0m
[32m                    "labels": {[0m
[32m                        "app": "kiali",[0m
[32m                        "app.kubernetes.io/instance": "kiali",[0m
[32m                        "app.kubernetes.io/name": "kiali",[0m
[32m                        "app.kubernetes.io/part-of": "kiali",[0m
[32m                        "app.kubernetes.io/version": "master",[0m
[32m                        "version": "master"[0m
[32m                    },[0m
[32m                    "managedFields": [[0m
[32m                        {[0m
[32m                            "apiVersion": "rbac.authorization.k8s.io/v1",[0m
[32m                            "fieldsType": "FieldsV1",[0m
[32m                            "fieldsV1": {[0m
[32m                                "f:metadata": {[0m
[32m                                    "f:annotations": {[0m
[32m                                        ".": {},[0m
[32m                                        "f:operator-sdk/primary-resource": {},[0m
[32m                                        "f:operator-sdk/primary-resource-type": {}[0m
[32m                                    },[0m
[32m                                    "f:labels": {[0m
[32m                                        ".": {},[0m
[32m                                        "f:app": {},[0m
[32m                                        "f:app.kubernetes.io/instance": {},[0m
[32m                                        "f:app.kubernetes.io/name": {},[0m
[32m                                        "f:app.kubernetes.io/part-of": {},[0m
[32m                                        "f:app.kubernetes.io/version": {},[0m
[32m                                        "f:version": {}[0m
[32m                                    }[0m
[32m                                },[0m
[32m                                "f:roleRef": {},[0m
[32m                                "f:subjects": {}[0m
[32m                            },[0m
[32m                            "manager": "OpenAPI-Generator",[0m
[32m                            "operation": "Update",[0m
[32m                            "time": "2023-08-17T07:22:10Z"[0m
[32m                        }[0m
[32m                    ],[0m
[32m                    "name": "kiali",[0m
[32m                    "namespace": "cluster-wide-access-test-x",[0m
[32m                    "resourceVersion": "4644",[0m
[32m                    "uid": "a157d6d1-a517-4ca7-a425-07baea7ed261"[0m
[32m                },[0m
[32m                "roleRef": {[0m
[32m                    "apiGroup": "rbac.authorization.k8s.io",[0m
[32m                    "kind": "Role",[0m
[32m                    "name": "kiali"[0m
[32m                },[0m
[32m                "subjects": [[0m
[32m                    {[0m
[32m                        "kind": "ServiceAccount",[0m
[32m                        "name": "kiali-service-account",[0m
[32m                        "namespace": "istio-system"[0m
[32m                    }[0m
[32m                ][0m
[32m            }[0m
[32m        ][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/asserts/roles-test/none_clusterrole_asserts.yml for localhost[0m

TASK [Get cluster roles] *******************************************************
[32mok: [localhost][0m

TASK [Get viewer cluster roles] ************************************************
[32mok: [localhost][0m

TASK [Assert that no cluster roles exist] **************************************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Assert that no viewer cluster roles exist] *******************************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Get cluster role binding] ************************************************
[32mok: [localhost][0m

TASK [Assert that no cluster role binding exists] ******************************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [debug] *******************************************************************
[32mok: [localhost] => {[0m
[32m    "msg": "put back AN=** and see that the roles have been removed and we are back to using cluster-wide-access and clusterroles"[0m
[32m}[0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/common/set_kiali_cr.yml for localhost[0m

TASK [Change Kiali CR with new Kiali CR] ***************************************
[31m--- before[0m
[32m+++ after[0m
[36m@@ -1,6 +1,6 @@[0m
 {
     "metadata": {
[31m-        "generation": 6,[0m
[32m+        "generation": 7,[0m
         "managedFields": [
             {
                 "apiVersion": "kiali.io/v1alpha1",
[36m@@ -16,42 +16,6 @@[0m
                 "manager": "ansible-operator",
                 "operation": "Update",
                 "time": "2023-08-17T07:16:19Z"
[31m-            },[0m
[31m-            {[0m
[31m-                "apiVersion": "kiali.io/v1alpha1",[0m
[31m-                "fieldsType": "FieldsV1",[0m
[31m-                "fieldsV1": {[0m
[31m-                    "f:spec": {[0m
[31m-                        ".": {},[0m
[31m-                        "f:auth": {[0m
[31m-                            ".": {},[0m
[31m-                            "f:strategy": {}[0m
[31m-                        },[0m
[31m-                        "f:deployment": {[0m
[31m-                            ".": {},[0m
[31m-                            "f:accessible_namespaces": {},[0m
[31m-                            "f:cluster_wide_access": {},[0m
[31m-                            "f:image_name": {},[0m
[31m-                            "f:image_pull_policy": {},[0m
[31m-                            "f:image_version": {},[0m
[31m-                            "f:ingress": {[0m
[31m-                                ".": {},[0m
[31m-                                "f:enabled": {}[0m
[31m-                            },[0m
[31m-                            "f:logger": {[0m
[31m-                                ".": {},[0m
[31m-                                "f:log_level": {}[0m
[31m-                            },[0m
[31m-                            "f:namespace": {},[0m
[31m-                            "f:service_type": {}[0m
[31m-                        },[0m
[31m-                        "f:istio_namespace": {},[0m
[31m-                        "f:version": {}[0m
[31m-                    }[0m
[31m-                },[0m
[31m-                "manager": "OpenAPI-Generator",[0m
[31m-                "operation": "Update",[0m
[31m-                "time": "2023-08-17T07:21:55Z"[0m
             },
             {
                 "apiVersion": "kiali.io/v1alpha1",
[36m@@ -96,16 +60,52 @@[0m
                 "operation": "Update",
                 "subresource": "status",
                 "time": "2023-08-17T07:22:12Z"
[32m+            },[0m
[32m+            {[0m
[32m+                "apiVersion": "kiali.io/v1alpha1",[0m
[32m+                "fieldsType": "FieldsV1",[0m
[32m+                "fieldsV1": {[0m
[32m+                    "f:spec": {[0m
[32m+                        ".": {},[0m
[32m+                        "f:auth": {[0m
[32m+                            ".": {},[0m
[32m+                            "f:strategy": {}[0m
[32m+                        },[0m
[32m+                        "f:deployment": {[0m
[32m+                            ".": {},[0m
[32m+                            "f:accessible_namespaces": {},[0m
[32m+                            "f:cluster_wide_access": {},[0m
[32m+                            "f:image_name": {},[0m
[32m+                            "f:image_pull_policy": {},[0m
[32m+                            "f:image_version": {},[0m
[32m+                            "f:ingress": {[0m
[32m+                                ".": {},[0m
[32m+                                "f:enabled": {}[0m
[32m+                            },[0m
[32m+                            "f:logger": {[0m
[32m+                                ".": {},[0m
[32m+                                "f:log_level": {}[0m
[32m+                            },[0m
[32m+                            "f:namespace": {},[0m
[32m+                            "f:service_type": {}[0m
[32m+                        },[0m
[32m+                        "f:istio_namespace": {},[0m
[32m+                        "f:version": {}[0m
[32m+                    }[0m
[32m+                },[0m
[32m+                "manager": "OpenAPI-Generator",[0m
[32m+                "operation": "Update",[0m
[32m+                "time": "2023-08-17T07:23:00Z"[0m
             }
         ],
[31m-        "resourceVersion": "4676"[0m
[32m+        "resourceVersion": "4783"[0m
     },
     "spec": {
         "deployment": {
             "accessible_namespaces": [
[31m-                "cluster-wide-access-test-[12x]"[0m
[32m+                "**"[0m
             ],
[31m-            "cluster_wide_access": false[0m
[32m+            "cluster_wide_access": true[0m
         }
     }
 }

[33mchanged: [localhost][0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/common/wait_for_kiali_cr_changes.yml for localhost[0m

TASK [Wait for Kiali CR changes to take effect] ********************************
[1;30mFAILED - RETRYING: [localhost]: Wait for Kiali CR changes to take effect (120 retries left).[0m
[1;30mFAILED - RETRYING: [localhost]: Wait for Kiali CR changes to take effect (119 retries left).[0m
[1;30mFAILED - RETRYING: [localhost]: Wait for Kiali CR changes to take effect (118 retries left).[0m
[32mok: [localhost][0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/common/wait_for_kiali_running.yml for localhost[0m

TASK [Asserting that Kiali Pod exists and there is only one] *******************
[32mok: [localhost][0m

TASK [Wait for Kiali to be running and accepting requests] *********************
[1;30mFAILED - RETRYING: [localhost]: Wait for Kiali to be running and accepting requests (120 retries left).[0m
[32mok: [localhost][0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/common/tasks.yml for localhost[0m

TASK [Get information about the cluster] ***************************************
[32mok: [localhost][0m

TASK [Determine the cluster type] **********************************************
[32mok: [localhost][0m

TASK [Determine the Istio implementation] **************************************
[32mok: [localhost][0m

TASK [Get SMCP if running in Maistra environment] ******************************
[36mskipping: [localhost][0m

TASK [There must one and only one SMCP already installed in the control plane] ***
[36mskipping: [localhost][0m

TASK [Get Kiali CR if present] *************************************************
[32mok: [localhost][0m

TASK [Get Kiali Operator Pod] **************************************************
[32mok: [localhost][0m

TASK [Get Kiali Pod] ***********************************************************
[32mok: [localhost][0m

TASK [Get Kiali Configmap] *****************************************************
[32mok: [localhost][0m

TASK [Format Configmap] ********************************************************
[32mok: [localhost][0m

TASK [Get Kiali Deployment] ****************************************************
[32mok: [localhost][0m

TASK [Get Kiali Service] *******************************************************
[32mok: [localhost][0m

TASK [Get Kiali Route] *********************************************************
[36mskipping: [localhost][0m

TASK [Determine the Kiali Route URL on OpenShift] ******************************
[36mskipping: [localhost][0m

TASK [Determine the Kiali Ingress URL on minikube] *****************************
[36mskipping: [localhost][0m

TASK [Determine the Kiali Ingress URL on kind] *********************************
[32mok: [localhost][0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/asserts/pod_asserts.yml for localhost[0m

TASK [Assert Kiali Pod is Running and there is only one] ***********************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Assert Kiali Pod is Running on the correct Namespace] ********************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/asserts/accessible_namespaces_contains.yml for localhost[0m

TASK [Assert Accessible Namespaces contains ['**']] ****************************
[32mok: [localhost] => (item=**) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": "**",[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [debug] *******************************************************************
[32mok: [localhost] => {[0m
[32m    "msg": "test to make sure we are back to cluster-wide-access is True"[0m
[32m}[0m

TASK [assert] ******************************************************************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/asserts/roles-test/rw_clusterrole_asserts.yml for localhost[0m

TASK [Get cluster roles] *******************************************************
[32mok: [localhost][0m

TASK [Assert that cluster roles exist] *****************************************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Get cluster role binding] ************************************************
[32mok: [localhost][0m

TASK [Assert the cluster role binding provides the read-write role] ************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [include_tasks] ***********************************************************
[36mincluded: /tmp/molecule/operator/molecule/asserts/roles-test/none_role_asserts.yml for localhost[0m

TASK [Get roles] ***************************************************************
[32mok: [localhost] => (item=['istio-system', 'kiali'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-1', 'kiali'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-2', 'kiali'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-x', 'kiali'])[0m

TASK [Assert that namespaces do not have the roles] ****************************
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'istio-system', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['istio-system', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "istio-system",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "istio-system",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'cluster-wide-access-test-1', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-1', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "cluster-wide-access-test-1",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-1",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'cluster-wide-access-test-2', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-2', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "cluster-wide-access-test-2",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-2",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'cluster-wide-access-test-x', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-x', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "cluster-wide-access-test-x",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-x",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Get viewer roles] ********************************************************
[32mok: [localhost] => (item=['istio-system', 'kiali-viewer'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-1', 'kiali-viewer'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-2', 'kiali-viewer'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-x', 'kiali-viewer'])[0m

TASK [Assert that namespaces do not have the viewer roles] *********************
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'istio-system', 'name': 'kiali-viewer', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['istio-system', 'kiali-viewer'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali-viewer",[0m
[32m                "namespace": "istio-system",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "istio-system",[0m
[32m            "kiali-viewer"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'cluster-wide-access-test-1', 'name': 'kiali-viewer', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-1', 'kiali-viewer'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali-viewer",[0m
[32m                "namespace": "cluster-wide-access-test-1",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-1",[0m
[32m            "kiali-viewer"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'cluster-wide-access-test-2', 'name': 'kiali-viewer', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-2', 'kiali-viewer'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali-viewer",[0m
[32m                "namespace": "cluster-wide-access-test-2",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-2",[0m
[32m            "kiali-viewer"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'Role', 'namespace': 'cluster-wide-access-test-x', 'name': 'kiali-viewer', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-x', 'kiali-viewer'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "Role",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali-viewer",[0m
[32m                "namespace": "cluster-wide-access-test-x",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-x",[0m
[32m            "kiali-viewer"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Get role bindings] *******************************************************
[32mok: [localhost] => (item=['istio-system', 'kiali'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-1', 'kiali'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-2', 'kiali'])[0m
[32mok: [localhost] => (item=['cluster-wide-access-test-x', 'kiali'])[0m

TASK [Assert the role bindings do not exist] ***********************************
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'RoleBinding', 'namespace': 'istio-system', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['istio-system', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "RoleBinding",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "istio-system",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "istio-system",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'RoleBinding', 'namespace': 'cluster-wide-access-test-1', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-1', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "RoleBinding",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "cluster-wide-access-test-1",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-1",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'RoleBinding', 'namespace': 'cluster-wide-access-test-2', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-2', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "RoleBinding",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "cluster-wide-access-test-2",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-2",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m
[32mok: [localhost] => (item={'changed': False, 'resources': [], 'api_found': True, 'invocation': {'module_args': {'api_version': 'rbac.authorization.k8s.io/v1', 'kind': 'RoleBinding', 'namespace': 'cluster-wide-access-test-x', 'name': 'kiali', 'wait': False, 'wait_sleep': 5, 'wait_timeout': 120, 'label_selectors': [], 'field_selectors': [], 'kubeconfig': None, 'context': None, 'host': None, 'api_key': None, 'username': None, 'password': None, 'validate_certs': None, 'ca_cert': None, 'client_cert': None, 'client_key': None, 'proxy': None, 'no_proxy': None, 'proxy_headers': None, 'persist_config': None, 'impersonate_user': None, 'impersonate_groups': None, 'wait_condition': None}}, 'failed': False, 'item': ['cluster-wide-access-test-x', 'kiali'], 'ansible_loop_var': 'item'}) => {[0m
[32m    "ansible_loop_var": "item",[0m
[32m    "changed": false,[0m
[32m    "item": {[0m
[32m        "ansible_loop_var": "item",[0m
[32m        "api_found": true,[0m
[32m        "changed": false,[0m
[32m        "failed": false,[0m
[32m        "invocation": {[0m
[32m            "module_args": {[0m
[32m                "api_key": null,[0m
[32m                "api_version": "rbac.authorization.k8s.io/v1",[0m
[32m                "ca_cert": null,[0m
[32m                "client_cert": null,[0m
[32m                "client_key": null,[0m
[32m                "context": null,[0m
[32m                "field_selectors": [],[0m
[32m                "host": null,[0m
[32m                "impersonate_groups": null,[0m
[32m                "impersonate_user": null,[0m
[32m                "kind": "RoleBinding",[0m
[32m                "kubeconfig": null,[0m
[32m                "label_selectors": [],[0m
[32m                "name": "kiali",[0m
[32m                "namespace": "cluster-wide-access-test-x",[0m
[32m                "no_proxy": null,[0m
[32m                "password": null,[0m
[32m                "persist_config": null,[0m
[32m                "proxy": null,[0m
[32m                "proxy_headers": null,[0m
[32m                "username": null,[0m
[32m                "validate_certs": null,[0m
[32m                "wait": false,[0m
[32m                "wait_condition": null,[0m
[32m                "wait_sleep": 5,[0m
[32m                "wait_timeout": 120[0m
[32m            }[0m
[32m        },[0m
[32m        "item": [[0m
[32m            "cluster-wide-access-test-x",[0m
[32m            "kiali"[0m
[32m        ],[0m
[32m        "resources": [][0m
[32m    },[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

PLAY RECAP *********************************************************************
[33mlocalhost[0m                  : [32mok=307 [0m [33mchanged=8   [0m unreachable=0    failed=0    [36mskipped=45  [0m rescued=0    ignored=0

[34mINFO    [0m [2;36mRunning [0m[2;32mcluster-wide-access-test[0m[2;36m > [0m[2;32mdestroy[0m
DEBUG: ANSIBLE ENVIRONMENT:
ANSIBLE_COLLECTIONS_PATH: [35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/[0m[95mcollections[0m:[35m/home/runner/.ansible/[0m[95mcollections[0m:[35m/usr/share/ansible/[0m[95mcollections[0m:[35m/etc/ansible/[0m[95mcollections[0m
ANSIBLE_CONFIG: [35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/[0m[95mansible.cfg[0m
ANSIBLE_FILTER_PLUGINS: [35m/usr/local/lib/python3.8/site-packages/molecule/provisioner/ansible/plugins/[0m[95mfilter[0m:[35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/plugins/[0m[95mfilter[0m:[35m/tmp/molecule/operator/plugins/[0m[95mfilter[0m:[35m/home/runner/.ansible/plugins/[0m[95mfilter[0m:[35m/usr/share/ansible/plugins/[0m[95mfilter[0m
ANSIBLE_FORCE_COLOR: [32m'1'[0m
ANSIBLE_LIBRARY: [35m/usr/local/lib/python3.8/site-packages/molecule/provisioner/ansible/plugins/[0m[95mmodules[0m:[35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/[0m[95mlibrary[0m:[35m/tmp/molecule/operator/[0m[95mlibrary[0m:[35m/home/runner/.ansible/plugins/[0m[95mmodules[0m:[35m/usr/share/ansible/plugins/[0m[95mmodules[0m
ANSIBLE_ROLES_PATH: [32m'/home/runner/.cache/molecule/operator/cluster-wide-access-test/roles:/tmp/molecule:/home/runner/.ansible/roles:/usr/share/ansible/roles:/etc/ansible/roles:'[0m

DEBUG: MOLECULE ENVIRONMENT:
MOLECULE_CLUSTER_TYPE: kind
MOLECULE_DEBUG: [32m'True'[0m
MOLECULE_DEPENDENCY_NAME: galaxy
MOLECULE_DRIVER_NAME: podman
MOLECULE_DUMP_LOGS_ON_ERROR: [32m'true'[0m
MOLECULE_ENV_FILE: [35m/tmp/molecule/operator/[0m[95m.env.yml[0m
MOLECULE_EPHEMERAL_DIRECTORY: [35m/home/runner/.cache/molecule/operator/[0m[95mcluster-wide-access-test[0m
MOLECULE_FILE: [35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/[0m[95mmolecule.yml[0m
MOLECULE_HELM_CHARTS_REPO: [35m/tmp/molecule/[0m[95mhelm-charts-repo[0m
MOLECULE_INSTANCE_CONFIG: [35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/[0m[95minstance_config.yml[0m
MOLECULE_INVENTORY_FILE: [35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/inventory/[0m[95mansible_inventory.yml[0m
MOLECULE_KIALI_CR_SPEC_VERSION: default
MOLECULE_KIND_IP: [32m''[0m
MOLECULE_OPERATOR_INSTALLER: helm
MOLECULE_OPERATOR_PROFILER_ENABLED: [32m'true'[0m
MOLECULE_PROJECT_DIRECTORY: [35m/tmp/molecule/[0m[95moperator[0m
MOLECULE_PROVISIONER_NAME: ansible
MOLECULE_SCENARIO_DIRECTORY: [35m/tmp/molecule/operator/molecule/[0m[95mcluster-wide-access-test[0m
MOLECULE_SCENARIO_NAME: cluster-wide-access-test
MOLECULE_STATE_FILE: [35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/[0m[95mstate.yml[0m
MOLECULE_VERIFIER_NAME: ansible
MOLECULE_VERIFIER_TEST_DIRECTORY: [35m/tmp/molecule/operator/molecule/cluster-wide-access-test/[0m[95mtests[0m
MOLECULE_WAIT_RETRIES: [32m'120'[0m

DEBUG: SHELL REPLAY:
[33mANSIBLE_COLLECTIONS_PATH[0m=[35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/[0m[95mcollections[0m:[35m/home/runner/.ansible/[0m[95mcollections[0m:[35m/usr/share/ansible/[0m[95mcollections[0m:[35m/etc/ansible/[0m[95mcollections[0m [33mANSIBLE_CONFIG[0m=[35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/[0m[95mansible.cfg[0m [33mANSIBLE_FILTER_PLUGINS[0m=[35m/usr/local/lib/python3.8/site-packages/molecule/provisioner/ansible/plugins/[0m[95mfilter[0m:[35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/plugins/[0m[95mfilter[0m:[35m/tmp/molecule/operator/plugins/[0m[95mfilter[0m:[35m/home/runner/.ansible/plugins/[0m[95mfilter[0m:[35m/usr/share/ansible/plugins/[0m[95mfilter[0m [33mANSIBLE_FORCE_COLOR[0m=[1;36m1[0m [33mANSIBLE_LIBRARY[0m=[35m/usr/local/lib/python3.8/site-packages/molecule/provisioner/ansible/plugins/[0m[95mmodules[0m:[35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/[0m[95mlibrary[0m:[35m/tmp/molecule/operator/[0m[95mlibrary[0m:[35m/home/runner/.ansible/plugins/[0m[95mmodules[0m:[35m/usr/share/ansible/plugins/[0m[95mmodules[0m [33mANSIBLE_ROLES_PATH[0m=[35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/[0m[95mroles[0m:[35m/tmp/[0m[95mmolecule[0m:[35m/home/runner/.ansible/[0m[95mroles[0m:[35m/usr/share/ansible/[0m[95mroles[0m:[35m/etc/ansible/[0m[95mroles[0m: [33mMOLECULE_CLUSTER_TYPE[0m=[35mkind[0m [33mMOLECULE_DEBUG[0m=[3;92mTrue[0m [33mMOLECULE_DEPENDENCY_NAME[0m=[35mgalaxy[0m [33mMOLECULE_DRIVER_NAME[0m=[35mpodman[0m [33mMOLECULE_DUMP_LOGS_ON_ERROR[0m=[35mtrue[0m [33mMOLECULE_ENV_FILE[0m=[35m/tmp/molecule/operator/[0m[95m.env.yml[0m [33mMOLECULE_EPHEMERAL_DIRECTORY[0m=[35m/home/runner/.cache/molecule/operator/[0m[95mcluster-wide-access-test[0m [33mMOLECULE_FILE[0m=[35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/[0m[95mmolecule.yml[0m [33mMOLECULE_HELM_CHARTS_REPO[0m=[35m/tmp/molecule/[0m[95mhelm-charts-repo[0m [33mMOLECULE_INSTANCE_CONFIG[0m=[35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/[0m[95minstance_config.yml[0m [33mMOLECULE_INVENTORY_FILE[0m=[35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/inventory/[0m[95mansible_inventory.yml[0m [33mMOLECULE_KIALI_CR_SPEC_VERSION[0m=[35mdefault[0m [33mMOLECULE_KIND_IP[0m= [33mMOLECULE_OPERATOR_INSTALLER[0m=[35mhelm[0m [33mMOLECULE_OPERATOR_PROFILER_ENABLED[0m=[35mtrue[0m [33mMOLECULE_PROJECT_DIRECTORY[0m=[35m/tmp/molecule/[0m[95moperator[0m [33mMOLECULE_PROVISIONER_NAME[0m=[35mansible[0m [33mMOLECULE_SCENARIO_DIRECTORY[0m=[35m/tmp/molecule/operator/molecule/[0m[95mcluster-wide-access-test[0m [33mMOLECULE_SCENARIO_NAME[0m=[35mcluster[0m-wide-access-test [33mMOLECULE_STATE_FILE[0m=[35m/home/runner/.cache/molecule/operator/cluster-wide-access-test/[0m[95mstate.yml[0m [33mMOLECULE_VERIFIER_NAME[0m=[35mansible[0m [33mMOLECULE_VERIFIER_TEST_DIRECTORY[0m=[35m/tmp/molecule/operator/molecule/cluster-wide-access-test/[0m[95mtests[0m [33mMOLECULE_WAIT_RETRIES[0m=[1;36m120[0m


PLAY [Destroy] *****************************************************************

TASK [Gathering Facts] *********************************************************
[32mok: [localhost][0m

PLAY [Destroy] *****************************************************************

TASK [Gathering Facts] *********************************************************
[32mok: [localhost][0m

TASK [Get information about the cluster] ***************************************
[32mok: [localhost][0m

TASK [Determine the cluster type] **********************************************
[32mok: [localhost][0m

TASK [Determine the Istio implementation] **************************************
[32mok: [localhost][0m

TASK [Determine if the operator installation is managed externally or not] *****
[32mok: [localhost][0m

TASK [Remove Kiali CR] *********************************************************
[33mchanged: [localhost][0m

TASK [Wait for Kiali ConfigMap to be uninstalled] ******************************
[32mok: [localhost][0m

TASK [Process NetworkPolicy needed to access the Kiali UI when in Maistra environment [state=absent]] ***
[36mskipping: [localhost][0m

TASK [Uninstall Operator via Helm] *********************************************
[33mchanged: [localhost][0m

TASK [Remove CRDs] *************************************************************
[33mchanged: [localhost][0m

TASK [Removing Operator namespace] *********************************************
[33mchanged: [localhost][0m

TASK [Removing CR namespace if it is different than control plane and operator namespace] ***
[36mskipping: [localhost][0m

PLAY [Process Test Namespaces [state=absent]] **********************************

TASK [Gathering Facts] *********************************************************
[32mok: [localhost][0m

TASK [k8s] *********************************************************************
[33mchanged: [localhost][0m

TASK [k8s] *********************************************************************
[33mchanged: [localhost][0m

TASK [k8s] *********************************************************************
[33mchanged: [localhost][0m

PLAY RECAP *********************************************************************
[33mlocalhost[0m                  : [32mok=15  [0m [33mchanged=7   [0m unreachable=0    failed=0    [36mskipped=2   [0m rescued=0    ignored=0

[34mINFO    [0m Pruning extra files from scenario ephemeral directory
podman volume rm molecule-tests-volume
molecule-tests-volume
