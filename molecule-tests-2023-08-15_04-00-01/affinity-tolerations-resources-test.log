/bin/bash: line 1: go: command not found
Pulling down latest helm-charts from remote repo to here: /tmp/KIALI-GIT-KIND/helm-charts
Git repo for the helm charts is found here: /tmp/KIALI-GIT-KIND/helm-charts
make[1]: Entering directory '/tmp/KIALI-GIT-KIND/helm-charts'
Will use this helm executable: /tmp/KIALI-GIT-KIND/helm-charts/_output/helm-install/helm
Building Helm Chart for Kiali operator
==> Linting /tmp/KIALI-GIT-KIND/helm-charts/_output/charts/kiali-operator

1 chart(s) linted, 0 chart(s) failed
Successfully packaged chart and saved it to: /tmp/KIALI-GIT-KIND/helm-charts/_output/charts/kiali-operator-1.73.0-SNAPSHOT.tgz
make[1]: Leaving directory '/tmp/KIALI-GIT-KIND/helm-charts'
Will auto-detect hosts to add based on the CLUSTER_REPO: 
Auto-detected add host args: 
Will not rebuild kiali-molecule image.
podman volume exists molecule-tests-volume && echo "Podman volume already exists; deleting it" && podman volume rm molecule-tests-volume || true
podman volume create molecule-tests-volume
molecule-tests-volume
podman create -v molecule-tests-volume:/data --name molecule-volume-helper docker.io/busybox true
442ae434fc94a90fba529bbcb6fac6f776173180b1bbfe1662cc5da2af649f2c
podman cp "/tmp/KIALI-GIT-KIND/helm-charts" molecule-volume-helper:/data/helm-charts-repo
podman cp "/tmp/KIALI-GIT-KIND/kiali/operator/" molecule-volume-helper:/data/operator
podman cp "/home/jmazzite/.kube/config" molecule-volume-helper:/data/kubeconfig
podman rm molecule-volume-helper
molecule-volume-helper
Error: no such object: "ci-control-plane"
for msn in affinity-tolerations-resources-test; do podman run --rm  --env KUBECONFIG="/tmp/molecule/kubeconfig" --env K8S_AUTH_KUBECONFIG="/tmp/molecule/kubeconfig" --env MOLECULE_CLUSTER_TYPE="kind" --env MOLECULE_HELM_CHARTS_REPO=/tmp/molecule/helm-charts-repo -v molecule-tests-volume:/tmp/molecule   --env MOLECULE_KIND_IP= -w /tmp/molecule/operator --network="host"  --add-host="api.crc.testing:192.168.130.11" --add-host="kiali-istio-system.apps-crc.testing:192.168.130.11" --add-host="prometheus-istio-system.apps-crc.testing:192.168.130.11" --env DORP=podman --env OPERATOR_IMAGE_PULL_SECRET_NAME= --env MOLECULE_KIALI_CR_SPEC_VERSION=default  --env MOLECULE_OPERATOR_PROFILER_ENABLED=true --env MOLECULE_OPERATOR_INSTALLER=helm --env MOLECULE_DUMP_LOGS_ON_ERROR=true  --env MOLECULE_WAIT_RETRIES=120 localhost/kiali-molecule:latest molecule --debug test  --scenario-name ${msn}; if [ "$?" != "0" ]; then echo "Molecule test failed: ${msn}"; podman volume rm molecule-tests-volume; exit 1; fi; done
[2;37mDEBUG   [0m Validating schema [35m/tmp/molecule/operator/molecule/affinity-tolerations-resources-test/[0m[95mmolecule.yml.[0m
[34mINFO    [0m affinity-tolerations-resources-test scenario test matrix: prepare, converge, destroy
[34mINFO    [0m Performing prerun[33m...[0m
[34mINFO    [0m Running ansible-galaxy collection install -vr requirements.yml -p [35m/home/runner/.cache/ansible-compat/06e55b/[0m[95mcollections[0m
[34mINFO    [0m Set [33mANSIBLE_LIBRARY[0m=[35m/home/runner/.cache/ansible-compat/06e55b/[0m[95mmodules[0m:[35m/home/runner/.ansible/plugins/[0m[95mmodules[0m:[35m/usr/share/ansible/plugins/[0m[95mmodules[0m
[34mINFO    [0m Set [33mANSIBLE_COLLECTIONS_PATH[0m=[35m/home/runner/.cache/ansible-compat/06e55b/[0m[95mcollections[0m:[35m/home/runner/.ansible/[0m[95mcollections[0m:[35m/usr/share/ansible/[0m[95mcollections[0m
[34mINFO    [0m Set [33mANSIBLE_ROLES_PATH[0m=[35m/home/runner/.cache/ansible-compat/06e55b/[0m[95mroles[0m:roles:[35m/home/runner/.ansible/[0m[95mroles[0m:[35m/usr/share/ansible/[0m[95mroles[0m:[35m/etc/ansible/[0m[95mroles[0m
[34mINFO    [0m [2;36mRunning [0m[2;32maffinity-tolerations-resources-test[0m[2;36m > [0m[2;32mprepare[0m
[34mINFO    [0m Sanity checks: [32m'podman'[0m
DEBUG: ANSIBLE ENVIRONMENT:
ANSIBLE_COLLECTIONS_PATH: [35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/[0m[95mcollections[0m:[35m/home/runner/.ansible/[0m[95mcollections[0m:[35m/usr/share/ansible/[0m[95mcollections[0m:[35m/etc/ansible/[0m[95mcollections[0m
ANSIBLE_CONFIG: [35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/[0m[95mansible.cfg[0m
ANSIBLE_FILTER_PLUGINS: [35m/usr/local/lib/python3.8/site-packages/molecule/provisioner/ansible/plugins/[0m[95mfilter[0m:[35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/plugins/[0m[95mfilter[0m:[35m/tmp/molecule/operator/plugins/[0m[95mfilter[0m:[35m/home/runner/.ansible/plugins/[0m[95mfilter[0m:[35m/usr/share/ansible/plugins/[0m[95mfilter[0m
ANSIBLE_FORCE_COLOR: [32m'1'[0m
ANSIBLE_LIBRARY: [35m/usr/local/lib/python3.8/site-packages/molecule/provisioner/ansible/plugins/[0m[95mmodules[0m:[35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/[0m[95mlibrary[0m:[35m/tmp/molecule/operator/[0m[95mlibrary[0m:[35m/home/runner/.ansible/plugins/[0m[95mmodules[0m:[35m/usr/share/ansible/plugins/[0m[95mmodules[0m
ANSIBLE_ROLES_PATH: [32m'/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/roles:/tmp/molecule:/home/runner/.ansible/roles:/usr/share/ansible/roles:/etc/ansible/roles:'[0m

DEBUG: MOLECULE ENVIRONMENT:
MOLECULE_CLUSTER_TYPE: kind
MOLECULE_DEBUG: [32m'True'[0m
MOLECULE_DEPENDENCY_NAME: galaxy
MOLECULE_DRIVER_NAME: podman
MOLECULE_DUMP_LOGS_ON_ERROR: [32m'true'[0m
MOLECULE_ENV_FILE: [35m/tmp/molecule/operator/[0m[95m.env.yml[0m
MOLECULE_EPHEMERAL_DIRECTORY: [35m/home/runner/.cache/molecule/operator/[0m[95maffinity-tolerations-resources-test[0m
MOLECULE_FILE: [35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/[0m[95mmolecule.yml[0m
MOLECULE_HELM_CHARTS_REPO: [35m/tmp/molecule/[0m[95mhelm-charts-repo[0m
MOLECULE_INSTANCE_CONFIG: [35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/[0m[95minstance_config.yml[0m
MOLECULE_INVENTORY_FILE: [35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/inventory/[0m[95mansible_inventory.yml[0m
MOLECULE_KIALI_CR_SPEC_VERSION: default
MOLECULE_KIND_IP: [32m''[0m
MOLECULE_OPERATOR_INSTALLER: helm
MOLECULE_OPERATOR_PROFILER_ENABLED: [32m'true'[0m
MOLECULE_PROJECT_DIRECTORY: [35m/tmp/molecule/[0m[95moperator[0m
MOLECULE_PROVISIONER_NAME: ansible
MOLECULE_SCENARIO_DIRECTORY: [35m/tmp/molecule/operator/molecule/[0m[95maffinity-tolerations-resources-test[0m
MOLECULE_SCENARIO_NAME: affinity-tolerations-resources-test
MOLECULE_STATE_FILE: [35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/[0m[95mstate.yml[0m
MOLECULE_VERIFIER_NAME: ansible
MOLECULE_VERIFIER_TEST_DIRECTORY: [35m/tmp/molecule/operator/molecule/affinity-tolerations-resources-test/[0m[95mtests[0m
MOLECULE_WAIT_RETRIES: [32m'120'[0m

DEBUG: SHELL REPLAY:
[33mANSIBLE_COLLECTIONS_PATH[0m=[35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/[0m[95mcollections[0m:[35m/home/runner/.ansible/[0m[95mcollections[0m:[35m/usr/share/ansible/[0m[95mcollections[0m:[35m/etc/ansible/[0m[95mcollections[0m [33mANSIBLE_CONFIG[0m=[35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/[0m[95mansible.cfg[0m [33mANSIBLE_FILTER_PLUGINS[0m=[35m/usr/local/lib/python3.8/site-packages/molecule/provisioner/ansible/plugins/[0m[95mfilter[0m:[35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/plugins/[0m[95mfilter[0m:[35m/tmp/molecule/operator/plugins/[0m[95mfilter[0m:[35m/home/runner/.ansible/plugins/[0m[95mfilter[0m:[35m/usr/share/ansible/plugins/[0m[95mfilter[0m [33mANSIBLE_FORCE_COLOR[0m=[1;36m1[0m [33mANSIBLE_LIBRARY[0m=[35m/usr/local/lib/python3.8/site-packages/molecule/provisioner/ansible/plugins/[0m[95mmodules[0m:[35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/[0m[95mlibrary[0m:[35m/tmp/molecule/operator/[0m[95mlibrary[0m:[35m/home/runner/.ansible/plugins/[0m[95mmodules[0m:[35m/usr/share/ansible/plugins/[0m[95mmodules[0m [33mANSIBLE_ROLES_PATH[0m=[35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/[0m[95mroles[0m:[35m/tmp/[0m[95mmolecule[0m:[35m/home/runner/.ansible/[0m[95mroles[0m:[35m/usr/share/ansible/[0m[95mroles[0m:[35m/etc/ansible/[0m[95mroles[0m: [33mMOLECULE_CLUSTER_TYPE[0m=[35mkind[0m [33mMOLECULE_DEBUG[0m=[3;92mTrue[0m [33mMOLECULE_DEPENDENCY_NAME[0m=[35mgalaxy[0m [33mMOLECULE_DRIVER_NAME[0m=[35mpodman[0m [33mMOLECULE_DUMP_LOGS_ON_ERROR[0m=[35mtrue[0m [33mMOLECULE_ENV_FILE[0m=[35m/tmp/molecule/operator/[0m[95m.env.yml[0m [33mMOLECULE_EPHEMERAL_DIRECTORY[0m=[35m/home/runner/.cache/molecule/operator/[0m[95maffinity-tolerations-resources-test[0m [33mMOLECULE_FILE[0m=[35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/[0m[95mmolecule.yml[0m [33mMOLECULE_HELM_CHARTS_REPO[0m=[35m/tmp/molecule/[0m[95mhelm-charts-repo[0m [33mMOLECULE_INSTANCE_CONFIG[0m=[35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/[0m[95minstance_config.yml[0m [33mMOLECULE_INVENTORY_FILE[0m=[35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/inventory/[0m[95mansible_inventory.yml[0m [33mMOLECULE_KIALI_CR_SPEC_VERSION[0m=[35mdefault[0m [33mMOLECULE_KIND_IP[0m= [33mMOLECULE_OPERATOR_INSTALLER[0m=[35mhelm[0m [33mMOLECULE_OPERATOR_PROFILER_ENABLED[0m=[35mtrue[0m [33mMOLECULE_PROJECT_DIRECTORY[0m=[35m/tmp/molecule/[0m[95moperator[0m [33mMOLECULE_PROVISIONER_NAME[0m=[35mansible[0m [33mMOLECULE_SCENARIO_DIRECTORY[0m=[35m/tmp/molecule/operator/molecule/[0m[95maffinity-tolerations-resources-test[0m [33mMOLECULE_SCENARIO_NAME[0m=[35maffinity[0m-tolerations-resources-test [33mMOLECULE_STATE_FILE[0m=[35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/[0m[95mstate.yml[0m [33mMOLECULE_VERIFIER_NAME[0m=[35mansible[0m [33mMOLECULE_VERIFIER_TEST_DIRECTORY[0m=[35m/tmp/molecule/operator/molecule/affinity-tolerations-resources-test/[0m[95mtests[0m [33mMOLECULE_WAIT_RETRIES[0m=[1;36m120[0m


PLAY [Prepare] *****************************************************************

TASK [Gathering Facts] *********************************************************
[32mok: [localhost][0m

TASK [Get information about the cluster] ***************************************
[32mok: [localhost][0m

TASK [Determine the cluster type] **********************************************
[32mok: [localhost][0m

TASK [Determine the Istio implementation] **************************************
[32mok: [localhost][0m

TASK [Determine if the operator installation is managed externally or not] *****
[32mok: [localhost][0m

TASK [Get the SMCP name if on Maistra] *****************************************
[36mskipping: [localhost][0m

TASK [set_fact] ****************************************************************
[36mskipping: [localhost][0m

TASK [See if we have Maistra htpasswd secret for accessing external services like Prometheus] ***
[36mskipping: [localhost][0m

TASK [set_fact] ****************************************************************
[36mskipping: [localhost][0m

TASK [Make sure the operator namespace exists] *********************************
[33mchanged: [localhost][0m

TASK [Find the latest Operator Helm Chart] *************************************
[33mchanged: [localhost][0m

TASK [set_fact] ****************************************************************
[32mok: [localhost][0m

TASK [fail] ********************************************************************
[36mskipping: [localhost][0m

TASK [Install Operator via Helm] ***********************************************
[33mchanged: [localhost][0m

TASK [Make sure the CR namespace exists] ***************************************
[32mok: [localhost][0m

TASK [Process NetworkPolicy needed to access the Kiali UI when in Maistra environment [state=present]] ***
[36mskipping: [localhost][0m

TASK [Wait for the CRD to be established] **************************************
[32mok: [localhost][0m

TASK [Prepare initial Kiali CR definition based solely on the template] ********
[32mok: [localhost][0m

TASK [Modify the Kiali CR definition with specific Maistra config for Prometheus, Tracing, Grafana and Istio] ***
[36mskipping: [localhost][0m

TASK [Create Kiali CR] *********************************************************
[33mchanged: [localhost][0m

TASK [Asserting that Kiali is Deployed] ****************************************
[1;30mFAILED - RETRYING: [localhost]: Asserting that Kiali is Deployed (120 retries left).[0m
[1;30mFAILED - RETRYING: [localhost]: Asserting that Kiali is Deployed (119 retries left).[0m
[1;30mFAILED - RETRYING: [localhost]: Asserting that Kiali is Deployed (118 retries left).[0m
[1;30mFAILED - RETRYING: [localhost]: Asserting that Kiali is Deployed (117 retries left).[0m
[1;30mFAILED - RETRYING: [localhost]: Asserting that Kiali is Deployed (116 retries left).[0m
[1;30mFAILED - RETRYING: [localhost]: Asserting that Kiali is Deployed (115 retries left).[0m
[1;30mFAILED - RETRYING: [localhost]: Asserting that Kiali is Deployed (114 retries left).[0m
[1;30mFAILED - RETRYING: [localhost]: Asserting that Kiali is Deployed (113 retries left).[0m
[32mok: [localhost][0m

PLAY RECAP *********************************************************************
[33mlocalhost[0m                  : [32mok=14  [0m [33mchanged=4   [0m unreachable=0    failed=0    [36mskipped=7   [0m rescued=0    ignored=0

[34mINFO    [0m [2;36mRunning [0m[2;32maffinity-tolerations-resources-test[0m[2;36m > [0m[2;32mconverge[0m
DEBUG: ANSIBLE ENVIRONMENT:
ANSIBLE_COLLECTIONS_PATH: [35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/[0m[95mcollections[0m:[35m/home/runner/.ansible/[0m[95mcollections[0m:[35m/usr/share/ansible/[0m[95mcollections[0m:[35m/etc/ansible/[0m[95mcollections[0m
ANSIBLE_CONFIG: [35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/[0m[95mansible.cfg[0m
ANSIBLE_FILTER_PLUGINS: [35m/usr/local/lib/python3.8/site-packages/molecule/provisioner/ansible/plugins/[0m[95mfilter[0m:[35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/plugins/[0m[95mfilter[0m:[35m/tmp/molecule/operator/plugins/[0m[95mfilter[0m:[35m/home/runner/.ansible/plugins/[0m[95mfilter[0m:[35m/usr/share/ansible/plugins/[0m[95mfilter[0m
ANSIBLE_FORCE_COLOR: [32m'1'[0m
ANSIBLE_LIBRARY: [35m/usr/local/lib/python3.8/site-packages/molecule/provisioner/ansible/plugins/[0m[95mmodules[0m:[35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/[0m[95mlibrary[0m:[35m/tmp/molecule/operator/[0m[95mlibrary[0m:[35m/home/runner/.ansible/plugins/[0m[95mmodules[0m:[35m/usr/share/ansible/plugins/[0m[95mmodules[0m
ANSIBLE_ROLES_PATH: [32m'/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/roles:/tmp/molecule:/home/runner/.ansible/roles:/usr/share/ansible/roles:/etc/ansible/roles:'[0m

DEBUG: MOLECULE ENVIRONMENT:
MOLECULE_CLUSTER_TYPE: kind
MOLECULE_DEBUG: [32m'True'[0m
MOLECULE_DEPENDENCY_NAME: galaxy
MOLECULE_DRIVER_NAME: podman
MOLECULE_DUMP_LOGS_ON_ERROR: [32m'true'[0m
MOLECULE_ENV_FILE: [35m/tmp/molecule/operator/[0m[95m.env.yml[0m
MOLECULE_EPHEMERAL_DIRECTORY: [35m/home/runner/.cache/molecule/operator/[0m[95maffinity-tolerations-resources-test[0m
MOLECULE_FILE: [35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/[0m[95mmolecule.yml[0m
MOLECULE_HELM_CHARTS_REPO: [35m/tmp/molecule/[0m[95mhelm-charts-repo[0m
MOLECULE_INSTANCE_CONFIG: [35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/[0m[95minstance_config.yml[0m
MOLECULE_INVENTORY_FILE: [35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/inventory/[0m[95mansible_inventory.yml[0m
MOLECULE_KIALI_CR_SPEC_VERSION: default
MOLECULE_KIND_IP: [32m''[0m
MOLECULE_OPERATOR_INSTALLER: helm
MOLECULE_OPERATOR_PROFILER_ENABLED: [32m'true'[0m
MOLECULE_PROJECT_DIRECTORY: [35m/tmp/molecule/[0m[95moperator[0m
MOLECULE_PROVISIONER_NAME: ansible
MOLECULE_SCENARIO_DIRECTORY: [35m/tmp/molecule/operator/molecule/[0m[95maffinity-tolerations-resources-test[0m
MOLECULE_SCENARIO_NAME: affinity-tolerations-resources-test
MOLECULE_STATE_FILE: [35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/[0m[95mstate.yml[0m
MOLECULE_VERIFIER_NAME: ansible
MOLECULE_VERIFIER_TEST_DIRECTORY: [35m/tmp/molecule/operator/molecule/affinity-tolerations-resources-test/[0m[95mtests[0m
MOLECULE_WAIT_RETRIES: [32m'120'[0m

DEBUG: SHELL REPLAY:
[33mANSIBLE_COLLECTIONS_PATH[0m=[35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/[0m[95mcollections[0m:[35m/home/runner/.ansible/[0m[95mcollections[0m:[35m/usr/share/ansible/[0m[95mcollections[0m:[35m/etc/ansible/[0m[95mcollections[0m [33mANSIBLE_CONFIG[0m=[35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/[0m[95mansible.cfg[0m [33mANSIBLE_FILTER_PLUGINS[0m=[35m/usr/local/lib/python3.8/site-packages/molecule/provisioner/ansible/plugins/[0m[95mfilter[0m:[35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/plugins/[0m[95mfilter[0m:[35m/tmp/molecule/operator/plugins/[0m[95mfilter[0m:[35m/home/runner/.ansible/plugins/[0m[95mfilter[0m:[35m/usr/share/ansible/plugins/[0m[95mfilter[0m [33mANSIBLE_FORCE_COLOR[0m=[1;36m1[0m [33mANSIBLE_LIBRARY[0m=[35m/usr/local/lib/python3.8/site-packages/molecule/provisioner/ansible/plugins/[0m[95mmodules[0m:[35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/[0m[95mlibrary[0m:[35m/tmp/molecule/operator/[0m[95mlibrary[0m:[35m/home/runner/.ansible/plugins/[0m[95mmodules[0m:[35m/usr/share/ansible/plugins/[0m[95mmodules[0m [33mANSIBLE_ROLES_PATH[0m=[35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/[0m[95mroles[0m:[35m/tmp/[0m[95mmolecule[0m:[35m/home/runner/.ansible/[0m[95mroles[0m:[35m/usr/share/ansible/[0m[95mroles[0m:[35m/etc/ansible/[0m[95mroles[0m: [33mMOLECULE_CLUSTER_TYPE[0m=[35mkind[0m [33mMOLECULE_DEBUG[0m=[3;92mTrue[0m [33mMOLECULE_DEPENDENCY_NAME[0m=[35mgalaxy[0m [33mMOLECULE_DRIVER_NAME[0m=[35mpodman[0m [33mMOLECULE_DUMP_LOGS_ON_ERROR[0m=[35mtrue[0m [33mMOLECULE_ENV_FILE[0m=[35m/tmp/molecule/operator/[0m[95m.env.yml[0m [33mMOLECULE_EPHEMERAL_DIRECTORY[0m=[35m/home/runner/.cache/molecule/operator/[0m[95maffinity-tolerations-resources-test[0m [33mMOLECULE_FILE[0m=[35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/[0m[95mmolecule.yml[0m [33mMOLECULE_HELM_CHARTS_REPO[0m=[35m/tmp/molecule/[0m[95mhelm-charts-repo[0m [33mMOLECULE_INSTANCE_CONFIG[0m=[35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/[0m[95minstance_config.yml[0m [33mMOLECULE_INVENTORY_FILE[0m=[35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/inventory/[0m[95mansible_inventory.yml[0m [33mMOLECULE_KIALI_CR_SPEC_VERSION[0m=[35mdefault[0m [33mMOLECULE_KIND_IP[0m= [33mMOLECULE_OPERATOR_INSTALLER[0m=[35mhelm[0m [33mMOLECULE_OPERATOR_PROFILER_ENABLED[0m=[35mtrue[0m [33mMOLECULE_PROJECT_DIRECTORY[0m=[35m/tmp/molecule/[0m[95moperator[0m [33mMOLECULE_PROVISIONER_NAME[0m=[35mansible[0m [33mMOLECULE_SCENARIO_DIRECTORY[0m=[35m/tmp/molecule/operator/molecule/[0m[95maffinity-tolerations-resources-test[0m [33mMOLECULE_SCENARIO_NAME[0m=[35maffinity[0m-tolerations-resources-test [33mMOLECULE_STATE_FILE[0m=[35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/[0m[95mstate.yml[0m [33mMOLECULE_VERIFIER_NAME[0m=[35mansible[0m [33mMOLECULE_VERIFIER_TEST_DIRECTORY[0m=[35m/tmp/molecule/operator/molecule/affinity-tolerations-resources-test/[0m[95mtests[0m [33mMOLECULE_WAIT_RETRIES[0m=[1;36m120[0m


PLAY [Tests] *******************************************************************

TASK [Gathering Facts] *********************************************************
[32mok: [localhost][0m

TASK [Get information about the cluster] ***************************************
[32mok: [localhost][0m

TASK [Determine the cluster type] **********************************************
[32mok: [localhost][0m

TASK [Determine the Istio implementation] **************************************
[32mok: [localhost][0m

TASK [Get SMCP if running in Maistra environment] ******************************
[36mskipping: [localhost][0m

TASK [There must one and only one SMCP already installed in the control plane] ***
[36mskipping: [localhost][0m

TASK [Get Kiali CR if present] *************************************************
[32mok: [localhost][0m

TASK [Get Kiali Operator Pod] **************************************************
[32mok: [localhost][0m

TASK [Get Kiali Pod] ***********************************************************
[32mok: [localhost][0m

TASK [Get Kiali Configmap] *****************************************************
[32mok: [localhost][0m

TASK [Format Configmap] ********************************************************
[32mok: [localhost][0m

TASK [Get Kiali Deployment] ****************************************************
[32mok: [localhost][0m

TASK [Get Kiali Service] *******************************************************
[32mok: [localhost][0m

TASK [Get Kiali Route] *********************************************************
[36mskipping: [localhost][0m

TASK [Determine the Kiali Route URL on OpenShift] ******************************
[36mskipping: [localhost][0m

TASK [Determine the Kiali Ingress URL on minikube] *****************************
[36mskipping: [localhost][0m

TASK [Determine the Kiali Ingress URL on kind] *********************************
[32mok: [localhost][0m

TASK [Assert Kiali Pod is Running and there is only one] ***********************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Assert Kiali Pod is Running on the correct Namespace] ********************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Wait for Kiali CR changes to take effect] ********************************
[32mok: [localhost][0m

TASK [Set affinity and tolerations and resources and pod_annotations and service_annotations and pod_labels in current Kiali CR] ***
[32mok: [localhost][0m

TASK [Change Kiali CR with new Kiali CR] ***************************************
[31m--- before[0m
[32m+++ after[0m
[36m@@ -1,7 +1,66 @@[0m
 {
     "metadata": {
[31m-        "generation": 1,[0m
[32m+        "generation": 2,[0m
         "managedFields": [
[32m+            {[0m
[32m+                "apiVersion": "kiali.io/v1alpha1",[0m
[32m+                "fieldsType": "FieldsV1",[0m
[32m+                "fieldsV1": {[0m
[32m+                    "f:metadata": {[0m
[32m+                        "f:finalizers": {[0m
[32m+                            ".": {},[0m
[32m+                            "v:\"kiali.io/finalizer\"": {}[0m
[32m+                        }[0m
[32m+                    }[0m
[32m+                },[0m
[32m+                "manager": "ansible-operator",[0m
[32m+                "operation": "Update",[0m
[32m+                "time": "2023-08-15T08:17:17Z"[0m
[32m+            },[0m
[32m+            {[0m
[32m+                "apiVersion": "kiali.io/v1alpha1",[0m
[32m+                "fieldsType": "FieldsV1",[0m
[32m+                "fieldsV1": {[0m
[32m+                    "f:status": {[0m
[32m+                        "f:deployment": {[0m
[32m+                            ".": {},[0m
[32m+                            "f:accessibleNamespaces": {},[0m
[32m+                            "f:instanceName": {},[0m
[32m+                            "f:namespace": {}[0m
[32m+                        },[0m
[32m+                        "f:environment": {[0m
[32m+                            ".": {},[0m
[32m+                            "f:isKubernetes": {},[0m
[32m+                            "f:kubernetesVersion": {},[0m
[32m+                            "f:operatorVersion": {}[0m
[32m+                        },[0m
[32m+                        "f:progress": {[0m
[32m+                            ".": {},[0m
[32m+                            "f:duration": {},[0m
[32m+                            "f:message": {}[0m
[32m+                        },[0m
[32m+                        "f:specVersion": {}[0m
[32m+                    }[0m
[32m+                },[0m
[32m+                "manager": "OpenAPI-Generator",[0m
[32m+                "operation": "Update",[0m
[32m+                "subresource": "status",[0m
[32m+                "time": "2023-08-15T08:17:33Z"[0m
[32m+            },[0m
[32m+            {[0m
[32m+                "apiVersion": "kiali.io/v1alpha1",[0m
[32m+                "fieldsType": "FieldsV1",[0m
[32m+                "fieldsV1": {[0m
[32m+                    "f:status": {[0m
[32m+                        ".": {},[0m
[32m+                        "f:conditions": {}[0m
[32m+                    }[0m
[32m+                },[0m
[32m+                "manager": "ansible-operator",[0m
[32m+                "operation": "Update",[0m
[32m+                "subresource": "status",[0m
[32m+                "time": "2023-08-15T08:17:33Z"[0m
[32m+            },[0m
             {
                 "apiVersion": "kiali.io/v1alpha1",
                 "fieldsType": "FieldsV1",
[36m@@ -18,6 +77,29 @@[0m
                             "f:additional_service_yaml": {
                                 ".": {},
                                 "f:externalName": {}
[32m+                            },[0m
[32m+                            "f:affinity": {[0m
[32m+                                ".": {},[0m
[32m+                                "f:node": {[0m
[32m+                                    ".": {},[0m
[32m+                                    "f:preferredDuringSchedulingIgnoredDuringExecution": {}[0m
[32m+                                },[0m
[32m+                                "f:pod": {[0m
[32m+                                    ".": {},[0m
[32m+                                    "f:preferredDuringSchedulingIgnoredDuringExecution": {}[0m
[32m+                                },[0m
[32m+                                "f:pod_anti": {[0m
[32m+                                    ".": {},[0m
[32m+                                    "f:preferredDuringSchedulingIgnoredDuringExecution": {}[0m
[32m+                                }[0m
[32m+                            },[0m
[32m+                            "f:hpa": {[0m
[32m+                                ".": {},[0m
[32m+                                "f:spec": {[0m
[32m+                                    ".": {},[0m
[32m+                                    "f:maxReplicas": {},[0m
[32m+                                    "f:minReplicas": {}[0m
[32m+                                }[0m
                             },
                             "f:image_name": {},
                             "f:image_pull_policy": {},
[36m@@ -31,7 +113,31 @@[0m
                                 "f:log_level": {}
                             },
                             "f:namespace": {},
[31m-                            "f:service_type": {}[0m
[32m+                            "f:pod_annotations": {[0m
[32m+                                ".": {},[0m
[32m+                                "f:some.test.io/keepCamelCaseFOO": {}[0m
[32m+                            },[0m
[32m+                            "f:pod_labels": {[0m
[32m+                                ".": {},[0m
[32m+                                "f:some.test.label/labelKeepCamelCaseFOO": {}[0m
[32m+                            },[0m
[32m+                            "f:resources": {[0m
[32m+                                ".": {},[0m
[32m+                                "f:limits": {[0m
[32m+                                    ".": {},[0m
[32m+                                    "f:memory": {}[0m
[32m+                                },[0m
[32m+                                "f:requests": {[0m
[32m+                                    ".": {},[0m
[32m+                                    "f:memory": {}[0m
[32m+                                }[0m
[32m+                            },[0m
[32m+                            "f:service_annotations": {[0m
[32m+                                ".": {},[0m
[32m+                                "f:another.test.io/keepCamelCaseBAR": {}[0m
[32m+                            },[0m
[32m+                            "f:service_type": {},[0m
[32m+                            "f:tolerations": {}[0m
                         },
                         "f:istio_namespace": {},
                         "f:version": {}
[36m@@ -39,71 +145,112 @@[0m
                 },
                 "manager": "OpenAPI-Generator",
                 "operation": "Update",
[31m-                "time": "2023-08-15T08:17:17Z"[0m
[31m-            },[0m
[31m-            {[0m
[31m-                "apiVersion": "kiali.io/v1alpha1",[0m
[31m-                "fieldsType": "FieldsV1",[0m
[31m-                "fieldsV1": {[0m
[31m-                    "f:metadata": {[0m
[31m-                        "f:finalizers": {[0m
[31m-                            ".": {},[0m
[31m-                            "v:\"kiali.io/finalizer\"": {}[0m
[31m-                        }[0m
[31m-                    }[0m
[31m-                },[0m
[31m-                "manager": "ansible-operator",[0m
[31m-                "operation": "Update",[0m
[31m-                "time": "2023-08-15T08:17:17Z"[0m
[31m-            },[0m
[31m-            {[0m
[31m-                "apiVersion": "kiali.io/v1alpha1",[0m
[31m-                "fieldsType": "FieldsV1",[0m
[31m-                "fieldsV1": {[0m
[31m-                    "f:status": {[0m
[31m-                        "f:deployment": {[0m
[31m-                            ".": {},[0m
[31m-                            "f:accessibleNamespaces": {},[0m
[31m-                            "f:instanceName": {},[0m
[31m-                            "f:namespace": {}[0m
[31m-                        },[0m
[31m-                        "f:environment": {[0m
[31m-                            ".": {},[0m
[31m-                            "f:isKubernetes": {},[0m
[31m-                            "f:kubernetesVersion": {},[0m
[31m-                            "f:operatorVersion": {}[0m
[31m-                        },[0m
[31m-                        "f:progress": {[0m
[31m-                            ".": {},[0m
[31m-                            "f:duration": {},[0m
[31m-                            "f:message": {}[0m
[31m-                        },[0m
[31m-                        "f:specVersion": {}[0m
[31m-                    }[0m
[31m-                },[0m
[31m-                "manager": "OpenAPI-Generator",[0m
[31m-                "operation": "Update",[0m
[31m-                "subresource": "status",[0m
[31m-                "time": "2023-08-15T08:17:33Z"[0m
[31m-            },[0m
[31m-            {[0m
[31m-                "apiVersion": "kiali.io/v1alpha1",[0m
[31m-                "fieldsType": "FieldsV1",[0m
[31m-                "fieldsV1": {[0m
[31m-                    "f:status": {[0m
[31m-                        ".": {},[0m
[31m-                        "f:conditions": {}[0m
[31m-                    }[0m
[31m-                },[0m
[31m-                "manager": "ansible-operator",[0m
[31m-                "operation": "Update",[0m
[31m-                "subresource": "status",[0m
[31m-                "time": "2023-08-15T08:17:33Z"[0m
[32m+                "time": "2023-08-15T08:18:10Z"[0m
             }
         ],
[31m-        "resourceVersion": "3486"[0m
[32m+        "resourceVersion": "3558"[0m
     },
     "spec": {
[31m-        "deployment": {}[0m
[32m+        "deployment": {[0m
[32m+            "affinity": {[0m
[32m+                "node": {[0m
[32m+                    "preferredDuringSchedulingIgnoredDuringExecution": [[0m
[32m+                        {[0m
[32m+                            "preference": {[0m
[32m+                                "matchExpressions": [[0m
[32m+                                    {[0m
[32m+                                        "key": "affinity-kiali-test",[0m
[32m+                                        "operator": "In",[0m
[32m+                                        "values": [[0m
[32m+                                            "affinity-kiali-test"[0m
[32m+                                        ][0m
[32m+                                    }[0m
[32m+                                ][0m
[32m+                            },[0m
[32m+                            "weight": 71[0m
[32m+                        }[0m
[32m+                    ][0m
[32m+                },[0m
[32m+                "pod": {[0m
[32m+                    "preferredDuringSchedulingIgnoredDuringExecution": [[0m
[32m+                        {[0m
[32m+                            "podAffinityTerm": {[0m
[32m+                                "labelSelector": {[0m
[32m+                                    "matchExpressions": [[0m
[32m+                                        {[0m
[32m+                                            "key": "affinity-kiali-test",[0m
[32m+                                            "operator": "In",[0m
[32m+                                            "values": [[0m
[32m+                                                "affinity-kiali-test1"[0m
[32m+                                            ][0m
[32m+                                        }[0m
[32m+                                    ][0m
[32m+                                },[0m
[32m+                                "topologyKey": "failure-domain.beta.kubernetes.io/zone"[0m
[32m+                            },[0m
[32m+                            "weight": 72[0m
[32m+                        }[0m
[32m+                    ][0m
[32m+                },[0m
[32m+                "pod_anti": {[0m
[32m+                    "preferredDuringSchedulingIgnoredDuringExecution": [[0m
[32m+                        {[0m
[32m+                            "podAffinityTerm": {[0m
[32m+                                "labelSelector": {[0m
[32m+                                    "matchExpressions": [[0m
[32m+                                        {[0m
[32m+                                            "key": "affinity-kiali-test",[0m
[32m+                                            "operator": "In",[0m
[32m+                                            "values": [[0m
[32m+                                                "affinity-kiali-test2"[0m
[32m+                                            ][0m
[32m+                                        }[0m
[32m+                                    ][0m
[32m+                                },[0m
[32m+                                "topologyKey": "failure-domain.beta.kubernetes.io/zone"[0m
[32m+                            },[0m
[32m+                            "weight": 73[0m
[32m+                        }[0m
[32m+                    ][0m
[32m+                }[0m
[32m+            },[0m
[32m+            "hpa": {[0m
[32m+                "spec": {[0m
[32m+                    "maxReplicas": 1,[0m
[32m+                    "minReplicas": 1[0m
[32m+                }[0m
[32m+            },[0m
[32m+            "pod_annotations": {[0m
[32m+                "some.test.io/keepCamelCaseFOO": "camelCaseValueFOO"[0m
[32m+            },[0m
[32m+            "pod_labels": {[0m
[32m+                "some.test.label/labelKeepCamelCaseFOO": "labelCamelCaseValueFOO"[0m
[32m+            },[0m
[32m+            "resources": {[0m
[32m+                "limits": {[0m
[32m+                    "memory": "32Gi"[0m
[32m+                },[0m
[32m+                "requests": {[0m
[32m+                    "memory": "320Mi"[0m
[32m+                }[0m
[32m+            },[0m
[32m+            "service_annotations": {[0m
[32m+                "another.test.io/keepCamelCaseBAR": "camelCaseValueBAR"[0m
[32m+            },[0m
[32m+            "tolerations": [[0m
[32m+                {[0m
[32m+                    "effect": "NoExecute",[0m
[32m+                    "key": "node.kubernetes.io/not-ready",[0m
[32m+                    "operator": "Exists",[0m
[32m+                    "tolerationSeconds": 777[0m
[32m+                },[0m
[32m+                {[0m
[32m+                    "effect": "NoExecute",[0m
[32m+                    "key": "node.kubernetes.io/unreachable",[0m
[32m+                    "operator": "Exists",[0m
[32m+                    "tolerationSeconds": 777[0m
[32m+                }[0m
[32m+            ][0m
[32m+        }[0m
     }
 }

[33mchanged: [localhost][0m

TASK [Wait for Kiali CR changes to take effect] ********************************
[1;30mFAILED - RETRYING: [localhost]: Wait for Kiali CR changes to take effect (120 retries left).[0m
[1;30mFAILED - RETRYING: [localhost]: Wait for Kiali CR changes to take effect (119 retries left).[0m
[1;30mFAILED - RETRYING: [localhost]: Wait for Kiali CR changes to take effect (118 retries left).[0m
[32mok: [localhost][0m

TASK [Asserting that Kiali Pod exists and there is only one] *******************
[32mok: [localhost][0m

TASK [Wait for Kiali to be running and accepting requests] *********************
[1;30mFAILED - RETRYING: [localhost]: Wait for Kiali to be running and accepting requests (120 retries left).[0m
[32mok: [localhost][0m

TASK [Get information about the cluster] ***************************************
[32mok: [localhost][0m

TASK [Determine the cluster type] **********************************************
[32mok: [localhost][0m

TASK [Determine the Istio implementation] **************************************
[32mok: [localhost][0m

TASK [Get SMCP if running in Maistra environment] ******************************
[36mskipping: [localhost][0m

TASK [There must one and only one SMCP already installed in the control plane] ***
[36mskipping: [localhost][0m

TASK [Get Kiali CR if present] *************************************************
[32mok: [localhost][0m

TASK [Get Kiali Operator Pod] **************************************************
[32mok: [localhost][0m

TASK [Get Kiali Pod] ***********************************************************
[32mok: [localhost][0m

TASK [Get Kiali Configmap] *****************************************************
[32mok: [localhost][0m

TASK [Format Configmap] ********************************************************
[32mok: [localhost][0m

TASK [Get Kiali Deployment] ****************************************************
[32mok: [localhost][0m

TASK [Get Kiali Service] *******************************************************
[32mok: [localhost][0m

TASK [Get Kiali Route] *********************************************************
[36mskipping: [localhost][0m

TASK [Determine the Kiali Route URL on OpenShift] ******************************
[36mskipping: [localhost][0m

TASK [Determine the Kiali Ingress URL on minikube] *****************************
[36mskipping: [localhost][0m

TASK [Determine the Kiali Ingress URL on kind] *********************************
[32mok: [localhost][0m

TASK [Assert Kiali Pod is Running and there is only one] ***********************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Assert Kiali Pod is Running on the correct Namespace] ********************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Assert that tolerations were applied to the deployment] ******************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Assert that affinity was applied] ****************************************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Assert that resources was applied] ***************************************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Assert that pod_annotations was applied] *********************************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Assert that service_annotations was applied] *****************************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Assert that pod_labels was applied] **************************************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Assert that camelCase is retained in additional service yaml] ************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Get the HPA resource that should now exist] ******************************
[32mok: [localhost][0m

TASK [Assert the HPA resource has been created] ********************************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Wait for Kiali CR changes to take effect] ********************************
[32mok: [localhost][0m

TASK [Set affinity and tolerations and resources and pod_annotations and service_annotations and pod_labels in current Kiali CR] ***
[32mok: [localhost][0m

TASK [Change Kiali CR with new Kiali CR] ***************************************
[31m--- before[0m
[32m+++ after[0m
[36m@@ -1,6 +1,6 @@[0m
 {
     "metadata": {
[31m-        "generation": 2,[0m
[32m+        "generation": 3,[0m
         "managedFields": [
             {
                 "apiVersion": "kiali.io/v1alpha1",
[36m@@ -34,29 +34,7 @@[0m
                                 ".": {},
                                 "f:externalName": {}
                             },
[31m-                            "f:affinity": {[0m
[31m-                                ".": {},[0m
[31m-                                "f:node": {[0m
[31m-                                    ".": {},[0m
[31m-                                    "f:preferredDuringSchedulingIgnoredDuringExecution": {}[0m
[31m-                                },[0m
[31m-                                "f:pod": {[0m
[31m-                                    ".": {},[0m
[31m-                                    "f:preferredDuringSchedulingIgnoredDuringExecution": {}[0m
[31m-                                },[0m
[31m-                                "f:pod_anti": {[0m
[31m-                                    ".": {},[0m
[31m-                                    "f:preferredDuringSchedulingIgnoredDuringExecution": {}[0m
[31m-                                }[0m
[31m-                            },[0m
[31m-                            "f:hpa": {[0m
[31m-                                ".": {},[0m
[31m-                                "f:spec": {[0m
[31m-                                    ".": {},[0m
[31m-                                    "f:maxReplicas": {},[0m
[31m-                                    "f:minReplicas": {}[0m
[31m-                                }[0m
[31m-                            },[0m
[32m+                            "f:affinity": {},[0m
                             "f:image_name": {},
                             "f:image_pull_policy": {},
                             "f:image_version": {},
[36m@@ -69,31 +47,7 @@[0m
                                 "f:log_level": {}
                             },
                             "f:namespace": {},
[31m-                            "f:pod_annotations": {[0m
[31m-                                ".": {},[0m
[31m-                                "f:some.test.io/keepCamelCaseFOO": {}[0m
[31m-                            },[0m
[31m-                            "f:pod_labels": {[0m
[31m-                                ".": {},[0m
[31m-                                "f:some.test.label/labelKeepCamelCaseFOO": {}[0m
[31m-                            },[0m
[31m-                            "f:resources": {[0m
[31m-                                ".": {},[0m
[31m-                                "f:limits": {[0m
[31m-                                    ".": {},[0m
[31m-                                    "f:memory": {}[0m
[31m-                                },[0m
[31m-                                "f:requests": {[0m
[31m-                                    ".": {},[0m
[31m-                                    "f:memory": {}[0m
[31m-                                }[0m
[31m-                            },[0m
[31m-                            "f:service_annotations": {[0m
[31m-                                ".": {},[0m
[31m-                                "f:another.test.io/keepCamelCaseBAR": {}[0m
[31m-                            },[0m
[31m-                            "f:service_type": {},[0m
[31m-                            "f:tolerations": {}[0m
[32m+                            "f:service_type": {}[0m
                         },
                         "f:istio_namespace": {},
                         "f:version": {}
[36m@@ -148,109 +102,11 @@[0m
                 "time": "2023-08-15T08:18:26Z"
             }
         ],
[31m-        "resourceVersion": "3664"[0m
[32m+        "resourceVersion": "3753"[0m
     },
     "spec": {
         "deployment": {
[31m-            "affinity": {[0m
[31m-                "node": {[0m
[31m-                    "preferredDuringSchedulingIgnoredDuringExecution": [[0m
[31m-                        {[0m
[31m-                            "preference": {[0m
[31m-                                "matchExpressions": [[0m
[31m-                                    {[0m
[31m-                                        "key": "affinity-kiali-test",[0m
[31m-                                        "operator": "In",[0m
[31m-                                        "values": [[0m
[31m-                                            "affinity-kiali-test"[0m
[31m-                                        ][0m
[31m-                                    }[0m
[31m-                                ][0m
[31m-                            },[0m
[31m-                            "weight": 71[0m
[31m-                        }[0m
[31m-                    ][0m
[31m-                },[0m
[31m-                "pod": {[0m
[31m-                    "preferredDuringSchedulingIgnoredDuringExecution": [[0m
[31m-                        {[0m
[31m-                            "podAffinityTerm": {[0m
[31m-                                "labelSelector": {[0m
[31m-                                    "matchExpressions": [[0m
[31m-                                        {[0m
[31m-                                            "key": "affinity-kiali-test",[0m
[31m-                                            "operator": "In",[0m
[31m-                                            "values": [[0m
[31m-                                                "affinity-kiali-test1"[0m
[31m-                                            ][0m
[31m-                                        }[0m
[31m-                                    ][0m
[31m-                                },[0m
[31m-                                "topologyKey": "failure-domain.beta.kubernetes.io/zone"[0m
[31m-                            },[0m
[31m-                            "weight": 72[0m
[31m-                        }[0m
[31m-                    ][0m
[31m-                },[0m
[31m-                "pod_anti": {[0m
[31m-                    "preferredDuringSchedulingIgnoredDuringExecution": [[0m
[31m-                        {[0m
[31m-                            "podAffinityTerm": {[0m
[31m-                                "labelSelector": {[0m
[31m-                                    "matchExpressions": [[0m
[31m-                                        {[0m
[31m-                                            "key": "affinity-kiali-test",[0m
[31m-                                            "operator": "In",[0m
[31m-                                            "values": [[0m
[31m-                                                "affinity-kiali-test2"[0m
[31m-                                            ][0m
[31m-                                        }[0m
[31m-                                    ][0m
[31m-                                },[0m
[31m-                                "topologyKey": "failure-domain.beta.kubernetes.io/zone"[0m
[31m-                            },[0m
[31m-                            "weight": 73[0m
[31m-                        }[0m
[31m-                    ][0m
[31m-                }[0m
[31m-            },[0m
[31m-            "hpa": {[0m
[31m-                "spec": {[0m
[31m-                    "maxReplicas": 1,[0m
[31m-                    "minReplicas": 1[0m
[31m-                }[0m
[31m-            },[0m
[31m-            "pod_annotations": {[0m
[31m-                "some.test.io/keepCamelCaseFOO": "camelCaseValueFOO"[0m
[31m-            },[0m
[31m-            "pod_labels": {[0m
[31m-                "some.test.label/labelKeepCamelCaseFOO": "labelCamelCaseValueFOO"[0m
[31m-            },[0m
[31m-            "resources": {[0m
[31m-                "limits": {[0m
[31m-                    "memory": "32Gi"[0m
[31m-                },[0m
[31m-                "requests": {[0m
[31m-                    "memory": "320Mi"[0m
[31m-                }[0m
[31m-            },[0m
[31m-            "service_annotations": {[0m
[31m-                "another.test.io/keepCamelCaseBAR": "camelCaseValueBAR"[0m
[31m-            },[0m
[31m-            "tolerations": [[0m
[31m-                {[0m
[31m-                    "effect": "NoExecute",[0m
[31m-                    "key": "node.kubernetes.io/not-ready",[0m
[31m-                    "operator": "Exists",[0m
[31m-                    "tolerationSeconds": 777[0m
[31m-                },[0m
[31m-                {[0m
[31m-                    "effect": "NoExecute",[0m
[31m-                    "key": "node.kubernetes.io/unreachable",[0m
[31m-                    "operator": "Exists",[0m
[31m-                    "tolerationSeconds": 777[0m
[31m-                }[0m
[31m-            ][0m
[32m+            "affinity": {}[0m
         }
     }
 }

[33mchanged: [localhost][0m

TASK [Wait for Kiali CR changes to take effect] ********************************
[1;30mFAILED - RETRYING: [localhost]: Wait for Kiali CR changes to take effect (120 retries left).[0m
[1;30mFAILED - RETRYING: [localhost]: Wait for Kiali CR changes to take effect (119 retries left).[0m
[1;30mFAILED - RETRYING: [localhost]: Wait for Kiali CR changes to take effect (118 retries left).[0m
[32mok: [localhost][0m

TASK [Asserting that Kiali Pod exists and there is only one] *******************
[32mok: [localhost][0m

TASK [Wait for Kiali to be running and accepting requests] *********************
[1;30mFAILED - RETRYING: [localhost]: Wait for Kiali to be running and accepting requests (120 retries left).[0m
[1;30mFAILED - RETRYING: [localhost]: Wait for Kiali to be running and accepting requests (119 retries left).[0m
[32mok: [localhost][0m

TASK [Get information about the cluster] ***************************************
[32mok: [localhost][0m

TASK [Determine the cluster type] **********************************************
[32mok: [localhost][0m

TASK [Determine the Istio implementation] **************************************
[32mok: [localhost][0m

TASK [Get SMCP if running in Maistra environment] ******************************
[36mskipping: [localhost][0m

TASK [There must one and only one SMCP already installed in the control plane] ***
[36mskipping: [localhost][0m

TASK [Get Kiali CR if present] *************************************************
[32mok: [localhost][0m

TASK [Get Kiali Operator Pod] **************************************************
[32mok: [localhost][0m

TASK [Get Kiali Pod] ***********************************************************
[32mok: [localhost][0m

TASK [Get Kiali Configmap] *****************************************************
[32mok: [localhost][0m

TASK [Format Configmap] ********************************************************
[32mok: [localhost][0m

TASK [Get Kiali Deployment] ****************************************************
[32mok: [localhost][0m

TASK [Get Kiali Service] *******************************************************
[32mok: [localhost][0m

TASK [Get Kiali Route] *********************************************************
[36mskipping: [localhost][0m

TASK [Determine the Kiali Route URL on OpenShift] ******************************
[36mskipping: [localhost][0m

TASK [Determine the Kiali Ingress URL on minikube] *****************************
[36mskipping: [localhost][0m

TASK [Determine the Kiali Ingress URL on kind] *********************************
[32mok: [localhost][0m

TASK [Assert Kiali Pod is Running and there is only one] ***********************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Assert Kiali Pod is Running on the correct Namespace] ********************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Assert that empty tolerations were applied to the deployment] ************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Assert that empty affinity was applied] **********************************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Assert that empty resources was applied and we have the default resources set] ***
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

TASK [Try to obtain the HPA which should have been removed] ********************
[32mok: [localhost][0m

TASK [Assert the HPA resource has been removed] ********************************
[32mok: [localhost] => {[0m
[32m    "changed": false,[0m
[32m    "msg": "All assertions passed"[0m
[32m}[0m

PLAY RECAP *********************************************************************
[33mlocalhost[0m                  : [32mok=66  [0m [33mchanged=2   [0m unreachable=0    failed=0    [36mskipped=15  [0m rescued=0    ignored=0

[34mINFO    [0m [2;36mRunning [0m[2;32maffinity-tolerations-resources-test[0m[2;36m > [0m[2;32mdestroy[0m
DEBUG: ANSIBLE ENVIRONMENT:
ANSIBLE_COLLECTIONS_PATH: [35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/[0m[95mcollections[0m:[35m/home/runner/.ansible/[0m[95mcollections[0m:[35m/usr/share/ansible/[0m[95mcollections[0m:[35m/etc/ansible/[0m[95mcollections[0m
ANSIBLE_CONFIG: [35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/[0m[95mansible.cfg[0m
ANSIBLE_FILTER_PLUGINS: [35m/usr/local/lib/python3.8/site-packages/molecule/provisioner/ansible/plugins/[0m[95mfilter[0m:[35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/plugins/[0m[95mfilter[0m:[35m/tmp/molecule/operator/plugins/[0m[95mfilter[0m:[35m/home/runner/.ansible/plugins/[0m[95mfilter[0m:[35m/usr/share/ansible/plugins/[0m[95mfilter[0m
ANSIBLE_FORCE_COLOR: [32m'1'[0m
ANSIBLE_LIBRARY: [35m/usr/local/lib/python3.8/site-packages/molecule/provisioner/ansible/plugins/[0m[95mmodules[0m:[35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/[0m[95mlibrary[0m:[35m/tmp/molecule/operator/[0m[95mlibrary[0m:[35m/home/runner/.ansible/plugins/[0m[95mmodules[0m:[35m/usr/share/ansible/plugins/[0m[95mmodules[0m
ANSIBLE_ROLES_PATH: [32m'/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/roles:/tmp/molecule:/home/runner/.ansible/roles:/usr/share/ansible/roles:/etc/ansible/roles:'[0m

DEBUG: MOLECULE ENVIRONMENT:
MOLECULE_CLUSTER_TYPE: kind
MOLECULE_DEBUG: [32m'True'[0m
MOLECULE_DEPENDENCY_NAME: galaxy
MOLECULE_DRIVER_NAME: podman
MOLECULE_DUMP_LOGS_ON_ERROR: [32m'true'[0m
MOLECULE_ENV_FILE: [35m/tmp/molecule/operator/[0m[95m.env.yml[0m
MOLECULE_EPHEMERAL_DIRECTORY: [35m/home/runner/.cache/molecule/operator/[0m[95maffinity-tolerations-resources-test[0m
MOLECULE_FILE: [35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/[0m[95mmolecule.yml[0m
MOLECULE_HELM_CHARTS_REPO: [35m/tmp/molecule/[0m[95mhelm-charts-repo[0m
MOLECULE_INSTANCE_CONFIG: [35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/[0m[95minstance_config.yml[0m
MOLECULE_INVENTORY_FILE: [35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/inventory/[0m[95mansible_inventory.yml[0m
MOLECULE_KIALI_CR_SPEC_VERSION: default
MOLECULE_KIND_IP: [32m''[0m
MOLECULE_OPERATOR_INSTALLER: helm
MOLECULE_OPERATOR_PROFILER_ENABLED: [32m'true'[0m
MOLECULE_PROJECT_DIRECTORY: [35m/tmp/molecule/[0m[95moperator[0m
MOLECULE_PROVISIONER_NAME: ansible
MOLECULE_SCENARIO_DIRECTORY: [35m/tmp/molecule/operator/molecule/[0m[95maffinity-tolerations-resources-test[0m
MOLECULE_SCENARIO_NAME: affinity-tolerations-resources-test
MOLECULE_STATE_FILE: [35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/[0m[95mstate.yml[0m
MOLECULE_VERIFIER_NAME: ansible
MOLECULE_VERIFIER_TEST_DIRECTORY: [35m/tmp/molecule/operator/molecule/affinity-tolerations-resources-test/[0m[95mtests[0m
MOLECULE_WAIT_RETRIES: [32m'120'[0m

DEBUG: SHELL REPLAY:
[33mANSIBLE_COLLECTIONS_PATH[0m=[35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/[0m[95mcollections[0m:[35m/home/runner/.ansible/[0m[95mcollections[0m:[35m/usr/share/ansible/[0m[95mcollections[0m:[35m/etc/ansible/[0m[95mcollections[0m [33mANSIBLE_CONFIG[0m=[35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/[0m[95mansible.cfg[0m [33mANSIBLE_FILTER_PLUGINS[0m=[35m/usr/local/lib/python3.8/site-packages/molecule/provisioner/ansible/plugins/[0m[95mfilter[0m:[35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/plugins/[0m[95mfilter[0m:[35m/tmp/molecule/operator/plugins/[0m[95mfilter[0m:[35m/home/runner/.ansible/plugins/[0m[95mfilter[0m:[35m/usr/share/ansible/plugins/[0m[95mfilter[0m [33mANSIBLE_FORCE_COLOR[0m=[1;36m1[0m [33mANSIBLE_LIBRARY[0m=[35m/usr/local/lib/python3.8/site-packages/molecule/provisioner/ansible/plugins/[0m[95mmodules[0m:[35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/[0m[95mlibrary[0m:[35m/tmp/molecule/operator/[0m[95mlibrary[0m:[35m/home/runner/.ansible/plugins/[0m[95mmodules[0m:[35m/usr/share/ansible/plugins/[0m[95mmodules[0m [33mANSIBLE_ROLES_PATH[0m=[35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/[0m[95mroles[0m:[35m/tmp/[0m[95mmolecule[0m:[35m/home/runner/.ansible/[0m[95mroles[0m:[35m/usr/share/ansible/[0m[95mroles[0m:[35m/etc/ansible/[0m[95mroles[0m: [33mMOLECULE_CLUSTER_TYPE[0m=[35mkind[0m [33mMOLECULE_DEBUG[0m=[3;92mTrue[0m [33mMOLECULE_DEPENDENCY_NAME[0m=[35mgalaxy[0m [33mMOLECULE_DRIVER_NAME[0m=[35mpodman[0m [33mMOLECULE_DUMP_LOGS_ON_ERROR[0m=[35mtrue[0m [33mMOLECULE_ENV_FILE[0m=[35m/tmp/molecule/operator/[0m[95m.env.yml[0m [33mMOLECULE_EPHEMERAL_DIRECTORY[0m=[35m/home/runner/.cache/molecule/operator/[0m[95maffinity-tolerations-resources-test[0m [33mMOLECULE_FILE[0m=[35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/[0m[95mmolecule.yml[0m [33mMOLECULE_HELM_CHARTS_REPO[0m=[35m/tmp/molecule/[0m[95mhelm-charts-repo[0m [33mMOLECULE_INSTANCE_CONFIG[0m=[35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/[0m[95minstance_config.yml[0m [33mMOLECULE_INVENTORY_FILE[0m=[35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/inventory/[0m[95mansible_inventory.yml[0m [33mMOLECULE_KIALI_CR_SPEC_VERSION[0m=[35mdefault[0m [33mMOLECULE_KIND_IP[0m= [33mMOLECULE_OPERATOR_INSTALLER[0m=[35mhelm[0m [33mMOLECULE_OPERATOR_PROFILER_ENABLED[0m=[35mtrue[0m [33mMOLECULE_PROJECT_DIRECTORY[0m=[35m/tmp/molecule/[0m[95moperator[0m [33mMOLECULE_PROVISIONER_NAME[0m=[35mansible[0m [33mMOLECULE_SCENARIO_DIRECTORY[0m=[35m/tmp/molecule/operator/molecule/[0m[95maffinity-tolerations-resources-test[0m [33mMOLECULE_SCENARIO_NAME[0m=[35maffinity[0m-tolerations-resources-test [33mMOLECULE_STATE_FILE[0m=[35m/home/runner/.cache/molecule/operator/affinity-tolerations-resources-test/[0m[95mstate.yml[0m [33mMOLECULE_VERIFIER_NAME[0m=[35mansible[0m [33mMOLECULE_VERIFIER_TEST_DIRECTORY[0m=[35m/tmp/molecule/operator/molecule/affinity-tolerations-resources-test/[0m[95mtests[0m [33mMOLECULE_WAIT_RETRIES[0m=[1;36m120[0m


PLAY [Destroy] *****************************************************************

TASK [Gathering Facts] *********************************************************
[32mok: [localhost][0m

TASK [Get information about the cluster] ***************************************
[32mok: [localhost][0m

TASK [Determine the cluster type] **********************************************
[32mok: [localhost][0m

TASK [Determine the Istio implementation] **************************************
[32mok: [localhost][0m

TASK [Determine if the operator installation is managed externally or not] *****
[32mok: [localhost][0m

TASK [Remove Kiali CR] *********************************************************
[33mchanged: [localhost][0m

TASK [Wait for Kiali ConfigMap to be uninstalled] ******************************
[32mok: [localhost][0m

TASK [Process NetworkPolicy needed to access the Kiali UI when in Maistra environment [state=absent]] ***
[36mskipping: [localhost][0m

TASK [Uninstall Operator via Helm] *********************************************
[33mchanged: [localhost][0m

TASK [Remove CRDs] *************************************************************
[33mchanged: [localhost][0m

TASK [Removing Operator namespace] *********************************************
[33mchanged: [localhost][0m

TASK [Removing CR namespace if it is different than control plane and operator namespace] ***
[36mskipping: [localhost][0m

PLAY RECAP *********************************************************************
[33mlocalhost[0m                  : [32mok=10  [0m [33mchanged=4   [0m unreachable=0    failed=0    [36mskipped=2   [0m rescued=0    ignored=0

[34mINFO    [0m Pruning extra files from scenario ephemeral directory
podman volume rm molecule-tests-volume
molecule-tests-volume
